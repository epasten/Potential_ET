## TAS BEGINS IN LINE 30
## TASMIN BEGINS IN LINE 994
## TASMAX BEGINS IN LINE 1980
## SFCWIND BEGINS IN LINE 3600

import numpy as np
import pandas as pd
import scipy.stats as stats
from scipy.stats import gamma
import netCDF4 as nc 
import matplotlib.pyplot as plt
from matplotlib.pyplot import figure
import seaborn as sns


"""AUSTRIA"""

at_cerfacs_hirham = nc.Dataset('at/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_at_cerfacs_hirham = at_cerfacs_hirham.variables['tas'][:,:,:]
at_cerfacs_hirham.close()

at_cerfacs_rca = nc.Dataset('at/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_at_cerfacs_rca = at_cerfacs_rca.variables['tas'][:,:,:]
at_cerfacs_rca.close()

at_ichec_hirham = nc.Dataset('at/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_at_ichec_hirham = at_ichec_hirham.variables['tas'][:,:,:]
at_ichec_hirham.close()

at_ichec_racmo = nc.Dataset('at/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_at_ichec_racmo = at_ichec_racmo.variables['tas'][:,:,:]
at_ichec_racmo.close()

at_ichec_rca = nc.Dataset('at/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_at_ichec_rca = at_ichec_rca.variables['tas'][:,:,:]
at_ichec_rca.close()

at_mpi_hirham = nc.Dataset('at/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_at_mpi_hirham = at_mpi_hirham.variables['tas'][:,:,:]
at_mpi_hirham.close()

at_mpi_rca = nc.Dataset('at/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_at_mpi_rca = at_mpi_rca.variables['tas'][:,:,:]
at_mpi_rca.close()

at_noresm_hirham = nc.Dataset('at/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_at_noresm_hirham = at_noresm_hirham.variables['tas'][:,:,:]
at_noresm_hirham.close()

at_noresm_racmo = nc.Dataset('at/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_at_noresm_racmo = at_noresm_racmo.variables['tas'][:,:,:]
at_noresm_racmo.close()

at_noresm_rca = nc.Dataset('at/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_at_noresm_rca = at_noresm_rca.variables['tas'][:,:,:]
at_noresm_rca.close()

len_yrs= len(tas_at_cerfacs_rca)
no_yrs = np.arange(0,len_yrs)
annual_tas_at = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_at[i,0] = np.mean(tas_at_cerfacs_hirham[i,:,:])
    annual_tas_at[i,1] = np.mean(tas_at_cerfacs_rca[i,:,:])
    annual_tas_at[i,2] = np.mean(tas_at_ichec_hirham[i,:,:])
    annual_tas_at[i,3] = np.mean(tas_at_ichec_racmo[i,:,:])
    annual_tas_at[i,4] = np.mean(tas_at_ichec_rca[i,:,:])
    annual_tas_at[i,5] = np.mean(tas_at_mpi_hirham[i,:,:])
    annual_tas_at[i,6] = np.mean(tas_at_mpi_rca[i,:,:])
    annual_tas_at[i,7] = np.mean(tas_at_noresm_hirham[i,:,:])
    annual_tas_at[i,8] = np.mean(tas_at_noresm_racmo[i,:,:])
    annual_tas_at[i,9] = np.mean(tas_at_noresm_rca[i,:,:])
annual_tas_at= annual_tas_at-273.15
annual_tas_at = np.around(annual_tas_at,decimals=2)

yrs = no_yrs+1971
annual_tas_at[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)

variab = ['tas']
variab = variab * 130
sites= ['at']
sites = sites* 130



label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']
models_ap = []
for ii in np.arange(0,len(label_models)):
    models = [label_models[ii]]
    
    models = np.repeat(models,1300)
    models_ap.append(models)


plt.plot(yrs,annual_tas_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Austria')

plt.legend(loc='lower right')
plt.xlim(1970,2100)

df_annual_tas_at = pd.DataFrame(annual_tas_at, columns = label_models)
df_annual_tas_at['var']=variab
df_annual_tas_at['site']=sites

plt.grid(True)
plt.show
plt.savefig('annual_tas_at.png',dpi=300)

"""DENMARK"""
dk_cerfacs_hirham = nc.Dataset('dk/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_dk_cerfacs_hirham = dk_cerfacs_hirham.variables['tas'][:,:,:]
dk_cerfacs_hirham.close()

dk_cerfacs_rca = nc.Dataset('dk/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dk_cerfacs_rca = dk_cerfacs_rca.variables['tas'][:,:,:]
dk_cerfacs_rca.close()

dk_ichec_hirham = nc.Dataset('dk/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_dk_ichec_hirham = dk_ichec_hirham.variables['tas'][:,:,:]
dk_ichec_hirham.close()

dk_ichec_racmo = nc.Dataset('dk/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_dk_ichec_racmo = dk_ichec_racmo.variables['tas'][:,:,:]
dk_ichec_racmo.close()

dk_ichec_rca = nc.Dataset('dk/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dk_ichec_rca = dk_ichec_rca.variables['tas'][:,:,:]
dk_ichec_rca.close()

dk_mpi_hirham = nc.Dataset('dk/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_dk_mpi_hirham = dk_mpi_hirham.variables['tas'][:,:,:]
dk_mpi_hirham.close()

dk_mpi_rca = nc.Dataset('dk/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dk_mpi_rca = dk_mpi_rca.variables['tas'][:,:,:]
dk_mpi_rca.close()

dk_noresm_hirham = nc.Dataset('dk/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_dk_noresm_hirham = dk_noresm_hirham.variables['tas'][:,:,:]
dk_noresm_hirham.close()

dk_noresm_racmo = nc.Dataset('dk/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_dk_noresm_racmo = dk_noresm_racmo.variables['tas'][:,:,:]
dk_noresm_racmo.close()

dk_noresm_rca = nc.Dataset('dk/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dk_noresm_rca = dk_noresm_rca.variables['tas'][:,:,:]
dk_noresm_rca.close()

variab = ['tas']
variab = variab * 130
sites= ['dk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_dk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_dk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_dk[i,0] = np.mean(tas_dk_cerfacs_hirham[i,:,:])
    annual_tas_dk[i,1] = np.mean(tas_dk_cerfacs_rca[i,:,:])
    annual_tas_dk[i,2] = np.mean(tas_dk_ichec_hirham[i,:,:])
    annual_tas_dk[i,3] = np.mean(tas_dk_ichec_racmo[i,:,:])
    annual_tas_dk[i,4] = np.mean(tas_dk_ichec_rca[i,:,:])
    annual_tas_dk[i,5] = np.mean(tas_dk_mpi_hirham[i,:,:])
    annual_tas_dk[i,6] = np.mean(tas_dk_mpi_rca[i,:,:])
    annual_tas_dk[i,7] = np.mean(tas_dk_noresm_hirham[i,:,:])
    annual_tas_dk[i,8] = np.mean(tas_dk_noresm_racmo[i,:,:])
    annual_tas_dk[i,9] = np.mean(tas_dk_noresm_rca[i,:,:])
annual_tas_dk= annual_tas_dk-273.15
annual_tas_dk = np.around(annual_tas_dk,decimals=2)

yrs = no_yrs+1971
annual_tas_dk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Denmark')

df_annual_tas_dk = pd.DataFrame(annual_tas_dk, columns = label_models)
df_annual_tas_dk['var']=variab
df_annual_tas_dk['site']=sites
df_all = pd.concat([df_annual_tas_at,df_annual_tas_dk],ignore_index=True, axis=0)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_dk.png',dpi=300)

df_all = pd.concat([df_annual_tas_at,df_annual_tas_dk],ignore_index=True, axis=0)

df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

"""GERMANY"""
dl_cerfacs_hirham = nc.Dataset('dl/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_dl_cerfacs_hirham = dl_cerfacs_hirham.variables['tas'][:,:,:]
dl_cerfacs_hirham.close()

dl_cerfacs_rca = nc.Dataset('dl/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dl_cerfacs_rca = dl_cerfacs_rca.variables['tas'][:,:,:]
dl_cerfacs_rca.close()

dl_ichec_hirham = nc.Dataset('dl/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_dl_ichec_hirham = dl_ichec_hirham.variables['tas'][:,:,:]
dl_ichec_hirham.close()

dl_ichec_racmo = nc.Dataset('dl/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_dl_ichec_racmo = dl_ichec_racmo.variables['tas'][:,:,:]
dl_ichec_racmo.close()

dl_ichec_rca = nc.Dataset('dl/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dl_ichec_rca = dl_ichec_rca.variables['tas'][:,:,:]
dl_ichec_rca.close()

dl_mpi_hirham = nc.Dataset('dl/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_dl_mpi_hirham = dl_mpi_hirham.variables['tas'][:,:,:]
dl_mpi_hirham.close()

dl_mpi_rca = nc.Dataset('dl/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dl_mpi_rca = dl_mpi_rca.variables['tas'][:,:,:]
dl_mpi_rca.close()

dl_noresm_hirham = nc.Dataset('dl/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_dl_noresm_hirham = dl_noresm_hirham.variables['tas'][:,:,:]
dl_noresm_hirham.close()

dl_noresm_racmo = nc.Dataset('dl/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_dl_noresm_racmo = dl_noresm_racmo.variables['tas'][:,:,:]
dl_noresm_racmo.close()

dl_noresm_rca = nc.Dataset('dl/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_dl_noresm_rca = dl_noresm_rca.variables['tas'][:,:,:]
dl_noresm_rca.close()

variab = ['tas']
variab = variab * 130
sites= ['dl']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_dl_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_dl = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_dl[i,0] = np.mean(tas_dl_cerfacs_hirham[i,:,:])
    annual_tas_dl[i,1] = np.mean(tas_dl_cerfacs_rca[i,:,:])
    annual_tas_dl[i,2] = np.mean(tas_dl_ichec_hirham[i,:,:])
    annual_tas_dl[i,3] = np.mean(tas_dl_ichec_racmo[i,:,:])
    annual_tas_dl[i,4] = np.mean(tas_dl_ichec_rca[i,:,:])
    annual_tas_dl[i,5] = np.mean(tas_dl_mpi_hirham[i,:,:])
    annual_tas_dl[i,6] = np.mean(tas_dl_mpi_rca[i,:,:])
    annual_tas_dl[i,7] = np.mean(tas_dl_noresm_hirham[i,:,:])
    annual_tas_dl[i,8] = np.mean(tas_dl_noresm_racmo[i,:,:])
    annual_tas_dl[i,9] = np.mean(tas_dl_noresm_rca[i,:,:])
annual_tas_dl= annual_tas_dl-273.15
annual_tas_dl = np.around(annual_tas_dl,decimals=2)

yrs = no_yrs+1971
annual_tas_dl[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Germany')

df_annual_tas_dl = pd.DataFrame(annual_tas_dl, columns = label_models)
df_annual_tas_dl['var']=variab
df_annual_tas_dl['site']=sites

df_all = pd.concat([df_all,df_annual_tas_dl],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_dl.png',dpi=300)


"""FINLAND"""
fi_cerfacs_hirham = nc.Dataset('fi/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_fi_cerfacs_hirham = fi_cerfacs_hirham.variables['tas'][:,:,:]
fi_cerfacs_hirham.close()

fi_cerfacs_rca = nc.Dataset('fi/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fi_cerfacs_rca = fi_cerfacs_rca.variables['tas'][:,:,:]
fi_cerfacs_rca.close()

fi_ichec_hirham = nc.Dataset('fi/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_fi_ichec_hirham = fi_ichec_hirham.variables['tas'][:,:,:]
fi_ichec_hirham.close()

fi_ichec_racmo = nc.Dataset('fi/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_fi_ichec_racmo = fi_ichec_racmo.variables['tas'][:,:,:]
fi_ichec_racmo.close()

fi_ichec_rca = nc.Dataset('fi/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fi_ichec_rca = fi_ichec_rca.variables['tas'][:,:,:]
fi_ichec_rca.close()

fi_mpi_hirham = nc.Dataset('fi/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_fi_mpi_hirham = fi_mpi_hirham.variables['tas'][:,:,:]
fi_mpi_hirham.close()

fi_mpi_rca = nc.Dataset('fi/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fi_mpi_rca = fi_mpi_rca.variables['tas'][:,:,:]
fi_mpi_rca.close()

fi_noresm_hirham = nc.Dataset('fi/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_fi_noresm_hirham = fi_noresm_hirham.variables['tas'][:,:,:]
fi_noresm_hirham.close()

fi_noresm_racmo = nc.Dataset('fi/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_fi_noresm_racmo = fi_noresm_racmo.variables['tas'][:,:,:]
fi_noresm_racmo.close()

fi_noresm_rca = nc.Dataset('fi/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fi_noresm_rca = fi_noresm_rca.variables['tas'][:,:,:]
fi_noresm_rca.close()

variab = ['tas']
variab = variab * 130
sites= ['fi']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_fi_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_fi = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_fi[i,0] = np.mean(tas_fi_cerfacs_hirham[i,:,:])
    annual_tas_fi[i,1] = np.mean(tas_fi_cerfacs_rca[i,:,:])
    annual_tas_fi[i,2] = np.mean(tas_fi_ichec_hirham[i,:,:])
    annual_tas_fi[i,3] = np.mean(tas_fi_ichec_racmo[i,:,:])
    annual_tas_fi[i,4] = np.mean(tas_fi_ichec_rca[i,:,:])
    annual_tas_fi[i,5] = np.mean(tas_fi_mpi_hirham[i,:,:])
    annual_tas_fi[i,6] = np.mean(tas_fi_mpi_rca[i,:,:])
    annual_tas_fi[i,7] = np.mean(tas_fi_noresm_hirham[i,:,:])
    annual_tas_fi[i,8] = np.mean(tas_fi_noresm_racmo[i,:,:])
    annual_tas_fi[i,9] = np.mean(tas_fi_noresm_rca[i,:,:])
annual_tas_fi= annual_tas_fi-273.15
annual_tas_fi = np.around(annual_tas_fi,decimals=2)

yrs = no_yrs+1971
annual_tas_fi[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Finland')

df_annual_tas_fi = pd.DataFrame(annual_tas_fi, columns = label_models)
df_annual_tas_fi['var']=variab
df_annual_tas_fi['site']=sites

df_all = pd.concat([df_all,df_annual_tas_fi],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_fi.png',dpi=300)

"""FRANCE"""
fr_cerfacs_hirham = nc.Dataset('fr/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_fr_cerfacs_hirham = fr_cerfacs_hirham.variables['tas'][:,:,:]
fr_cerfacs_hirham.close()

fr_cerfacs_rca = nc.Dataset('fr/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fr_cerfacs_rca = fr_cerfacs_rca.variables['tas'][:,:,:]
fr_cerfacs_rca.close()

fr_ichec_hirham = nc.Dataset('fr/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_fr_ichec_hirham = fr_ichec_hirham.variables['tas'][:,:,:]
fr_ichec_hirham.close()

fr_ichec_racmo = nc.Dataset('fr/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_fr_ichec_racmo = fr_ichec_racmo.variables['tas'][:,:,:]
fr_ichec_racmo.close()

fr_ichec_rca = nc.Dataset('fr/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fr_ichec_rca = fr_ichec_rca.variables['tas'][:,:,:]
fr_ichec_rca.close()

fr_mpi_hirham = nc.Dataset('fr/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_fr_mpi_hirham = fr_mpi_hirham.variables['tas'][:,:,:]
fr_mpi_hirham.close()

fr_mpi_rca = nc.Dataset('fr/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fr_mpi_rca = fr_mpi_rca.variables['tas'][:,:,:]
fr_mpi_rca.close()

fr_noresm_hirham = nc.Dataset('fr/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_fr_noresm_hirham = fr_noresm_hirham.variables['tas'][:,:,:]
fr_noresm_hirham.close()

fr_noresm_racmo = nc.Dataset('fr/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_fr_noresm_racmo = fr_noresm_racmo.variables['tas'][:,:,:]
fr_noresm_racmo.close()

fr_noresm_rca = nc.Dataset('fr/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_fr_noresm_rca = fr_noresm_rca.variables['tas'][:,:,:]
fr_noresm_rca.close()


variab = ['tas']
variab = variab * 130
sites= ['fr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_fr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_fr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_fr[i,0] = np.mean(tas_fr_cerfacs_hirham[i,:,:])
    annual_tas_fr[i,1] = np.mean(tas_fr_cerfacs_rca[i,:,:])
    annual_tas_fr[i,2] = np.mean(tas_fr_ichec_hirham[i,:,:])
    annual_tas_fr[i,3] = np.mean(tas_fr_ichec_racmo[i,:,:])
    annual_tas_fr[i,4] = np.mean(tas_fr_ichec_rca[i,:,:])
    annual_tas_fr[i,5] = np.mean(tas_fr_mpi_hirham[i,:,:])
    annual_tas_fr[i,6] = np.mean(tas_fr_mpi_rca[i,:,:])
    annual_tas_fr[i,7] = np.mean(tas_fr_noresm_hirham[i,:,:])
    annual_tas_fr[i,8] = np.mean(tas_fr_noresm_racmo[i,:,:])
    annual_tas_fr[i,9] = np.mean(tas_fr_noresm_rca[i,:,:])
annual_tas_fr= annual_tas_fr-273.15
annual_tas_fr = np.around(annual_tas_fr,decimals=2)

yrs = no_yrs+1971
annual_tas_fr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('France')

df_annual_tas_fr = pd.DataFrame(annual_tas_fr, columns = label_models)
df_annual_tas_fr['var']=variab
df_annual_tas_fr['site']=sites

df_all = pd.concat([df_all,df_annual_tas_fr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_fr.png',dpi=300)

"""GREECE"""
gr_cerfacs_hirham = nc.Dataset('gr/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_gr_cerfacs_hirham = gr_cerfacs_hirham.variables['tas'][:,:,:]
gr_cerfacs_hirham.close()

gr_cerfacs_rca = nc.Dataset('gr/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_gr_cerfacs_rca = gr_cerfacs_rca.variables['tas'][:,:,:]
gr_cerfacs_rca.close()

gr_ichec_hirham = nc.Dataset('gr/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_gr_ichec_hirham = gr_ichec_hirham.variables['tas'][:,:,:]
gr_ichec_hirham.close()

gr_ichec_racmo = nc.Dataset('gr/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_gr_ichec_racmo = gr_ichec_racmo.variables['tas'][:,:,:]
gr_ichec_racmo.close()

gr_ichec_rca = nc.Dataset('gr/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_gr_ichec_rca = gr_ichec_rca.variables['tas'][:,:,:]
gr_ichec_rca.close()

gr_mpi_hirham = nc.Dataset('gr/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_gr_mpi_hirham = gr_mpi_hirham.variables['tas'][:,:,:]
gr_mpi_hirham.close()

gr_mpi_rca = nc.Dataset('gr/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_gr_mpi_rca = gr_mpi_rca.variables['tas'][:,:,:]
gr_mpi_rca.close()

gr_noresm_hirham = nc.Dataset('gr/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_gr_noresm_hirham = gr_noresm_hirham.variables['tas'][:,:,:]
gr_noresm_hirham.close()

gr_noresm_racmo = nc.Dataset('gr/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_gr_noresm_racmo = gr_noresm_racmo.variables['tas'][:,:,:]
gr_noresm_racmo.close()

gr_noresm_rca = nc.Dataset('gr/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_gr_noresm_rca = gr_noresm_rca.variables['tas'][:,:,:]
gr_noresm_rca.close()


variab = ['tas']
variab = variab * 130
sites= ['gr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_gr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_gr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_gr[i,0] = np.mean(tas_gr_cerfacs_hirham[i,:,:])
    annual_tas_gr[i,1] = np.mean(tas_gr_cerfacs_rca[i,:,:])
    annual_tas_gr[i,2] = np.mean(tas_gr_ichec_hirham[i,:,:])
    annual_tas_gr[i,3] = np.mean(tas_gr_ichec_racmo[i,:,:])
    annual_tas_gr[i,4] = np.mean(tas_gr_ichec_rca[i,:,:])
    annual_tas_gr[i,5] = np.mean(tas_gr_mpi_hirham[i,:,:])
    annual_tas_gr[i,6] = np.mean(tas_gr_mpi_rca[i,:,:])
    annual_tas_gr[i,7] = np.mean(tas_gr_noresm_hirham[i,:,:])
    annual_tas_gr[i,8] = np.mean(tas_gr_noresm_racmo[i,:,:])
    annual_tas_gr[i,9] = np.mean(tas_gr_noresm_rca[i,:,:])
annual_tas_gr= annual_tas_gr-273.15
annual_tas_gr = np.around(annual_tas_gr,decimals=2)

yrs = no_yrs+1971
annual_tas_gr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Greece')

df_annual_tas_gr = pd.DataFrame(annual_tas_gr, columns = label_models)
df_annual_tas_gr['var']=variab
df_annual_tas_gr['site']=sites

df_all = pd.concat([df_all,df_annual_tas_gr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_gr.png',dpi=300)

"""ITALY"""
it_cerfacs_hirham = nc.Dataset('it/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_it_cerfacs_hirham = it_cerfacs_hirham.variables['tas'][:,:,:]
it_cerfacs_hirham.close()

it_cerfacs_rca = nc.Dataset('it/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_it_cerfacs_rca = it_cerfacs_rca.variables['tas'][:,:,:]
it_cerfacs_rca.close()

it_ichec_hirham = nc.Dataset('it/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_it_ichec_hirham = it_ichec_hirham.variables['tas'][:,:,:]
it_ichec_hirham.close()

it_ichec_racmo = nc.Dataset('it/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_it_ichec_racmo = it_ichec_racmo.variables['tas'][:,:,:]
it_ichec_racmo.close()

it_ichec_rca = nc.Dataset('it/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_it_ichec_rca = it_ichec_rca.variables['tas'][:,:,:]
it_ichec_rca.close()

it_mpi_hirham = nc.Dataset('it/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_it_mpi_hirham = it_mpi_hirham.variables['tas'][:,:,:]
it_mpi_hirham.close()

it_mpi_rca = nc.Dataset('it/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_it_mpi_rca = it_mpi_rca.variables['tas'][:,:,:]
it_mpi_rca.close()

it_noresm_hirham = nc.Dataset('it/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_it_noresm_hirham = it_noresm_hirham.variables['tas'][:,:,:]
it_noresm_hirham.close()

it_noresm_racmo = nc.Dataset('it/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_it_noresm_racmo = it_noresm_racmo.variables['tas'][:,:,:]
it_noresm_racmo.close()

it_noresm_rca = nc.Dataset('it/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_it_noresm_rca = it_noresm_rca.variables['tas'][:,:,:]
it_noresm_rca.close()


variab = ['tas']
variab = variab * 130
sites= ['it']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_it_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_it = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_it[i,0] = np.mean(tas_it_cerfacs_hirham[i,:,:])
    annual_tas_it[i,1] = np.mean(tas_it_cerfacs_rca[i,:,:])
    annual_tas_it[i,2] = np.mean(tas_it_ichec_hirham[i,:,:])
    annual_tas_it[i,3] = np.mean(tas_it_ichec_racmo[i,:,:])
    annual_tas_it[i,4] = np.mean(tas_it_ichec_rca[i,:,:])
    annual_tas_it[i,5] = np.mean(tas_it_mpi_hirham[i,:,:])
    annual_tas_it[i,6] = np.mean(tas_it_mpi_rca[i,:,:])
    annual_tas_it[i,7] = np.mean(tas_it_noresm_hirham[i,:,:])
    annual_tas_it[i,8] = np.mean(tas_it_noresm_racmo[i,:,:])
    annual_tas_it[i,9] = np.mean(tas_it_noresm_rca[i,:,:])
annual_tas_it= annual_tas_it-273.15
annual_tas_it = np.around(annual_tas_it,decimals=2)

yrs = no_yrs+1971
annual_tas_it[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Italy')

df_annual_tas_it = pd.DataFrame(annual_tas_it, columns = label_models)
df_annual_tas_it['var']=variab
df_annual_tas_it['site']=sites

df_all = pd.concat([df_all,df_annual_tas_it],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_it.png',dpi=300)

"""ROMANIA"""
ro_cerfacs_hirham = nc.Dataset('ro/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_ro_cerfacs_hirham = ro_cerfacs_hirham.variables['tas'][:,:,:]
ro_cerfacs_hirham.close()

ro_cerfacs_rca = nc.Dataset('ro/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_ro_cerfacs_rca = ro_cerfacs_rca.variables['tas'][:,:,:]
ro_cerfacs_rca.close()

ro_ichec_hirham = nc.Dataset('ro/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_ro_ichec_hirham = ro_ichec_hirham.variables['tas'][:,:,:]
ro_ichec_hirham.close()

ro_ichec_racmo = nc.Dataset('ro/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_ro_ichec_racmo = ro_ichec_racmo.variables['tas'][:,:,:]
ro_ichec_racmo.close()

ro_ichec_rca = nc.Dataset('ro/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_ro_ichec_rca = ro_ichec_rca.variables['tas'][:,:,:]
ro_ichec_rca.close()

ro_mpi_hirham = nc.Dataset('ro/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_ro_mpi_hirham = ro_mpi_hirham.variables['tas'][:,:,:]
ro_mpi_hirham.close()

ro_mpi_rca = nc.Dataset('ro/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_ro_mpi_rca = ro_mpi_rca.variables['tas'][:,:,:]
ro_mpi_rca.close()

ro_noresm_hirham = nc.Dataset('ro/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_ro_noresm_hirham = ro_noresm_hirham.variables['tas'][:,:,:]
ro_noresm_hirham.close()

ro_noresm_racmo = nc.Dataset('ro/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_ro_noresm_racmo = ro_noresm_racmo.variables['tas'][:,:,:]
ro_noresm_racmo.close()

ro_noresm_rca = nc.Dataset('ro/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_ro_noresm_rca = ro_noresm_rca.variables['tas'][:,:,:]
ro_noresm_rca.close()


variab = ['tas']
variab = variab * 130
sites= ['ro']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_ro_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_ro = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_ro[i,0] = np.mean(tas_ro_cerfacs_hirham[i,:,:])
    annual_tas_ro[i,1] = np.mean(tas_ro_cerfacs_rca[i,:,:])
    annual_tas_ro[i,2] = np.mean(tas_ro_ichec_hirham[i,:,:])
    annual_tas_ro[i,3] = np.mean(tas_ro_ichec_racmo[i,:,:])
    annual_tas_ro[i,4] = np.mean(tas_ro_ichec_rca[i,:,:])
    annual_tas_ro[i,5] = np.mean(tas_ro_mpi_hirham[i,:,:])
    annual_tas_ro[i,6] = np.mean(tas_ro_mpi_rca[i,:,:])
    annual_tas_ro[i,7] = np.mean(tas_ro_noresm_hirham[i,:,:])
    annual_tas_ro[i,8] = np.mean(tas_ro_noresm_racmo[i,:,:])
    annual_tas_ro[i,9] = np.mean(tas_ro_noresm_rca[i,:,:])
annual_tas_ro= annual_tas_ro-273.15
annual_tas_ro = np.around(annual_tas_ro,decimals=2)

yrs = no_yrs+1971
annual_tas_ro[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Romania')

df_annual_tas_ro = pd.DataFrame(annual_tas_ro, columns = label_models)
df_annual_tas_ro['var']=variab
df_annual_tas_ro['site']=sites

df_all = pd.concat([df_all,df_annual_tas_ro],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_ro.png',dpi=300)

"""SPAIN"""
sp_cerfacs_hirham = nc.Dataset('sp/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_sp_cerfacs_hirham = sp_cerfacs_hirham.variables['tas'][:,:,:]
sp_cerfacs_hirham.close()

sp_cerfacs_rca = nc.Dataset('sp/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_sp_cerfacs_rca = sp_cerfacs_rca.variables['tas'][:,:,:]
sp_cerfacs_rca.close()

sp_ichec_hirham = nc.Dataset('sp/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_sp_ichec_hirham = sp_ichec_hirham.variables['tas'][:,:,:]
sp_ichec_hirham.close()

sp_ichec_racmo = nc.Dataset('sp/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_sp_ichec_racmo = sp_ichec_racmo.variables['tas'][:,:,:]
sp_ichec_racmo.close()

sp_ichec_rca = nc.Dataset('sp/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_sp_ichec_rca = sp_ichec_rca.variables['tas'][:,:,:]
sp_ichec_rca.close()

sp_mpi_hirham = nc.Dataset('sp/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_sp_mpi_hirham = sp_mpi_hirham.variables['tas'][:,:,:]
sp_mpi_hirham.close()

sp_mpi_rca = nc.Dataset('sp/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_sp_mpi_rca = sp_mpi_rca.variables['tas'][:,:,:]
sp_mpi_rca.close()

sp_noresm_hirham = nc.Dataset('sp/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_sp_noresm_hirham = sp_noresm_hirham.variables['tas'][:,:,:]
sp_noresm_hirham.close()

sp_noresm_racmo = nc.Dataset('sp/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_sp_noresm_racmo = sp_noresm_racmo.variables['tas'][:,:,:]
sp_noresm_racmo.close()

sp_noresm_rca = nc.Dataset('sp/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_sp_noresm_rca = sp_noresm_rca.variables['tas'][:,:,:]
sp_noresm_rca.close()


variab = ['tas']
variab = variab * 130
sites= ['sp']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_sp_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_sp = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_sp[i,0] = np.mean(tas_sp_cerfacs_hirham[i,:,:])
    annual_tas_sp[i,1] = np.mean(tas_sp_cerfacs_rca[i,:,:])
    annual_tas_sp[i,2] = np.mean(tas_sp_ichec_hirham[i,:,:])
    annual_tas_sp[i,3] = np.mean(tas_sp_ichec_racmo[i,:,:])
    annual_tas_sp[i,4] = np.mean(tas_sp_ichec_rca[i,:,:])
    annual_tas_sp[i,5] = np.mean(tas_sp_mpi_hirham[i,:,:])
    annual_tas_sp[i,6] = np.mean(tas_sp_mpi_rca[i,:,:])
    annual_tas_sp[i,7] = np.mean(tas_sp_noresm_hirham[i,:,:])
    annual_tas_sp[i,8] = np.mean(tas_sp_noresm_racmo[i,:,:])
    annual_tas_sp[i,9] = np.mean(tas_sp_noresm_rca[i,:,:])
annual_tas_sp= annual_tas_sp-273.15
annual_tas_sp = np.around(annual_tas_sp,decimals=2)

yrs = no_yrs+1971
annual_tas_sp[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('Spain')

df_annual_tas_sp = pd.DataFrame(annual_tas_sp, columns = label_models)
df_annual_tas_sp['var']=variab
df_annual_tas_sp['site']=sites

df_all = pd.concat([df_all,df_annual_tas_sp],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_sp.png',dpi=300)

"""UK"""
uk_cerfacs_hirham = nc.Dataset('uk/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tas_uk_cerfacs_hirham = uk_cerfacs_hirham.variables['tas'][:,:,:]
uk_cerfacs_hirham.close()

uk_cerfacs_rca = nc.Dataset('uk/annual/tas_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_uk_cerfacs_rca = uk_cerfacs_rca.variables['tas'][:,:,:]
uk_cerfacs_rca.close()

uk_ichec_hirham = nc.Dataset('uk/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_uk_ichec_hirham = uk_ichec_hirham.variables['tas'][:,:,:]
uk_ichec_hirham.close()

uk_ichec_racmo = nc.Dataset('uk/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_uk_ichec_racmo = uk_ichec_racmo.variables['tas'][:,:,:]
uk_ichec_racmo.close()

uk_ichec_rca = nc.Dataset('uk/annual/tas_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tas_uk_ichec_rca = uk_ichec_rca.variables['tas'][:,:,:]
uk_ichec_rca.close()

uk_mpi_hirham = nc.Dataset('uk/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tas_uk_mpi_hirham = uk_mpi_hirham.variables['tas'][:,:,:]
uk_mpi_hirham.close()

uk_mpi_rca = nc.Dataset('uk/annual/tas_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tas_uk_mpi_rca = uk_mpi_rca.variables['tas'][:,:,:]
uk_mpi_rca.close()

uk_noresm_hirham = nc.Dataset('uk/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tas_uk_noresm_hirham = uk_noresm_hirham.variables['tas'][:,:,:]
uk_noresm_hirham.close()

uk_noresm_racmo = nc.Dataset('uk/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tas_uk_noresm_racmo = uk_noresm_racmo.variables['tas'][:,:,:]
uk_noresm_racmo.close()

uk_noresm_rca = nc.Dataset('uk/annual/tas_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tas_uk_noresm_rca = uk_noresm_rca.variables['tas'][:,:,:]
uk_noresm_rca.close()

variab = ['tas']
variab = variab * 130
sites= ['uk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tas_uk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tas_uk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tas_uk[i,0] = np.mean(tas_uk_cerfacs_hirham[i,:,:])
    annual_tas_uk[i,1] = np.mean(tas_uk_cerfacs_rca[i,:,:])
    annual_tas_uk[i,2] = np.mean(tas_uk_ichec_hirham[i,:,:])
    annual_tas_uk[i,3] = np.mean(tas_uk_ichec_racmo[i,:,:])
    annual_tas_uk[i,4] = np.mean(tas_uk_ichec_rca[i,:,:])
    annual_tas_uk[i,5] = np.mean(tas_uk_mpi_hirham[i,:,:])
    annual_tas_uk[i,6] = np.mean(tas_uk_mpi_rca[i,:,:])
    annual_tas_uk[i,7] = np.mean(tas_uk_noresm_hirham[i,:,:])
    annual_tas_uk[i,8] = np.mean(tas_uk_noresm_racmo[i,:,:])
    annual_tas_uk[i,9] = np.mean(tas_uk_noresm_rca[i,:,:])
annual_tas_uk= annual_tas_uk-273.15
annual_tas_uk = np.around(annual_tas_uk,decimals=2)

yrs = no_yrs+1971
annual_tas_uk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tas_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tas_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tas_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tas_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tas_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tas_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tas_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tas_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tas_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tas_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean air temperature (Celsius)')
plt.title('UK')

df_annual_tas_uk = pd.DataFrame(annual_tas_uk, columns = label_models)
df_annual_tas_uk['var']=variab
df_annual_tas_uk['site']=sites

df_all = pd.concat([df_all,df_annual_tas_uk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tas_uk.png',dpi=300)

#################################
##################################
##################################
###########TASMIN################
################################
################################
###############################
"""AUSTRIA"""
at_cerfacs_hirham = nc.Dataset('at/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_at_cerfacs_hirham = at_cerfacs_hirham.variables['tasmin'][:,:,:]
at_cerfacs_hirham.close()

at_cerfacs_rca = nc.Dataset('at/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_at_cerfacs_rca = at_cerfacs_rca.variables['tasmin'][:,:,:]
at_cerfacs_rca.close()

at_ichec_hirham = nc.Dataset('at/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_at_ichec_hirham = at_ichec_hirham.variables['tasmin'][:,:,:]
at_ichec_hirham.close()

at_ichec_racmo = nc.Dataset('at/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_at_ichec_racmo = at_ichec_racmo.variables['tasmin'][:,:,:]
at_ichec_racmo.close()

at_ichec_rca = nc.Dataset('at/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_at_ichec_rca = at_ichec_rca.variables['tasmin'][:,:,:]
at_ichec_rca.close()

at_mpi_hirham = nc.Dataset('at/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_at_mpi_hirham = at_mpi_hirham.variables['tasmin'][:,:,:]
at_mpi_hirham.close()

at_mpi_rca = nc.Dataset('at/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_at_mpi_rca = at_mpi_rca.variables['tasmin'][:,:,:]
at_mpi_rca.close()

at_noresm_hirham = nc.Dataset('at/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_at_noresm_hirham = at_noresm_hirham.variables['tasmin'][:,:,:]
at_noresm_hirham.close()

at_noresm_racmo = nc.Dataset('at/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_at_noresm_racmo = at_noresm_racmo.variables['tasmin'][:,:,:]
at_noresm_racmo.close()

at_noresm_rca = nc.Dataset('at/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_at_noresm_rca = at_noresm_rca.variables['tasmin'][:,:,:]
at_noresm_rca.close()

len_yrs= len(tasmin_at_cerfacs_rca)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_at = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_at[i,0] = np.mean(tasmin_at_cerfacs_hirham[i,:,:])
    annual_tasmin_at[i,1] = np.mean(tasmin_at_cerfacs_rca[i,:,:])
    annual_tasmin_at[i,2] = np.mean(tasmin_at_ichec_hirham[i,:,:])
    annual_tasmin_at[i,3] = np.mean(tasmin_at_ichec_racmo[i,:,:])
    annual_tasmin_at[i,4] = np.mean(tasmin_at_ichec_rca[i,:,:])
    annual_tasmin_at[i,5] = np.mean(tasmin_at_mpi_hirham[i,:,:])
    annual_tasmin_at[i,6] = np.mean(tasmin_at_mpi_rca[i,:,:])
    annual_tasmin_at[i,7] = np.mean(tasmin_at_noresm_hirham[i,:,:])
    annual_tasmin_at[i,8] = np.mean(tasmin_at_noresm_racmo[i,:,:])
    annual_tasmin_at[i,9] = np.mean(tasmin_at_noresm_rca[i,:,:])
annual_tasmin_at= annual_tasmin_at-273.15
annual_tasmin_at = np.around(annual_tasmin_at,decimals=2)

yrs = no_yrs+1971
annual_tasmin_at[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)

variab = ['tasmin']
variab = variab * 130
sites= ['at']
sites = sites* 130



label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']
models_ap = []
for ii in np.arange(0,len(label_models)):
    models = [label_models[ii]]
    
    models = np.repeat(models,1300)
    models_ap.append(models)


plt.plot(yrs,annual_tasmin_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Austria')


df_annual_tasmin_at = pd.DataFrame(annual_tasmin_at, columns = label_models)
df_annual_tasmin_at['var']=variab
df_annual_tasmin_at['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_at],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)
plt.grid(True)
plt.show
plt.savefig('annual_tasmin_at.png',dpi=300)

"""DENMARK"""
dk_cerfacs_hirham = nc.Dataset('dk/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_dk_cerfacs_hirham = dk_cerfacs_hirham.variables['tasmin'][:,:,:]
dk_cerfacs_hirham.close()

dk_cerfacs_rca = nc.Dataset('dk/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dk_cerfacs_rca = dk_cerfacs_rca.variables['tasmin'][:,:,:]
dk_cerfacs_rca.close()

dk_ichec_hirham = nc.Dataset('dk/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_dk_ichec_hirham = dk_ichec_hirham.variables['tasmin'][:,:,:]
dk_ichec_hirham.close()

dk_ichec_racmo = nc.Dataset('dk/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_dk_ichec_racmo = dk_ichec_racmo.variables['tasmin'][:,:,:]
dk_ichec_racmo.close()

dk_ichec_rca = nc.Dataset('dk/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dk_ichec_rca = dk_ichec_rca.variables['tasmin'][:,:,:]
dk_ichec_rca.close()

dk_mpi_hirham = nc.Dataset('dk/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_dk_mpi_hirham = dk_mpi_hirham.variables['tasmin'][:,:,:]
dk_mpi_hirham.close()

dk_mpi_rca = nc.Dataset('dk/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dk_mpi_rca = dk_mpi_rca.variables['tasmin'][:,:,:]
dk_mpi_rca.close()

dk_noresm_hirham = nc.Dataset('dk/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_dk_noresm_hirham = dk_noresm_hirham.variables['tasmin'][:,:,:]
dk_noresm_hirham.close()

dk_noresm_racmo = nc.Dataset('dk/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_dk_noresm_racmo = dk_noresm_racmo.variables['tasmin'][:,:,:]
dk_noresm_racmo.close()

dk_noresm_rca = nc.Dataset('dk/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dk_noresm_rca = dk_noresm_rca.variables['tasmin'][:,:,:]
dk_noresm_rca.close()

variab = ['tasmin']
variab = variab * 130
sites= ['dk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_dk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_dk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_dk[i,0] = np.mean(tasmin_dk_cerfacs_hirham[i,:,:])
    annual_tasmin_dk[i,1] = np.mean(tasmin_dk_cerfacs_rca[i,:,:])
    annual_tasmin_dk[i,2] = np.mean(tasmin_dk_ichec_hirham[i,:,:])
    annual_tasmin_dk[i,3] = np.mean(tasmin_dk_ichec_racmo[i,:,:])
    annual_tasmin_dk[i,4] = np.mean(tasmin_dk_ichec_rca[i,:,:])
    annual_tasmin_dk[i,5] = np.mean(tasmin_dk_mpi_hirham[i,:,:])
    annual_tasmin_dk[i,6] = np.mean(tasmin_dk_mpi_rca[i,:,:])
    annual_tasmin_dk[i,7] = np.mean(tasmin_dk_noresm_hirham[i,:,:])
    annual_tasmin_dk[i,8] = np.mean(tasmin_dk_noresm_racmo[i,:,:])
    annual_tasmin_dk[i,9] = np.mean(tasmin_dk_noresm_rca[i,:,:])
annual_tasmin_dk= annual_tasmin_dk-273.15
annual_tasmin_dk = np.around(annual_tasmin_dk,decimals=2)

yrs = no_yrs+1971
annual_tasmin_dk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Denmark')

df_annual_tasmin_dk = pd.DataFrame(annual_tasmin_dk, columns = label_models)
df_annual_tasmin_dk['var']=variab
df_annual_tasmin_dk['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_dk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_dk.png',dpi=300)

"""GERMANY"""
dl_cerfacs_hirham = nc.Dataset('dl/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_dl_cerfacs_hirham = dl_cerfacs_hirham.variables['tasmin'][:,:,:]
dl_cerfacs_hirham.close()

dl_cerfacs_rca = nc.Dataset('dl/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dl_cerfacs_rca = dl_cerfacs_rca.variables['tasmin'][:,:,:]
dl_cerfacs_rca.close()

dl_ichec_hirham = nc.Dataset('dl/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_dl_ichec_hirham = dl_ichec_hirham.variables['tasmin'][:,:,:]
dl_ichec_hirham.close()

dl_ichec_racmo = nc.Dataset('dl/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_dl_ichec_racmo = dl_ichec_racmo.variables['tasmin'][:,:,:]
dl_ichec_racmo.close()

dl_ichec_rca = nc.Dataset('dl/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dl_ichec_rca = dl_ichec_rca.variables['tasmin'][:,:,:]
dl_ichec_rca.close()

dl_mpi_hirham = nc.Dataset('dl/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_dl_mpi_hirham = dl_mpi_hirham.variables['tasmin'][:,:,:]
dl_mpi_hirham.close()

dl_mpi_rca = nc.Dataset('dl/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dl_mpi_rca = dl_mpi_rca.variables['tasmin'][:,:,:]
dl_mpi_rca.close()

dl_noresm_hirham = nc.Dataset('dl/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_dl_noresm_hirham = dl_noresm_hirham.variables['tasmin'][:,:,:]
dl_noresm_hirham.close()

dl_noresm_racmo = nc.Dataset('dl/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_dl_noresm_racmo = dl_noresm_racmo.variables['tasmin'][:,:,:]
dl_noresm_racmo.close()

dl_noresm_rca = nc.Dataset('dl/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_dl_noresm_rca = dl_noresm_rca.variables['tasmin'][:,:,:]
dl_noresm_rca.close()

variab = ['tasmin']
variab = variab * 130
sites= ['dl']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_dl_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_dl = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_dl[i,0] = np.mean(tasmin_dl_cerfacs_hirham[i,:,:])
    annual_tasmin_dl[i,1] = np.mean(tasmin_dl_cerfacs_rca[i,:,:])
    annual_tasmin_dl[i,2] = np.mean(tasmin_dl_ichec_hirham[i,:,:])
    annual_tasmin_dl[i,3] = np.mean(tasmin_dl_ichec_racmo[i,:,:])
    annual_tasmin_dl[i,4] = np.mean(tasmin_dl_ichec_rca[i,:,:])
    annual_tasmin_dl[i,5] = np.mean(tasmin_dl_mpi_hirham[i,:,:])
    annual_tasmin_dl[i,6] = np.mean(tasmin_dl_mpi_rca[i,:,:])
    annual_tasmin_dl[i,7] = np.mean(tasmin_dl_noresm_hirham[i,:,:])
    annual_tasmin_dl[i,8] = np.mean(tasmin_dl_noresm_racmo[i,:,:])
    annual_tasmin_dl[i,9] = np.mean(tasmin_dl_noresm_rca[i,:,:])
annual_tasmin_dl= annual_tasmin_dl-273.15
annual_tasmin_dl = np.around(annual_tasmin_dl,decimals=2)

yrs = no_yrs+1971
annual_tasmin_dl[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Germany')

df_annual_tasmin_dl = pd.DataFrame(annual_tasmin_dl, columns = label_models)
df_annual_tasmin_dl['var']=variab
df_annual_tasmin_dl['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_dl],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_dl.png',dpi=300)


"""FINLAND"""
fi_cerfacs_hirham = nc.Dataset('fi/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_fi_cerfacs_hirham = fi_cerfacs_hirham.variables['tasmin'][:,:,:]
fi_cerfacs_hirham.close()

fi_cerfacs_rca = nc.Dataset('fi/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fi_cerfacs_rca = fi_cerfacs_rca.variables['tasmin'][:,:,:]
fi_cerfacs_rca.close()

fi_ichec_hirham = nc.Dataset('fi/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_fi_ichec_hirham = fi_ichec_hirham.variables['tasmin'][:,:,:]
fi_ichec_hirham.close()

fi_ichec_racmo = nc.Dataset('fi/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_fi_ichec_racmo = fi_ichec_racmo.variables['tasmin'][:,:,:]
fi_ichec_racmo.close()

fi_ichec_rca = nc.Dataset('fi/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fi_ichec_rca = fi_ichec_rca.variables['tasmin'][:,:,:]
fi_ichec_rca.close()

fi_mpi_hirham = nc.Dataset('fi/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_fi_mpi_hirham = fi_mpi_hirham.variables['tasmin'][:,:,:]
fi_mpi_hirham.close()

fi_mpi_rca = nc.Dataset('fi/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fi_mpi_rca = fi_mpi_rca.variables['tasmin'][:,:,:]
fi_mpi_rca.close()

fi_noresm_hirham = nc.Dataset('fi/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_fi_noresm_hirham = fi_noresm_hirham.variables['tasmin'][:,:,:]
fi_noresm_hirham.close()

fi_noresm_racmo = nc.Dataset('fi/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_fi_noresm_racmo = fi_noresm_racmo.variables['tasmin'][:,:,:]
fi_noresm_racmo.close()

fi_noresm_rca = nc.Dataset('fi/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fi_noresm_rca = fi_noresm_rca.variables['tasmin'][:,:,:]
fi_noresm_rca.close()

variab = ['tasmin']
variab = variab * 130
sites= ['fi']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_fi_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_fi = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_fi[i,0] = np.mean(tasmin_fi_cerfacs_hirham[i,:,:])
    annual_tasmin_fi[i,1] = np.mean(tasmin_fi_cerfacs_rca[i,:,:])
    annual_tasmin_fi[i,2] = np.mean(tasmin_fi_ichec_hirham[i,:,:])
    annual_tasmin_fi[i,3] = np.mean(tasmin_fi_ichec_racmo[i,:,:])
    annual_tasmin_fi[i,4] = np.mean(tasmin_fi_ichec_rca[i,:,:])
    annual_tasmin_fi[i,5] = np.mean(tasmin_fi_mpi_hirham[i,:,:])
    annual_tasmin_fi[i,6] = np.mean(tasmin_fi_mpi_rca[i,:,:])
    annual_tasmin_fi[i,7] = np.mean(tasmin_fi_noresm_hirham[i,:,:])
    annual_tasmin_fi[i,8] = np.mean(tasmin_fi_noresm_racmo[i,:,:])
    annual_tasmin_fi[i,9] = np.mean(tasmin_fi_noresm_rca[i,:,:])
annual_tasmin_fi= annual_tasmin_fi-273.15
annual_tasmin_fi = np.around(annual_tasmin_fi,decimals=2)

yrs = no_yrs+1971
annual_tasmin_fi[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Finland')

df_annual_tasmin_fi = pd.DataFrame(annual_tasmin_fi, columns = label_models)
df_annual_tasmin_fi['var']=variab
df_annual_tasmin_fi['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_fi],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_fi.png',dpi=300)

"""FRANCE"""
fr_cerfacs_hirham = nc.Dataset('fr/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_fr_cerfacs_hirham = fr_cerfacs_hirham.variables['tasmin'][:,:,:]
fr_cerfacs_hirham.close()

fr_cerfacs_rca = nc.Dataset('fr/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fr_cerfacs_rca = fr_cerfacs_rca.variables['tasmin'][:,:,:]
fr_cerfacs_rca.close()

fr_ichec_hirham = nc.Dataset('fr/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_fr_ichec_hirham = fr_ichec_hirham.variables['tasmin'][:,:,:]
fr_ichec_hirham.close()

fr_ichec_racmo = nc.Dataset('fr/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_fr_ichec_racmo = fr_ichec_racmo.variables['tasmin'][:,:,:]
fr_ichec_racmo.close()

fr_ichec_rca = nc.Dataset('fr/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fr_ichec_rca = fr_ichec_rca.variables['tasmin'][:,:,:]
fr_ichec_rca.close()

fr_mpi_hirham = nc.Dataset('fr/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_fr_mpi_hirham = fr_mpi_hirham.variables['tasmin'][:,:,:]
fr_mpi_hirham.close()

fr_mpi_rca = nc.Dataset('fr/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fr_mpi_rca = fr_mpi_rca.variables['tasmin'][:,:,:]
fr_mpi_rca.close()

fr_noresm_hirham = nc.Dataset('fr/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_fr_noresm_hirham = fr_noresm_hirham.variables['tasmin'][:,:,:]
fr_noresm_hirham.close()

fr_noresm_racmo = nc.Dataset('fr/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_fr_noresm_racmo = fr_noresm_racmo.variables['tasmin'][:,:,:]
fr_noresm_racmo.close()

fr_noresm_rca = nc.Dataset('fr/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_fr_noresm_rca = fr_noresm_rca.variables['tasmin'][:,:,:]
fr_noresm_rca.close()


variab = ['tasmin']
variab = variab * 130
sites= ['fr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_fr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_fr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_fr[i,0] = np.mean(tasmin_fr_cerfacs_hirham[i,:,:])
    annual_tasmin_fr[i,1] = np.mean(tasmin_fr_cerfacs_rca[i,:,:])
    annual_tasmin_fr[i,2] = np.mean(tasmin_fr_ichec_hirham[i,:,:])
    annual_tasmin_fr[i,3] = np.mean(tasmin_fr_ichec_racmo[i,:,:])
    annual_tasmin_fr[i,4] = np.mean(tasmin_fr_ichec_rca[i,:,:])
    annual_tasmin_fr[i,5] = np.mean(tasmin_fr_mpi_hirham[i,:,:])
    annual_tasmin_fr[i,6] = np.mean(tasmin_fr_mpi_rca[i,:,:])
    annual_tasmin_fr[i,7] = np.mean(tasmin_fr_noresm_hirham[i,:,:])
    annual_tasmin_fr[i,8] = np.mean(tasmin_fr_noresm_racmo[i,:,:])
    annual_tasmin_fr[i,9] = np.mean(tasmin_fr_noresm_rca[i,:,:])
annual_tasmin_fr= annual_tasmin_fr-273.15
annual_tasmin_fr = np.around(annual_tasmin_fr,decimals=2)

yrs = no_yrs+1971
annual_tasmin_fr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('France')

df_annual_tasmin_fr = pd.DataFrame(annual_tasmin_fr, columns = label_models)
df_annual_tasmin_fr['var']=variab
df_annual_tasmin_fr['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_fr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_fr.png',dpi=300)

"""GREECE"""
gr_cerfacs_hirham = nc.Dataset('gr/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_gr_cerfacs_hirham = gr_cerfacs_hirham.variables['tasmin'][:,:,:]
gr_cerfacs_hirham.close()

gr_cerfacs_rca = nc.Dataset('gr/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_gr_cerfacs_rca = gr_cerfacs_rca.variables['tasmin'][:,:,:]
gr_cerfacs_rca.close()

gr_ichec_hirham = nc.Dataset('gr/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_gr_ichec_hirham = gr_ichec_hirham.variables['tasmin'][:,:,:]
gr_ichec_hirham.close()

gr_ichec_racmo = nc.Dataset('gr/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_gr_ichec_racmo = gr_ichec_racmo.variables['tasmin'][:,:,:]
gr_ichec_racmo.close()

gr_ichec_rca = nc.Dataset('gr/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_gr_ichec_rca = gr_ichec_rca.variables['tasmin'][:,:,:]
gr_ichec_rca.close()

gr_mpi_hirham = nc.Dataset('gr/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_gr_mpi_hirham = gr_mpi_hirham.variables['tasmin'][:,:,:]
gr_mpi_hirham.close()

gr_mpi_rca = nc.Dataset('gr/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_gr_mpi_rca = gr_mpi_rca.variables['tasmin'][:,:,:]
gr_mpi_rca.close()

gr_noresm_hirham = nc.Dataset('gr/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_gr_noresm_hirham = gr_noresm_hirham.variables['tasmin'][:,:,:]
gr_noresm_hirham.close()

gr_noresm_racmo = nc.Dataset('gr/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_gr_noresm_racmo = gr_noresm_racmo.variables['tasmin'][:,:,:]
gr_noresm_racmo.close()

gr_noresm_rca = nc.Dataset('gr/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_gr_noresm_rca = gr_noresm_rca.variables['tasmin'][:,:,:]
gr_noresm_rca.close()


variab = ['tasmin']
variab = variab * 130
sites= ['gr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_gr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_gr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_gr[i,0] = np.mean(tasmin_gr_cerfacs_hirham[i,:,:])
    annual_tasmin_gr[i,1] = np.mean(tasmin_gr_cerfacs_rca[i,:,:])
    annual_tasmin_gr[i,2] = np.mean(tasmin_gr_ichec_hirham[i,:,:])
    annual_tasmin_gr[i,3] = np.mean(tasmin_gr_ichec_racmo[i,:,:])
    annual_tasmin_gr[i,4] = np.mean(tasmin_gr_ichec_rca[i,:,:])
    annual_tasmin_gr[i,5] = np.mean(tasmin_gr_mpi_hirham[i,:,:])
    annual_tasmin_gr[i,6] = np.mean(tasmin_gr_mpi_rca[i,:,:])
    annual_tasmin_gr[i,7] = np.mean(tasmin_gr_noresm_hirham[i,:,:])
    annual_tasmin_gr[i,8] = np.mean(tasmin_gr_noresm_racmo[i,:,:])
    annual_tasmin_gr[i,9] = np.mean(tasmin_gr_noresm_rca[i,:,:])
annual_tasmin_gr= annual_tasmin_gr-273.15
annual_tasmin_gr = np.around(annual_tasmin_gr,decimals=2)

yrs = no_yrs+1971
annual_tasmin_gr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Greece')

df_annual_tasmin_gr = pd.DataFrame(annual_tasmin_gr, columns = label_models)
df_annual_tasmin_gr['var']=variab
df_annual_tasmin_gr['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_gr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_gr.png',dpi=300)

"""ITALY"""
it_cerfacs_hirham = nc.Dataset('it/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_it_cerfacs_hirham = it_cerfacs_hirham.variables['tasmin'][:,:,:]
it_cerfacs_hirham.close()

it_cerfacs_rca = nc.Dataset('it/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_it_cerfacs_rca = it_cerfacs_rca.variables['tasmin'][:,:,:]
it_cerfacs_rca.close()

it_ichec_hirham = nc.Dataset('it/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_it_ichec_hirham = it_ichec_hirham.variables['tasmin'][:,:,:]
it_ichec_hirham.close()

it_ichec_racmo = nc.Dataset('it/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_it_ichec_racmo = it_ichec_racmo.variables['tasmin'][:,:,:]
it_ichec_racmo.close()

it_ichec_rca = nc.Dataset('it/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_it_ichec_rca = it_ichec_rca.variables['tasmin'][:,:,:]
it_ichec_rca.close()

it_mpi_hirham = nc.Dataset('it/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_it_mpi_hirham = it_mpi_hirham.variables['tasmin'][:,:,:]
it_mpi_hirham.close()

it_mpi_rca = nc.Dataset('it/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_it_mpi_rca = it_mpi_rca.variables['tasmin'][:,:,:]
it_mpi_rca.close()

it_noresm_hirham = nc.Dataset('it/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_it_noresm_hirham = it_noresm_hirham.variables['tasmin'][:,:,:]
it_noresm_hirham.close()

it_noresm_racmo = nc.Dataset('it/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_it_noresm_racmo = it_noresm_racmo.variables['tasmin'][:,:,:]
it_noresm_racmo.close()

it_noresm_rca = nc.Dataset('it/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_it_noresm_rca = it_noresm_rca.variables['tasmin'][:,:,:]
it_noresm_rca.close()


variab = ['tasmin']
variab = variab * 130
sites= ['it']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_it_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_it = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_it[i,0] = np.mean(tasmin_it_cerfacs_hirham[i,:,:])
    annual_tasmin_it[i,1] = np.mean(tasmin_it_cerfacs_rca[i,:,:])
    annual_tasmin_it[i,2] = np.mean(tasmin_it_ichec_hirham[i,:,:])
    annual_tasmin_it[i,3] = np.mean(tasmin_it_ichec_racmo[i,:,:])
    annual_tasmin_it[i,4] = np.mean(tasmin_it_ichec_rca[i,:,:])
    annual_tasmin_it[i,5] = np.mean(tasmin_it_mpi_hirham[i,:,:])
    annual_tasmin_it[i,6] = np.mean(tasmin_it_mpi_rca[i,:,:])
    annual_tasmin_it[i,7] = np.mean(tasmin_it_noresm_hirham[i,:,:])
    annual_tasmin_it[i,8] = np.mean(tasmin_it_noresm_racmo[i,:,:])
    annual_tasmin_it[i,9] = np.mean(tasmin_it_noresm_rca[i,:,:])
annual_tasmin_it= annual_tasmin_it-273.15
annual_tasmin_it = np.around(annual_tasmin_it,decimals=2)

yrs = no_yrs+1971
annual_tasmin_it[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Italy')

df_annual_tasmin_it = pd.DataFrame(annual_tasmin_it, columns = label_models)
df_annual_tasmin_it['var']=variab
df_annual_tasmin_it['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_it],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_it.png',dpi=300)

"""ROMANIA"""
ro_cerfacs_hirham = nc.Dataset('ro/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_ro_cerfacs_hirham = ro_cerfacs_hirham.variables['tasmin'][:,:,:]
ro_cerfacs_hirham.close()

ro_cerfacs_rca = nc.Dataset('ro/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_ro_cerfacs_rca = ro_cerfacs_rca.variables['tasmin'][:,:,:]
ro_cerfacs_rca.close()

ro_ichec_hirham = nc.Dataset('ro/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_ro_ichec_hirham = ro_ichec_hirham.variables['tasmin'][:,:,:]
ro_ichec_hirham.close()

ro_ichec_racmo = nc.Dataset('ro/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_ro_ichec_racmo = ro_ichec_racmo.variables['tasmin'][:,:,:]
ro_ichec_racmo.close()

ro_ichec_rca = nc.Dataset('ro/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_ro_ichec_rca = ro_ichec_rca.variables['tasmin'][:,:,:]
ro_ichec_rca.close()

ro_mpi_hirham = nc.Dataset('ro/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_ro_mpi_hirham = ro_mpi_hirham.variables['tasmin'][:,:,:]
ro_mpi_hirham.close()

ro_mpi_rca = nc.Dataset('ro/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_ro_mpi_rca = ro_mpi_rca.variables['tasmin'][:,:,:]
ro_mpi_rca.close()

ro_noresm_hirham = nc.Dataset('ro/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_ro_noresm_hirham = ro_noresm_hirham.variables['tasmin'][:,:,:]
ro_noresm_hirham.close()

ro_noresm_racmo = nc.Dataset('ro/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_ro_noresm_racmo = ro_noresm_racmo.variables['tasmin'][:,:,:]
ro_noresm_racmo.close()

ro_noresm_rca = nc.Dataset('ro/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_ro_noresm_rca = ro_noresm_rca.variables['tasmin'][:,:,:]
ro_noresm_rca.close()


variab = ['tasmin']
variab = variab * 130
sites= ['ro']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_ro_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_ro = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_ro[i,0] = np.mean(tasmin_ro_cerfacs_hirham[i,:,:])
    annual_tasmin_ro[i,1] = np.mean(tasmin_ro_cerfacs_rca[i,:,:])
    annual_tasmin_ro[i,2] = np.mean(tasmin_ro_ichec_hirham[i,:,:])
    annual_tasmin_ro[i,3] = np.mean(tasmin_ro_ichec_racmo[i,:,:])
    annual_tasmin_ro[i,4] = np.mean(tasmin_ro_ichec_rca[i,:,:])
    annual_tasmin_ro[i,5] = np.mean(tasmin_ro_mpi_hirham[i,:,:])
    annual_tasmin_ro[i,6] = np.mean(tasmin_ro_mpi_rca[i,:,:])
    annual_tasmin_ro[i,7] = np.mean(tasmin_ro_noresm_hirham[i,:,:])
    annual_tasmin_ro[i,8] = np.mean(tasmin_ro_noresm_racmo[i,:,:])
    annual_tasmin_ro[i,9] = np.mean(tasmin_ro_noresm_rca[i,:,:])
annual_tasmin_ro= annual_tasmin_ro-273.15
annual_tasmin_ro = np.around(annual_tasmin_ro,decimals=2)

yrs = no_yrs+1971
annual_tasmin_ro[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Romania')

df_annual_tasmin_ro = pd.DataFrame(annual_tasmin_ro, columns = label_models)
df_annual_tasmin_ro['var']=variab
df_annual_tasmin_ro['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_ro],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_ro.png',dpi=300)

"""SPAIN"""
sp_cerfacs_hirham = nc.Dataset('sp/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_sp_cerfacs_hirham = sp_cerfacs_hirham.variables['tasmin'][:,:,:]
sp_cerfacs_hirham.close()

sp_cerfacs_rca = nc.Dataset('sp/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_sp_cerfacs_rca = sp_cerfacs_rca.variables['tasmin'][:,:,:]
sp_cerfacs_rca.close()

sp_ichec_hirham = nc.Dataset('sp/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_sp_ichec_hirham = sp_ichec_hirham.variables['tasmin'][:,:,:]
sp_ichec_hirham.close()

sp_ichec_racmo = nc.Dataset('sp/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_sp_ichec_racmo = sp_ichec_racmo.variables['tasmin'][:,:,:]
sp_ichec_racmo.close()

sp_ichec_rca = nc.Dataset('sp/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_sp_ichec_rca = sp_ichec_rca.variables['tasmin'][:,:,:]
sp_ichec_rca.close()

sp_mpi_hirham = nc.Dataset('sp/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_sp_mpi_hirham = sp_mpi_hirham.variables['tasmin'][:,:,:]
sp_mpi_hirham.close()

sp_mpi_rca = nc.Dataset('sp/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_sp_mpi_rca = sp_mpi_rca.variables['tasmin'][:,:,:]
sp_mpi_rca.close()

sp_noresm_hirham = nc.Dataset('sp/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_sp_noresm_hirham = sp_noresm_hirham.variables['tasmin'][:,:,:]
sp_noresm_hirham.close()

sp_noresm_racmo = nc.Dataset('sp/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_sp_noresm_racmo = sp_noresm_racmo.variables['tasmin'][:,:,:]
sp_noresm_racmo.close()

sp_noresm_rca = nc.Dataset('sp/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_sp_noresm_rca = sp_noresm_rca.variables['tasmin'][:,:,:]
sp_noresm_rca.close()


variab = ['tasmin']
variab = variab * 130
sites= ['sp']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_sp_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_sp = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_sp[i,0] = np.mean(tasmin_sp_cerfacs_hirham[i,:,:])
    annual_tasmin_sp[i,1] = np.mean(tasmin_sp_cerfacs_rca[i,:,:])
    annual_tasmin_sp[i,2] = np.mean(tasmin_sp_ichec_hirham[i,:,:])
    annual_tasmin_sp[i,3] = np.mean(tasmin_sp_ichec_racmo[i,:,:])
    annual_tasmin_sp[i,4] = np.mean(tasmin_sp_ichec_rca[i,:,:])
    annual_tasmin_sp[i,5] = np.mean(tasmin_sp_mpi_hirham[i,:,:])
    annual_tasmin_sp[i,6] = np.mean(tasmin_sp_mpi_rca[i,:,:])
    annual_tasmin_sp[i,7] = np.mean(tasmin_sp_noresm_hirham[i,:,:])
    annual_tasmin_sp[i,8] = np.mean(tasmin_sp_noresm_racmo[i,:,:])
    annual_tasmin_sp[i,9] = np.mean(tasmin_sp_noresm_rca[i,:,:])
annual_tasmin_sp= annual_tasmin_sp-273.15
annual_tasmin_sp = np.around(annual_tasmin_sp,decimals=2)

yrs = no_yrs+1971
annual_tasmin_sp[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('Spain')

df_annual_tasmin_sp = pd.DataFrame(annual_tasmin_sp, columns = label_models)
df_annual_tasmin_sp['var']=variab
df_annual_tasmin_sp['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_sp],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_sp.png',dpi=300)

"""UK"""
uk_cerfacs_hirham = nc.Dataset('uk/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmin_uk_cerfacs_hirham = uk_cerfacs_hirham.variables['tasmin'][:,:,:]
uk_cerfacs_hirham.close()

uk_cerfacs_rca = nc.Dataset('uk/annual/tasmin_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_uk_cerfacs_rca = uk_cerfacs_rca.variables['tasmin'][:,:,:]
uk_cerfacs_rca.close()

uk_ichec_hirham = nc.Dataset('uk/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_uk_ichec_hirham = uk_ichec_hirham.variables['tasmin'][:,:,:]
uk_ichec_hirham.close()

uk_ichec_racmo = nc.Dataset('uk/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_uk_ichec_racmo = uk_ichec_racmo.variables['tasmin'][:,:,:]
uk_ichec_racmo.close()

uk_ichec_rca = nc.Dataset('uk/annual/tasmin_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_uk_ichec_rca = uk_ichec_rca.variables['tasmin'][:,:,:]
uk_ichec_rca.close()

uk_mpi_hirham = nc.Dataset('uk/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmin_uk_mpi_hirham = uk_mpi_hirham.variables['tasmin'][:,:,:]
uk_mpi_hirham.close()

uk_mpi_rca = nc.Dataset('uk/annual/tasmin_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_uk_mpi_rca = uk_mpi_rca.variables['tasmin'][:,:,:]
uk_mpi_rca.close()

uk_noresm_hirham = nc.Dataset('uk/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmin_uk_noresm_hirham = uk_noresm_hirham.variables['tasmin'][:,:,:]
uk_noresm_hirham.close()

uk_noresm_racmo = nc.Dataset('uk/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmin_uk_noresm_racmo = uk_noresm_racmo.variables['tasmin'][:,:,:]
uk_noresm_racmo.close()

uk_noresm_rca = nc.Dataset('uk/annual/tasmin_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmin_uk_noresm_rca = uk_noresm_rca.variables['tasmin'][:,:,:]
uk_noresm_rca.close()

variab = ['tasmin']
variab = variab * 130
sites= ['uk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmin_uk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmin_uk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmin_uk[i,0] = np.mean(tasmin_uk_cerfacs_hirham[i,:,:])
    annual_tasmin_uk[i,1] = np.mean(tasmin_uk_cerfacs_rca[i,:,:])
    annual_tasmin_uk[i,2] = np.mean(tasmin_uk_ichec_hirham[i,:,:])
    annual_tasmin_uk[i,3] = np.mean(tasmin_uk_ichec_racmo[i,:,:])
    annual_tasmin_uk[i,4] = np.mean(tasmin_uk_ichec_rca[i,:,:])
    annual_tasmin_uk[i,5] = np.mean(tasmin_uk_mpi_hirham[i,:,:])
    annual_tasmin_uk[i,6] = np.mean(tasmin_uk_mpi_rca[i,:,:])
    annual_tasmin_uk[i,7] = np.mean(tasmin_uk_noresm_hirham[i,:,:])
    annual_tasmin_uk[i,8] = np.mean(tasmin_uk_noresm_racmo[i,:,:])
    annual_tasmin_uk[i,9] = np.mean(tasmin_uk_noresm_rca[i,:,:])
annual_tasmin_uk= annual_tasmin_uk-273.15
annual_tasmin_uk = np.around(annual_tasmin_uk,decimals=2)

yrs = no_yrs+1971
annual_tasmin_uk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmin_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmin_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean minimum air temperature (Celsius)')
plt.title('UK')

df_annual_tasmin_uk = pd.DataFrame(annual_tasmin_uk, columns = label_models)
df_annual_tasmin_uk['var']=variab
df_annual_tasmin_uk['site']=sites

df_all = pd.concat([df_all,df_annual_tasmin_uk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmin_uk.png',dpi=300)


###########################
###########################
###########################
####TASMAX
###########################
###########################
###########################
"""AUSTRIA"""
at_cerfacs_hirham = nc.Dataset('at/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_at_cerfacs_hirham = at_cerfacs_hirham.variables['tasmax'][:,:,:]
at_cerfacs_hirham.close()

at_cerfacs_rca = nc.Dataset('at/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_at_cerfacs_rca = at_cerfacs_rca.variables['tasmax'][:,:,:]
at_cerfacs_rca.close()

at_ichec_hirham = nc.Dataset('at/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_at_ichec_hirham = at_ichec_hirham.variables['tasmax'][:,:,:]
at_ichec_hirham.close()

at_ichec_racmo = nc.Dataset('at/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_at_ichec_racmo = at_ichec_racmo.variables['tasmax'][:,:,:]
at_ichec_racmo.close()

at_ichec_rca = nc.Dataset('at/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_at_ichec_rca = at_ichec_rca.variables['tasmax'][:,:,:]
at_ichec_rca.close()

at_mpi_hirham = nc.Dataset('at/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_at_mpi_hirham = at_mpi_hirham.variables['tasmax'][:,:,:]
at_mpi_hirham.close()

at_mpi_rca = nc.Dataset('at/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_at_mpi_rca = at_mpi_rca.variables['tasmax'][:,:,:]
at_mpi_rca.close()

at_noresm_hirham = nc.Dataset('at/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_at_noresm_hirham = at_noresm_hirham.variables['tasmax'][:,:,:]
at_noresm_hirham.close()

at_noresm_racmo = nc.Dataset('at/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_at_noresm_racmo = at_noresm_racmo.variables['tasmax'][:,:,:]
at_noresm_racmo.close()

at_noresm_rca = nc.Dataset('at/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_at_noresm_rca = at_noresm_rca.variables['tasmax'][:,:,:]
at_noresm_rca.close()

len_yrs= len(tasmax_at_cerfacs_rca)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_at = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_at[i,0] = np.mean(tasmax_at_cerfacs_hirham[i,:,:])
    annual_tasmax_at[i,1] = np.mean(tasmax_at_cerfacs_rca[i,:,:])
    annual_tasmax_at[i,2] = np.mean(tasmax_at_ichec_hirham[i,:,:])
    annual_tasmax_at[i,3] = np.mean(tasmax_at_ichec_racmo[i,:,:])
    annual_tasmax_at[i,4] = np.mean(tasmax_at_ichec_rca[i,:,:])
    annual_tasmax_at[i,5] = np.mean(tasmax_at_mpi_hirham[i,:,:])
    annual_tasmax_at[i,6] = np.mean(tasmax_at_mpi_rca[i,:,:])
    annual_tasmax_at[i,7] = np.mean(tasmax_at_noresm_hirham[i,:,:])
    annual_tasmax_at[i,8] = np.mean(tasmax_at_noresm_racmo[i,:,:])
    annual_tasmax_at[i,9] = np.mean(tasmax_at_noresm_rca[i,:,:])
annual_tasmax_at= annual_tasmax_at-273.15
annual_tasmax_at = np.around(annual_tasmax_at,decimals=2)

yrs = no_yrs+1971
annual_tasmax_at[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)

variab = ['tasmax']
variab = variab * 130
sites= ['at']
sites = sites* 130



label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']
models_ap = []
for ii in np.arange(0,len(label_models)):
    models = [label_models[ii]]
    
    models = np.repeat(models,1300)
    models_ap.append(models)


plt.plot(yrs,annual_tasmax_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Austria')


df_annual_tasmax_at = pd.DataFrame(annual_tasmax_at, columns = label_models)
df_annual_tasmax_at['var']=variab
df_annual_tasmax_at['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_at],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)
plt.grid(True)
plt.show
plt.savefig('annual_tasmax_at.png',dpi=300)

"""DENMARK"""
dk_cerfacs_hirham = nc.Dataset('dk/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_dk_cerfacs_hirham = dk_cerfacs_hirham.variables['tasmax'][:,:,:]
dk_cerfacs_hirham.close()

dk_cerfacs_rca = nc.Dataset('dk/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dk_cerfacs_rca = dk_cerfacs_rca.variables['tasmax'][:,:,:]
dk_cerfacs_rca.close()

dk_ichec_hirham = nc.Dataset('dk/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_dk_ichec_hirham = dk_ichec_hirham.variables['tasmax'][:,:,:]
dk_ichec_hirham.close()

dk_ichec_racmo = nc.Dataset('dk/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_dk_ichec_racmo = dk_ichec_racmo.variables['tasmax'][:,:,:]
dk_ichec_racmo.close()

dk_ichec_rca = nc.Dataset('dk/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dk_ichec_rca = dk_ichec_rca.variables['tasmax'][:,:,:]
dk_ichec_rca.close()

dk_mpi_hirham = nc.Dataset('dk/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_dk_mpi_hirham = dk_mpi_hirham.variables['tasmax'][:,:,:]
dk_mpi_hirham.close()

dk_mpi_rca = nc.Dataset('dk/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dk_mpi_rca = dk_mpi_rca.variables['tasmax'][:,:,:]
dk_mpi_rca.close()

dk_noresm_hirham = nc.Dataset('dk/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_dk_noresm_hirham = dk_noresm_hirham.variables['tasmax'][:,:,:]
dk_noresm_hirham.close()

dk_noresm_racmo = nc.Dataset('dk/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_dk_noresm_racmo = dk_noresm_racmo.variables['tasmax'][:,:,:]
dk_noresm_racmo.close()

dk_noresm_rca = nc.Dataset('dk/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dk_noresm_rca = dk_noresm_rca.variables['tasmax'][:,:,:]
dk_noresm_rca.close()

variab = ['tasmax']
variab = variab * 130
sites= ['dk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_dk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_dk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_dk[i,0] = np.mean(tasmax_dk_cerfacs_hirham[i,:,:])
    annual_tasmax_dk[i,1] = np.mean(tasmax_dk_cerfacs_rca[i,:,:])
    annual_tasmax_dk[i,2] = np.mean(tasmax_dk_ichec_hirham[i,:,:])
    annual_tasmax_dk[i,3] = np.mean(tasmax_dk_ichec_racmo[i,:,:])
    annual_tasmax_dk[i,4] = np.mean(tasmax_dk_ichec_rca[i,:,:])
    annual_tasmax_dk[i,5] = np.mean(tasmax_dk_mpi_hirham[i,:,:])
    annual_tasmax_dk[i,6] = np.mean(tasmax_dk_mpi_rca[i,:,:])
    annual_tasmax_dk[i,7] = np.mean(tasmax_dk_noresm_hirham[i,:,:])
    annual_tasmax_dk[i,8] = np.mean(tasmax_dk_noresm_racmo[i,:,:])
    annual_tasmax_dk[i,9] = np.mean(tasmax_dk_noresm_rca[i,:,:])
annual_tasmax_dk= annual_tasmax_dk-273.15
annual_tasmax_dk = np.around(annual_tasmax_dk,decimals=2)

yrs = no_yrs+1971
annual_tasmax_dk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Denmark')

df_annual_tasmax_dk = pd.DataFrame(annual_tasmax_dk, columns = label_models)
df_annual_tasmax_dk['var']=variab
df_annual_tasmax_dk['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_dk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_dk.png',dpi=300)

"""GERMANY"""
dl_cerfacs_hirham = nc.Dataset('dl/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_dl_cerfacs_hirham = dl_cerfacs_hirham.variables['tasmax'][:,:,:]
dl_cerfacs_hirham.close()

dl_cerfacs_rca = nc.Dataset('dl/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dl_cerfacs_rca = dl_cerfacs_rca.variables['tasmax'][:,:,:]
dl_cerfacs_rca.close()

dl_ichec_hirham = nc.Dataset('dl/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_dl_ichec_hirham = dl_ichec_hirham.variables['tasmax'][:,:,:]
dl_ichec_hirham.close()

dl_ichec_racmo = nc.Dataset('dl/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_dl_ichec_racmo = dl_ichec_racmo.variables['tasmax'][:,:,:]
dl_ichec_racmo.close()

dl_ichec_rca = nc.Dataset('dl/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dl_ichec_rca = dl_ichec_rca.variables['tasmax'][:,:,:]
dl_ichec_rca.close()

dl_mpi_hirham = nc.Dataset('dl/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_dl_mpi_hirham = dl_mpi_hirham.variables['tasmax'][:,:,:]
dl_mpi_hirham.close()

dl_mpi_rca = nc.Dataset('dl/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dl_mpi_rca = dl_mpi_rca.variables['tasmax'][:,:,:]
dl_mpi_rca.close()

dl_noresm_hirham = nc.Dataset('dl/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_dl_noresm_hirham = dl_noresm_hirham.variables['tasmax'][:,:,:]
dl_noresm_hirham.close()

dl_noresm_racmo = nc.Dataset('dl/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_dl_noresm_racmo = dl_noresm_racmo.variables['tasmax'][:,:,:]
dl_noresm_racmo.close()

dl_noresm_rca = nc.Dataset('dl/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_dl_noresm_rca = dl_noresm_rca.variables['tasmax'][:,:,:]
dl_noresm_rca.close()

variab = ['tasmax']
variab = variab * 130
sites= ['dl']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_dl_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_dl = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_dl[i,0] = np.mean(tasmax_dl_cerfacs_hirham[i,:,:])
    annual_tasmax_dl[i,1] = np.mean(tasmax_dl_cerfacs_rca[i,:,:])
    annual_tasmax_dl[i,2] = np.mean(tasmax_dl_ichec_hirham[i,:,:])
    annual_tasmax_dl[i,3] = np.mean(tasmax_dl_ichec_racmo[i,:,:])
    annual_tasmax_dl[i,4] = np.mean(tasmax_dl_ichec_rca[i,:,:])
    annual_tasmax_dl[i,5] = np.mean(tasmax_dl_mpi_hirham[i,:,:])
    annual_tasmax_dl[i,6] = np.mean(tasmax_dl_mpi_rca[i,:,:])
    annual_tasmax_dl[i,7] = np.mean(tasmax_dl_noresm_hirham[i,:,:])
    annual_tasmax_dl[i,8] = np.mean(tasmax_dl_noresm_racmo[i,:,:])
    annual_tasmax_dl[i,9] = np.mean(tasmax_dl_noresm_rca[i,:,:])
annual_tasmax_dl= annual_tasmax_dl-273.15
annual_tasmax_dl = np.around(annual_tasmax_dl,decimals=2)

yrs = no_yrs+1971
annual_tasmax_dl[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Germany')

df_annual_tasmax_dl = pd.DataFrame(annual_tasmax_dl, columns = label_models)
df_annual_tasmax_dl['var']=variab
df_annual_tasmax_dl['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_dl],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_dl.png',dpi=300)


"""FINLAND"""
fi_cerfacs_hirham = nc.Dataset('fi/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_fi_cerfacs_hirham = fi_cerfacs_hirham.variables['tasmax'][:,:,:]
fi_cerfacs_hirham.close()

fi_cerfacs_rca = nc.Dataset('fi/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fi_cerfacs_rca = fi_cerfacs_rca.variables['tasmax'][:,:,:]
fi_cerfacs_rca.close()

fi_ichec_hirham = nc.Dataset('fi/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_fi_ichec_hirham = fi_ichec_hirham.variables['tasmax'][:,:,:]
fi_ichec_hirham.close()

fi_ichec_racmo = nc.Dataset('fi/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_fi_ichec_racmo = fi_ichec_racmo.variables['tasmax'][:,:,:]
fi_ichec_racmo.close()

fi_ichec_rca = nc.Dataset('fi/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fi_ichec_rca = fi_ichec_rca.variables['tasmax'][:,:,:]
fi_ichec_rca.close()

fi_mpi_hirham = nc.Dataset('fi/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_fi_mpi_hirham = fi_mpi_hirham.variables['tasmax'][:,:,:]
fi_mpi_hirham.close()

fi_mpi_rca = nc.Dataset('fi/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fi_mpi_rca = fi_mpi_rca.variables['tasmax'][:,:,:]
fi_mpi_rca.close()

fi_noresm_hirham = nc.Dataset('fi/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_fi_noresm_hirham = fi_noresm_hirham.variables['tasmax'][:,:,:]
fi_noresm_hirham.close()

fi_noresm_racmo = nc.Dataset('fi/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_fi_noresm_racmo = fi_noresm_racmo.variables['tasmax'][:,:,:]
fi_noresm_racmo.close()

fi_noresm_rca = nc.Dataset('fi/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fi_noresm_rca = fi_noresm_rca.variables['tasmax'][:,:,:]
fi_noresm_rca.close()

variab = ['tasmax']
variab = variab * 130
sites= ['fi']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_fi_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_fi = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_fi[i,0] = np.mean(tasmax_fi_cerfacs_hirham[i,:,:])
    annual_tasmax_fi[i,1] = np.mean(tasmax_fi_cerfacs_rca[i,:,:])
    annual_tasmax_fi[i,2] = np.mean(tasmax_fi_ichec_hirham[i,:,:])
    annual_tasmax_fi[i,3] = np.mean(tasmax_fi_ichec_racmo[i,:,:])
    annual_tasmax_fi[i,4] = np.mean(tasmax_fi_ichec_rca[i,:,:])
    annual_tasmax_fi[i,5] = np.mean(tasmax_fi_mpi_hirham[i,:,:])
    annual_tasmax_fi[i,6] = np.mean(tasmax_fi_mpi_rca[i,:,:])
    annual_tasmax_fi[i,7] = np.mean(tasmax_fi_noresm_hirham[i,:,:])
    annual_tasmax_fi[i,8] = np.mean(tasmax_fi_noresm_racmo[i,:,:])
    annual_tasmax_fi[i,9] = np.mean(tasmax_fi_noresm_rca[i,:,:])
annual_tasmax_fi= annual_tasmax_fi-273.15
annual_tasmax_fi = np.around(annual_tasmax_fi,decimals=2)

yrs = no_yrs+1971
annual_tasmax_fi[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Finland')

df_annual_tasmax_fi = pd.DataFrame(annual_tasmax_fi, columns = label_models)
df_annual_tasmax_fi['var']=variab
df_annual_tasmax_fi['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_fi],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_fi.png',dpi=300)

"""FRANCE"""
fr_cerfacs_hirham = nc.Dataset('fr/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_fr_cerfacs_hirham = fr_cerfacs_hirham.variables['tasmax'][:,:,:]
fr_cerfacs_hirham.close()

fr_cerfacs_rca = nc.Dataset('fr/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fr_cerfacs_rca = fr_cerfacs_rca.variables['tasmax'][:,:,:]
fr_cerfacs_rca.close()

fr_ichec_hirham = nc.Dataset('fr/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_fr_ichec_hirham = fr_ichec_hirham.variables['tasmax'][:,:,:]
fr_ichec_hirham.close()

fr_ichec_racmo = nc.Dataset('fr/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_fr_ichec_racmo = fr_ichec_racmo.variables['tasmax'][:,:,:]
fr_ichec_racmo.close()

fr_ichec_rca = nc.Dataset('fr/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fr_ichec_rca = fr_ichec_rca.variables['tasmax'][:,:,:]
fr_ichec_rca.close()

fr_mpi_hirham = nc.Dataset('fr/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_fr_mpi_hirham = fr_mpi_hirham.variables['tasmax'][:,:,:]
fr_mpi_hirham.close()

fr_mpi_rca = nc.Dataset('fr/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fr_mpi_rca = fr_mpi_rca.variables['tasmax'][:,:,:]
fr_mpi_rca.close()

fr_noresm_hirham = nc.Dataset('fr/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_fr_noresm_hirham = fr_noresm_hirham.variables['tasmax'][:,:,:]
fr_noresm_hirham.close()

fr_noresm_racmo = nc.Dataset('fr/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_fr_noresm_racmo = fr_noresm_racmo.variables['tasmax'][:,:,:]
fr_noresm_racmo.close()

fr_noresm_rca = nc.Dataset('fr/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_fr_noresm_rca = fr_noresm_rca.variables['tasmax'][:,:,:]
fr_noresm_rca.close()


variab = ['tasmax']
variab = variab * 130
sites= ['fr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_fr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_fr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_fr[i,0] = np.mean(tasmax_fr_cerfacs_hirham[i,:,:])
    annual_tasmax_fr[i,1] = np.mean(tasmax_fr_cerfacs_rca[i,:,:])
    annual_tasmax_fr[i,2] = np.mean(tasmax_fr_ichec_hirham[i,:,:])
    annual_tasmax_fr[i,3] = np.mean(tasmax_fr_ichec_racmo[i,:,:])
    annual_tasmax_fr[i,4] = np.mean(tasmax_fr_ichec_rca[i,:,:])
    annual_tasmax_fr[i,5] = np.mean(tasmax_fr_mpi_hirham[i,:,:])
    annual_tasmax_fr[i,6] = np.mean(tasmax_fr_mpi_rca[i,:,:])
    annual_tasmax_fr[i,7] = np.mean(tasmax_fr_noresm_hirham[i,:,:])
    annual_tasmax_fr[i,8] = np.mean(tasmax_fr_noresm_racmo[i,:,:])
    annual_tasmax_fr[i,9] = np.mean(tasmax_fr_noresm_rca[i,:,:])
annual_tasmax_fr= annual_tasmax_fr-273.15
annual_tasmax_fr = np.around(annual_tasmax_fr,decimals=2)

yrs = no_yrs+1971
annual_tasmax_fr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('France')

df_annual_tasmax_fr = pd.DataFrame(annual_tasmax_fr, columns = label_models)
df_annual_tasmax_fr['var']=variab
df_annual_tasmax_fr['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_fr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_fr.png',dpi=300)

"""GREECE"""
gr_cerfacs_hirham = nc.Dataset('gr/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_gr_cerfacs_hirham = gr_cerfacs_hirham.variables['tasmax'][:,:,:]
gr_cerfacs_hirham.close()

gr_cerfacs_rca = nc.Dataset('gr/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_gr_cerfacs_rca = gr_cerfacs_rca.variables['tasmax'][:,:,:]
gr_cerfacs_rca.close()

gr_ichec_hirham = nc.Dataset('gr/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_gr_ichec_hirham = gr_ichec_hirham.variables['tasmax'][:,:,:]
gr_ichec_hirham.close()

gr_ichec_racmo = nc.Dataset('gr/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_gr_ichec_racmo = gr_ichec_racmo.variables['tasmax'][:,:,:]
gr_ichec_racmo.close()

gr_ichec_rca = nc.Dataset('gr/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_gr_ichec_rca = gr_ichec_rca.variables['tasmax'][:,:,:]
gr_ichec_rca.close()

gr_mpi_hirham = nc.Dataset('gr/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_gr_mpi_hirham = gr_mpi_hirham.variables['tasmax'][:,:,:]
gr_mpi_hirham.close()

gr_mpi_rca = nc.Dataset('gr/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_gr_mpi_rca = gr_mpi_rca.variables['tasmax'][:,:,:]
gr_mpi_rca.close()

gr_noresm_hirham = nc.Dataset('gr/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_gr_noresm_hirham = gr_noresm_hirham.variables['tasmax'][:,:,:]
gr_noresm_hirham.close()

gr_noresm_racmo = nc.Dataset('gr/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_gr_noresm_racmo = gr_noresm_racmo.variables['tasmax'][:,:,:]
gr_noresm_racmo.close()

gr_noresm_rca = nc.Dataset('gr/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_gr_noresm_rca = gr_noresm_rca.variables['tasmax'][:,:,:]
gr_noresm_rca.close()


variab = ['tasmax']
variab = variab * 130
sites= ['gr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_gr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_gr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_gr[i,0] = np.mean(tasmax_gr_cerfacs_hirham[i,:,:])
    annual_tasmax_gr[i,1] = np.mean(tasmax_gr_cerfacs_rca[i,:,:])
    annual_tasmax_gr[i,2] = np.mean(tasmax_gr_ichec_hirham[i,:,:])
    annual_tasmax_gr[i,3] = np.mean(tasmax_gr_ichec_racmo[i,:,:])
    annual_tasmax_gr[i,4] = np.mean(tasmax_gr_ichec_rca[i,:,:])
    annual_tasmax_gr[i,5] = np.mean(tasmax_gr_mpi_hirham[i,:,:])
    annual_tasmax_gr[i,6] = np.mean(tasmax_gr_mpi_rca[i,:,:])
    annual_tasmax_gr[i,7] = np.mean(tasmax_gr_noresm_hirham[i,:,:])
    annual_tasmax_gr[i,8] = np.mean(tasmax_gr_noresm_racmo[i,:,:])
    annual_tasmax_gr[i,9] = np.mean(tasmax_gr_noresm_rca[i,:,:])
annual_tasmax_gr= annual_tasmax_gr-273.15
annual_tasmax_gr = np.around(annual_tasmax_gr,decimals=2)

yrs = no_yrs+1971
annual_tasmax_gr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Greece')

df_annual_tasmax_gr = pd.DataFrame(annual_tasmax_gr, columns = label_models)
df_annual_tasmax_gr['var']=variab
df_annual_tasmax_gr['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_gr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_gr.png',dpi=300)

"""ITALY"""
it_cerfacs_hirham = nc.Dataset('it/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_it_cerfacs_hirham = it_cerfacs_hirham.variables['tasmax'][:,:,:]
it_cerfacs_hirham.close()

it_cerfacs_rca = nc.Dataset('it/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_it_cerfacs_rca = it_cerfacs_rca.variables['tasmax'][:,:,:]
it_cerfacs_rca.close()

it_ichec_hirham = nc.Dataset('it/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_it_ichec_hirham = it_ichec_hirham.variables['tasmax'][:,:,:]
it_ichec_hirham.close()

it_ichec_racmo = nc.Dataset('it/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_it_ichec_racmo = it_ichec_racmo.variables['tasmax'][:,:,:]
it_ichec_racmo.close()

it_ichec_rca = nc.Dataset('it/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_it_ichec_rca = it_ichec_rca.variables['tasmax'][:,:,:]
it_ichec_rca.close()

it_mpi_hirham = nc.Dataset('it/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_it_mpi_hirham = it_mpi_hirham.variables['tasmax'][:,:,:]
it_mpi_hirham.close()

it_mpi_rca = nc.Dataset('it/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_it_mpi_rca = it_mpi_rca.variables['tasmax'][:,:,:]
it_mpi_rca.close()

it_noresm_hirham = nc.Dataset('it/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_it_noresm_hirham = it_noresm_hirham.variables['tasmax'][:,:,:]
it_noresm_hirham.close()

it_noresm_racmo = nc.Dataset('it/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_it_noresm_racmo = it_noresm_racmo.variables['tasmax'][:,:,:]
it_noresm_racmo.close()

it_noresm_rca = nc.Dataset('it/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_it_noresm_rca = it_noresm_rca.variables['tasmax'][:,:,:]
it_noresm_rca.close()


variab = ['tasmax']
variab = variab * 130
sites= ['it']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_it_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_it = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_it[i,0] = np.mean(tasmax_it_cerfacs_hirham[i,:,:])
    annual_tasmax_it[i,1] = np.mean(tasmax_it_cerfacs_rca[i,:,:])
    annual_tasmax_it[i,2] = np.mean(tasmax_it_ichec_hirham[i,:,:])
    annual_tasmax_it[i,3] = np.mean(tasmax_it_ichec_racmo[i,:,:])
    annual_tasmax_it[i,4] = np.mean(tasmax_it_ichec_rca[i,:,:])
    annual_tasmax_it[i,5] = np.mean(tasmax_it_mpi_hirham[i,:,:])
    annual_tasmax_it[i,6] = np.mean(tasmax_it_mpi_rca[i,:,:])
    annual_tasmax_it[i,7] = np.mean(tasmax_it_noresm_hirham[i,:,:])
    annual_tasmax_it[i,8] = np.mean(tasmax_it_noresm_racmo[i,:,:])
    annual_tasmax_it[i,9] = np.mean(tasmax_it_noresm_rca[i,:,:])
annual_tasmax_it= annual_tasmax_it-273.15
annual_tasmax_it = np.around(annual_tasmax_it,decimals=2)

yrs = no_yrs+1971
annual_tasmax_it[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Italy')

df_annual_tasmax_it = pd.DataFrame(annual_tasmax_it, columns = label_models)
df_annual_tasmax_it['var']=variab
df_annual_tasmax_it['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_it],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_it.png',dpi=300)

"""ROMANIA"""
ro_cerfacs_hirham = nc.Dataset('ro/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_ro_cerfacs_hirham = ro_cerfacs_hirham.variables['tasmax'][:,:,:]
ro_cerfacs_hirham.close()

ro_cerfacs_rca = nc.Dataset('ro/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_ro_cerfacs_rca = ro_cerfacs_rca.variables['tasmax'][:,:,:]
ro_cerfacs_rca.close()

ro_ichec_hirham = nc.Dataset('ro/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_ro_ichec_hirham = ro_ichec_hirham.variables['tasmax'][:,:,:]
ro_ichec_hirham.close()

ro_ichec_racmo = nc.Dataset('ro/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_ro_ichec_racmo = ro_ichec_racmo.variables['tasmax'][:,:,:]
ro_ichec_racmo.close()

ro_ichec_rca = nc.Dataset('ro/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_ro_ichec_rca = ro_ichec_rca.variables['tasmax'][:,:,:]
ro_ichec_rca.close()

ro_mpi_hirham = nc.Dataset('ro/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_ro_mpi_hirham = ro_mpi_hirham.variables['tasmax'][:,:,:]
ro_mpi_hirham.close()

ro_mpi_rca = nc.Dataset('ro/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_ro_mpi_rca = ro_mpi_rca.variables['tasmax'][:,:,:]
ro_mpi_rca.close()

ro_noresm_hirham = nc.Dataset('ro/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_ro_noresm_hirham = ro_noresm_hirham.variables['tasmax'][:,:,:]
ro_noresm_hirham.close()

ro_noresm_racmo = nc.Dataset('ro/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_ro_noresm_racmo = ro_noresm_racmo.variables['tasmax'][:,:,:]
ro_noresm_racmo.close()

ro_noresm_rca = nc.Dataset('ro/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_ro_noresm_rca = ro_noresm_rca.variables['tasmax'][:,:,:]
ro_noresm_rca.close()


variab = ['tasmax']
variab = variab * 130
sites= ['ro']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_ro_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_ro = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_ro[i,0] = np.mean(tasmax_ro_cerfacs_hirham[i,:,:])
    annual_tasmax_ro[i,1] = np.mean(tasmax_ro_cerfacs_rca[i,:,:])
    annual_tasmax_ro[i,2] = np.mean(tasmax_ro_ichec_hirham[i,:,:])
    annual_tasmax_ro[i,3] = np.mean(tasmax_ro_ichec_racmo[i,:,:])
    annual_tasmax_ro[i,4] = np.mean(tasmax_ro_ichec_rca[i,:,:])
    annual_tasmax_ro[i,5] = np.mean(tasmax_ro_mpi_hirham[i,:,:])
    annual_tasmax_ro[i,6] = np.mean(tasmax_ro_mpi_rca[i,:,:])
    annual_tasmax_ro[i,7] = np.mean(tasmax_ro_noresm_hirham[i,:,:])
    annual_tasmax_ro[i,8] = np.mean(tasmax_ro_noresm_racmo[i,:,:])
    annual_tasmax_ro[i,9] = np.mean(tasmax_ro_noresm_rca[i,:,:])
annual_tasmax_ro= annual_tasmax_ro-273.15
annual_tasmax_ro = np.around(annual_tasmax_ro,decimals=2)

yrs = no_yrs+1971
annual_tasmax_ro[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Romania')

df_annual_tasmax_ro = pd.DataFrame(annual_tasmax_ro, columns = label_models)
df_annual_tasmax_ro['var']=variab
df_annual_tasmax_ro['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_ro],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_ro.png',dpi=300)

"""SPAIN"""
sp_cerfacs_hirham = nc.Dataset('sp/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_sp_cerfacs_hirham = sp_cerfacs_hirham.variables['tasmax'][:,:,:]
sp_cerfacs_hirham.close()

sp_cerfacs_rca = nc.Dataset('sp/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_sp_cerfacs_rca = sp_cerfacs_rca.variables['tasmax'][:,:,:]
sp_cerfacs_rca.close()

sp_ichec_hirham = nc.Dataset('sp/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_sp_ichec_hirham = sp_ichec_hirham.variables['tasmax'][:,:,:]
sp_ichec_hirham.close()

sp_ichec_racmo = nc.Dataset('sp/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_sp_ichec_racmo = sp_ichec_racmo.variables['tasmax'][:,:,:]
sp_ichec_racmo.close()

sp_ichec_rca = nc.Dataset('sp/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_sp_ichec_rca = sp_ichec_rca.variables['tasmax'][:,:,:]
sp_ichec_rca.close()

sp_mpi_hirham = nc.Dataset('sp/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_sp_mpi_hirham = sp_mpi_hirham.variables['tasmax'][:,:,:]
sp_mpi_hirham.close()

sp_mpi_rca = nc.Dataset('sp/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_sp_mpi_rca = sp_mpi_rca.variables['tasmax'][:,:,:]
sp_mpi_rca.close()

sp_noresm_hirham = nc.Dataset('sp/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_sp_noresm_hirham = sp_noresm_hirham.variables['tasmax'][:,:,:]
sp_noresm_hirham.close()

sp_noresm_racmo = nc.Dataset('sp/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_sp_noresm_racmo = sp_noresm_racmo.variables['tasmax'][:,:,:]
sp_noresm_racmo.close()

sp_noresm_rca = nc.Dataset('sp/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_sp_noresm_rca = sp_noresm_rca.variables['tasmax'][:,:,:]
sp_noresm_rca.close()


variab = ['tasmax']
variab = variab * 130
sites= ['sp']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_sp_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_sp = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_sp[i,0] = np.mean(tasmax_sp_cerfacs_hirham[i,:,:])
    annual_tasmax_sp[i,1] = np.mean(tasmax_sp_cerfacs_rca[i,:,:])
    annual_tasmax_sp[i,2] = np.mean(tasmax_sp_ichec_hirham[i,:,:])
    annual_tasmax_sp[i,3] = np.mean(tasmax_sp_ichec_racmo[i,:,:])
    annual_tasmax_sp[i,4] = np.mean(tasmax_sp_ichec_rca[i,:,:])
    annual_tasmax_sp[i,5] = np.mean(tasmax_sp_mpi_hirham[i,:,:])
    annual_tasmax_sp[i,6] = np.mean(tasmax_sp_mpi_rca[i,:,:])
    annual_tasmax_sp[i,7] = np.mean(tasmax_sp_noresm_hirham[i,:,:])
    annual_tasmax_sp[i,8] = np.mean(tasmax_sp_noresm_racmo[i,:,:])
    annual_tasmax_sp[i,9] = np.mean(tasmax_sp_noresm_rca[i,:,:])
annual_tasmax_sp= annual_tasmax_sp-273.15
annual_tasmax_sp = np.around(annual_tasmax_sp,decimals=2)

yrs = no_yrs+1971
annual_tasmax_sp[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('Spain')

df_annual_tasmax_sp = pd.DataFrame(annual_tasmax_sp, columns = label_models)
df_annual_tasmax_sp['var']=variab
df_annual_tasmax_sp['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_sp],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_sp.png',dpi=300)

"""UK"""
uk_cerfacs_hirham = nc.Dataset('uk/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
tasmax_uk_cerfacs_hirham = uk_cerfacs_hirham.variables['tasmax'][:,:,:]
uk_cerfacs_hirham.close()

uk_cerfacs_rca = nc.Dataset('uk/annual/tasmax_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_uk_cerfacs_rca = uk_cerfacs_rca.variables['tasmax'][:,:,:]
uk_cerfacs_rca.close()

uk_ichec_hirham = nc.Dataset('uk/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_uk_ichec_hirham = uk_ichec_hirham.variables['tasmax'][:,:,:]
uk_ichec_hirham.close()

uk_ichec_racmo = nc.Dataset('uk/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_uk_ichec_racmo = uk_ichec_racmo.variables['tasmax'][:,:,:]
uk_ichec_racmo.close()

uk_ichec_rca = nc.Dataset('uk/annual/tasmax_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_uk_ichec_rca = uk_ichec_rca.variables['tasmax'][:,:,:]
uk_ichec_rca.close()

uk_mpi_hirham = nc.Dataset('uk/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
tasmax_uk_mpi_hirham = uk_mpi_hirham.variables['tasmax'][:,:,:]
uk_mpi_hirham.close()

uk_mpi_rca = nc.Dataset('uk/annual/tasmax_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_uk_mpi_rca = uk_mpi_rca.variables['tasmax'][:,:,:]
uk_mpi_rca.close()

uk_noresm_hirham = nc.Dataset('uk/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
tasmax_uk_noresm_hirham = uk_noresm_hirham.variables['tasmax'][:,:,:]
uk_noresm_hirham.close()

uk_noresm_racmo = nc.Dataset('uk/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
tasmax_uk_noresm_racmo = uk_noresm_racmo.variables['tasmax'][:,:,:]
uk_noresm_racmo.close()

uk_noresm_rca = nc.Dataset('uk/annual/tasmax_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
tasmax_uk_noresm_rca = uk_noresm_rca.variables['tasmax'][:,:,:]
uk_noresm_rca.close()

variab = ['tasmax']
variab = variab * 130
sites= ['uk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(tasmax_uk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_tasmax_uk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_tasmax_uk[i,0] = np.mean(tasmax_uk_cerfacs_hirham[i,:,:])
    annual_tasmax_uk[i,1] = np.mean(tasmax_uk_cerfacs_rca[i,:,:])
    annual_tasmax_uk[i,2] = np.mean(tasmax_uk_ichec_hirham[i,:,:])
    annual_tasmax_uk[i,3] = np.mean(tasmax_uk_ichec_racmo[i,:,:])
    annual_tasmax_uk[i,4] = np.mean(tasmax_uk_ichec_rca[i,:,:])
    annual_tasmax_uk[i,5] = np.mean(tasmax_uk_mpi_hirham[i,:,:])
    annual_tasmax_uk[i,6] = np.mean(tasmax_uk_mpi_rca[i,:,:])
    annual_tasmax_uk[i,7] = np.mean(tasmax_uk_noresm_hirham[i,:,:])
    annual_tasmax_uk[i,8] = np.mean(tasmax_uk_noresm_racmo[i,:,:])
    annual_tasmax_uk[i,9] = np.mean(tasmax_uk_noresm_rca[i,:,:])
annual_tasmax_uk= annual_tasmax_uk-273.15
annual_tasmax_uk = np.around(annual_tasmax_uk,decimals=2)

yrs = no_yrs+1971
annual_tasmax_uk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_tasmax_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_tasmax_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Annual mean maximum air temperature (Celsius)')
plt.title('UK')

df_annual_tasmax_uk = pd.DataFrame(annual_tasmax_uk, columns = label_models)
df_annual_tasmax_uk['var']=variab
df_annual_tasmax_uk['site']=sites

df_all = pd.concat([df_all,df_annual_tasmax_uk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_tasmax_uk.png',dpi=300)


#################
#################
#################
###sfcWind
#################
#################
#################
"""AUSTRIA"""
at_cerfacs_hirham = nc.Dataset('at/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_at_cerfacs_hirham = at_cerfacs_hirham.variables['sfcWind'][:,:,:]
at_cerfacs_hirham.close()

at_cerfacs_rca = nc.Dataset('at/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_at_cerfacs_rca = at_cerfacs_rca.variables['sfcWind'][:,:,:]
at_cerfacs_rca.close()

at_ichec_hirham = nc.Dataset('at/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_at_ichec_hirham = at_ichec_hirham.variables['sfcWind'][:,:,:]
at_ichec_hirham.close()

at_ichec_racmo = nc.Dataset('at/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_at_ichec_racmo = at_ichec_racmo.variables['sfcWind'][:,:,:]
at_ichec_racmo.close()

at_ichec_rca = nc.Dataset('at/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_at_ichec_rca = at_ichec_rca.variables['sfcWind'][:,:,:]
at_ichec_rca.close()

at_mpi_hirham = nc.Dataset('at/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_at_mpi_hirham = at_mpi_hirham.variables['sfcWind'][:,:,:]
at_mpi_hirham.close()

at_mpi_rca = nc.Dataset('at/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_at_mpi_rca = at_mpi_rca.variables['sfcWind'][:,:,:]
at_mpi_rca.close()

at_noresm_hirham = nc.Dataset('at/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_at_noresm_hirham = at_noresm_hirham.variables['sfcWind'][:,:,:]
at_noresm_hirham.close()

at_noresm_racmo = nc.Dataset('at/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_at_noresm_racmo = at_noresm_racmo.variables['sfcWind'][:,:,:]
at_noresm_racmo.close()

at_noresm_rca = nc.Dataset('at/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_at_noresm_rca = at_noresm_rca.variables['sfcWind'][:,:,:]
at_noresm_rca.close()

len_yrs= len(sfcWind_at_cerfacs_rca)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_at = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_at[i,0] = np.mean(sfcWind_at_cerfacs_hirham[i,:,:])
    annual_sfcWind_at[i,1] = np.mean(sfcWind_at_cerfacs_rca[i,:,:])
    annual_sfcWind_at[i,2] = np.mean(sfcWind_at_ichec_hirham[i,:,:])
    annual_sfcWind_at[i,3] = np.mean(sfcWind_at_ichec_racmo[i,:,:])
    annual_sfcWind_at[i,4] = np.mean(sfcWind_at_ichec_rca[i,:,:])
    annual_sfcWind_at[i,5] = np.mean(sfcWind_at_mpi_hirham[i,:,:])
    annual_sfcWind_at[i,6] = np.mean(sfcWind_at_mpi_rca[i,:,:])
    annual_sfcWind_at[i,7] = np.mean(sfcWind_at_noresm_hirham[i,:,:])
    annual_sfcWind_at[i,8] = np.mean(sfcWind_at_noresm_racmo[i,:,:])
    annual_sfcWind_at[i,9] = np.mean(sfcWind_at_noresm_rca[i,:,:])
annual_sfcWind_at= annual_sfcWind_at
annual_sfcWind_at = np.around(annual_sfcWind_at,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_at[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)

variab = ['sfcWind']
variab = variab * 130
sites= ['at']
sites = sites* 130



label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']
models_ap = []
for ii in np.arange(0,len(label_models)):
    models = [label_models[ii]]
    
    models = np.repeat(models,1300)
    models_ap.append(models)


plt.plot(yrs,annual_sfcWind_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Austria')


df_annual_sfcWind_at = pd.DataFrame(annual_sfcWind_at, columns = label_models)
df_annual_sfcWind_at['var']=variab
df_annual_sfcWind_at['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_at],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)
plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_at.png',dpi=300)

"""DENMARK"""
dk_cerfacs_hirham = nc.Dataset('dk/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_dk_cerfacs_hirham = dk_cerfacs_hirham.variables['sfcWind'][:,:,:]
dk_cerfacs_hirham.close()

dk_cerfacs_rca = nc.Dataset('dk/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dk_cerfacs_rca = dk_cerfacs_rca.variables['sfcWind'][:,:,:]
dk_cerfacs_rca.close()

dk_ichec_hirham = nc.Dataset('dk/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_dk_ichec_hirham = dk_ichec_hirham.variables['sfcWind'][:,:,:]
dk_ichec_hirham.close()

dk_ichec_racmo = nc.Dataset('dk/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_dk_ichec_racmo = dk_ichec_racmo.variables['sfcWind'][:,:,:]
dk_ichec_racmo.close()

dk_ichec_rca = nc.Dataset('dk/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dk_ichec_rca = dk_ichec_rca.variables['sfcWind'][:,:,:]
dk_ichec_rca.close()

dk_mpi_hirham = nc.Dataset('dk/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_dk_mpi_hirham = dk_mpi_hirham.variables['sfcWind'][:,:,:]
dk_mpi_hirham.close()

dk_mpi_rca = nc.Dataset('dk/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dk_mpi_rca = dk_mpi_rca.variables['sfcWind'][:,:,:]
dk_mpi_rca.close()

dk_noresm_hirham = nc.Dataset('dk/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_dk_noresm_hirham = dk_noresm_hirham.variables['sfcWind'][:,:,:]
dk_noresm_hirham.close()

dk_noresm_racmo = nc.Dataset('dk/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_dk_noresm_racmo = dk_noresm_racmo.variables['sfcWind'][:,:,:]
dk_noresm_racmo.close()

dk_noresm_rca = nc.Dataset('dk/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dk_noresm_rca = dk_noresm_rca.variables['sfcWind'][:,:,:]
dk_noresm_rca.close()

variab = ['sfcWind']
variab = variab * 130
sites= ['dk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_dk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_dk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_dk[i,0] = np.mean(sfcWind_dk_cerfacs_hirham[i,:,:])
    annual_sfcWind_dk[i,1] = np.mean(sfcWind_dk_cerfacs_rca[i,:,:])
    annual_sfcWind_dk[i,2] = np.mean(sfcWind_dk_ichec_hirham[i,:,:])
    annual_sfcWind_dk[i,3] = np.mean(sfcWind_dk_ichec_racmo[i,:,:])
    annual_sfcWind_dk[i,4] = np.mean(sfcWind_dk_ichec_rca[i,:,:])
    annual_sfcWind_dk[i,5] = np.mean(sfcWind_dk_mpi_hirham[i,:,:])
    annual_sfcWind_dk[i,6] = np.mean(sfcWind_dk_mpi_rca[i,:,:])
    annual_sfcWind_dk[i,7] = np.mean(sfcWind_dk_noresm_hirham[i,:,:])
    annual_sfcWind_dk[i,8] = np.mean(sfcWind_dk_noresm_racmo[i,:,:])
    annual_sfcWind_dk[i,9] = np.mean(sfcWind_dk_noresm_rca[i,:,:])
annual_sfcWind_dk= annual_sfcWind_dk
annual_sfcWind_dk = np.around(annual_sfcWind_dk,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_dk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Denmark')

df_annual_sfcWind_dk = pd.DataFrame(annual_sfcWind_dk, columns = label_models)
df_annual_sfcWind_dk['var']=variab
df_annual_sfcWind_dk['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_dk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_dk.png',dpi=300)

"""GERMANY"""
dl_cerfacs_hirham = nc.Dataset('dl/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_dl_cerfacs_hirham = dl_cerfacs_hirham.variables['sfcWind'][:,:,:]
dl_cerfacs_hirham.close()

dl_cerfacs_rca = nc.Dataset('dl/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dl_cerfacs_rca = dl_cerfacs_rca.variables['sfcWind'][:,:,:]
dl_cerfacs_rca.close()

dl_ichec_hirham = nc.Dataset('dl/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_dl_ichec_hirham = dl_ichec_hirham.variables['sfcWind'][:,:,:]
dl_ichec_hirham.close()

dl_ichec_racmo = nc.Dataset('dl/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_dl_ichec_racmo = dl_ichec_racmo.variables['sfcWind'][:,:,:]
dl_ichec_racmo.close()

dl_ichec_rca = nc.Dataset('dl/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dl_ichec_rca = dl_ichec_rca.variables['sfcWind'][:,:,:]
dl_ichec_rca.close()

dl_mpi_hirham = nc.Dataset('dl/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_dl_mpi_hirham = dl_mpi_hirham.variables['sfcWind'][:,:,:]
dl_mpi_hirham.close()

dl_mpi_rca = nc.Dataset('dl/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dl_mpi_rca = dl_mpi_rca.variables['sfcWind'][:,:,:]
dl_mpi_rca.close()

dl_noresm_hirham = nc.Dataset('dl/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_dl_noresm_hirham = dl_noresm_hirham.variables['sfcWind'][:,:,:]
dl_noresm_hirham.close()

dl_noresm_racmo = nc.Dataset('dl/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_dl_noresm_racmo = dl_noresm_racmo.variables['sfcWind'][:,:,:]
dl_noresm_racmo.close()

dl_noresm_rca = nc.Dataset('dl/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_dl_noresm_rca = dl_noresm_rca.variables['sfcWind'][:,:,:]
dl_noresm_rca.close()

variab = ['sfcWind']
variab = variab * 130
sites= ['dl']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_dl_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_dl = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_dl[i,0] = np.mean(sfcWind_dl_cerfacs_hirham[i,:,:])
    annual_sfcWind_dl[i,1] = np.mean(sfcWind_dl_cerfacs_rca[i,:,:])
    annual_sfcWind_dl[i,2] = np.mean(sfcWind_dl_ichec_hirham[i,:,:])
    annual_sfcWind_dl[i,3] = np.mean(sfcWind_dl_ichec_racmo[i,:,:])
    annual_sfcWind_dl[i,4] = np.mean(sfcWind_dl_ichec_rca[i,:,:])
    annual_sfcWind_dl[i,5] = np.mean(sfcWind_dl_mpi_hirham[i,:,:])
    annual_sfcWind_dl[i,6] = np.mean(sfcWind_dl_mpi_rca[i,:,:])
    annual_sfcWind_dl[i,7] = np.mean(sfcWind_dl_noresm_hirham[i,:,:])
    annual_sfcWind_dl[i,8] = np.mean(sfcWind_dl_noresm_racmo[i,:,:])
    annual_sfcWind_dl[i,9] = np.mean(sfcWind_dl_noresm_rca[i,:,:])
annual_sfcWind_dl= annual_sfcWind_dl
annual_sfcWind_dl = np.around(annual_sfcWind_dl,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_dl[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Germany')

df_annual_sfcWind_dl = pd.DataFrame(annual_sfcWind_dl, columns = label_models)
df_annual_sfcWind_dl['var']=variab
df_annual_sfcWind_dl['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_dl],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_dl.png',dpi=300)


"""FINLAND"""
fi_cerfacs_hirham = nc.Dataset('fi/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_fi_cerfacs_hirham = fi_cerfacs_hirham.variables['sfcWind'][:,:,:]
fi_cerfacs_hirham.close()

fi_cerfacs_rca = nc.Dataset('fi/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fi_cerfacs_rca = fi_cerfacs_rca.variables['sfcWind'][:,:,:]
fi_cerfacs_rca.close()

fi_ichec_hirham = nc.Dataset('fi/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_fi_ichec_hirham = fi_ichec_hirham.variables['sfcWind'][:,:,:]
fi_ichec_hirham.close()

fi_ichec_racmo = nc.Dataset('fi/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_fi_ichec_racmo = fi_ichec_racmo.variables['sfcWind'][:,:,:]
fi_ichec_racmo.close()

fi_ichec_rca = nc.Dataset('fi/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fi_ichec_rca = fi_ichec_rca.variables['sfcWind'][:,:,:]
fi_ichec_rca.close()

fi_mpi_hirham = nc.Dataset('fi/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_fi_mpi_hirham = fi_mpi_hirham.variables['sfcWind'][:,:,:]
fi_mpi_hirham.close()

fi_mpi_rca = nc.Dataset('fi/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fi_mpi_rca = fi_mpi_rca.variables['sfcWind'][:,:,:]
fi_mpi_rca.close()

fi_noresm_hirham = nc.Dataset('fi/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_fi_noresm_hirham = fi_noresm_hirham.variables['sfcWind'][:,:,:]
fi_noresm_hirham.close()

fi_noresm_racmo = nc.Dataset('fi/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_fi_noresm_racmo = fi_noresm_racmo.variables['sfcWind'][:,:,:]
fi_noresm_racmo.close()

fi_noresm_rca = nc.Dataset('fi/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fi_noresm_rca = fi_noresm_rca.variables['sfcWind'][:,:,:]
fi_noresm_rca.close()

variab = ['sfcWind']
variab = variab * 130
sites= ['fi']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_fi_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_fi = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_fi[i,0] = np.mean(sfcWind_fi_cerfacs_hirham[i,:,:])
    annual_sfcWind_fi[i,1] = np.mean(sfcWind_fi_cerfacs_rca[i,:,:])
    annual_sfcWind_fi[i,2] = np.mean(sfcWind_fi_ichec_hirham[i,:,:])
    annual_sfcWind_fi[i,3] = np.mean(sfcWind_fi_ichec_racmo[i,:,:])
    annual_sfcWind_fi[i,4] = np.mean(sfcWind_fi_ichec_rca[i,:,:])
    annual_sfcWind_fi[i,5] = np.mean(sfcWind_fi_mpi_hirham[i,:,:])
    annual_sfcWind_fi[i,6] = np.mean(sfcWind_fi_mpi_rca[i,:,:])
    annual_sfcWind_fi[i,7] = np.mean(sfcWind_fi_noresm_hirham[i,:,:])
    annual_sfcWind_fi[i,8] = np.mean(sfcWind_fi_noresm_racmo[i,:,:])
    annual_sfcWind_fi[i,9] = np.mean(sfcWind_fi_noresm_rca[i,:,:])
annual_sfcWind_fi= annual_sfcWind_fi
annual_sfcWind_fi = np.around(annual_sfcWind_fi,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_fi[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Finland')

df_annual_sfcWind_fi = pd.DataFrame(annual_sfcWind_fi, columns = label_models)
df_annual_sfcWind_fi['var']=variab
df_annual_sfcWind_fi['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_fi],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_fi.png',dpi=300)

"""FRANCE"""
fr_cerfacs_hirham = nc.Dataset('fr/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_fr_cerfacs_hirham = fr_cerfacs_hirham.variables['sfcWind'][:,:,:]
fr_cerfacs_hirham.close()

fr_cerfacs_rca = nc.Dataset('fr/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fr_cerfacs_rca = fr_cerfacs_rca.variables['sfcWind'][:,:,:]
fr_cerfacs_rca.close()

fr_ichec_hirham = nc.Dataset('fr/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_fr_ichec_hirham = fr_ichec_hirham.variables['sfcWind'][:,:,:]
fr_ichec_hirham.close()

fr_ichec_racmo = nc.Dataset('fr/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_fr_ichec_racmo = fr_ichec_racmo.variables['sfcWind'][:,:,:]
fr_ichec_racmo.close()

fr_ichec_rca = nc.Dataset('fr/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fr_ichec_rca = fr_ichec_rca.variables['sfcWind'][:,:,:]
fr_ichec_rca.close()

fr_mpi_hirham = nc.Dataset('fr/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_fr_mpi_hirham = fr_mpi_hirham.variables['sfcWind'][:,:,:]
fr_mpi_hirham.close()

fr_mpi_rca = nc.Dataset('fr/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fr_mpi_rca = fr_mpi_rca.variables['sfcWind'][:,:,:]
fr_mpi_rca.close()

fr_noresm_hirham = nc.Dataset('fr/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_fr_noresm_hirham = fr_noresm_hirham.variables['sfcWind'][:,:,:]
fr_noresm_hirham.close()

fr_noresm_racmo = nc.Dataset('fr/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_fr_noresm_racmo = fr_noresm_racmo.variables['sfcWind'][:,:,:]
fr_noresm_racmo.close()

fr_noresm_rca = nc.Dataset('fr/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_fr_noresm_rca = fr_noresm_rca.variables['sfcWind'][:,:,:]
fr_noresm_rca.close()


variab = ['sfcWind']
variab = variab * 130
sites= ['fr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_fr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_fr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_fr[i,0] = np.mean(sfcWind_fr_cerfacs_hirham[i,:,:])
    annual_sfcWind_fr[i,1] = np.mean(sfcWind_fr_cerfacs_rca[i,:,:])
    annual_sfcWind_fr[i,2] = np.mean(sfcWind_fr_ichec_hirham[i,:,:])
    annual_sfcWind_fr[i,3] = np.mean(sfcWind_fr_ichec_racmo[i,:,:])
    annual_sfcWind_fr[i,4] = np.mean(sfcWind_fr_ichec_rca[i,:,:])
    annual_sfcWind_fr[i,5] = np.mean(sfcWind_fr_mpi_hirham[i,:,:])
    annual_sfcWind_fr[i,6] = np.mean(sfcWind_fr_mpi_rca[i,:,:])
    annual_sfcWind_fr[i,7] = np.mean(sfcWind_fr_noresm_hirham[i,:,:])
    annual_sfcWind_fr[i,8] = np.mean(sfcWind_fr_noresm_racmo[i,:,:])
    annual_sfcWind_fr[i,9] = np.mean(sfcWind_fr_noresm_rca[i,:,:])
annual_sfcWind_fr= annual_sfcWind_fr
annual_sfcWind_fr = np.around(annual_sfcWind_fr,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_fr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('France')

df_annual_sfcWind_fr = pd.DataFrame(annual_sfcWind_fr, columns = label_models)
df_annual_sfcWind_fr['var']=variab
df_annual_sfcWind_fr['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_fr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_fr.png',dpi=300)

"""GREECE"""
gr_cerfacs_hirham = nc.Dataset('gr/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_gr_cerfacs_hirham = gr_cerfacs_hirham.variables['sfcWind'][:,:,:]
gr_cerfacs_hirham.close()

gr_cerfacs_rca = nc.Dataset('gr/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_gr_cerfacs_rca = gr_cerfacs_rca.variables['sfcWind'][:,:,:]
gr_cerfacs_rca.close()

gr_ichec_hirham = nc.Dataset('gr/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_gr_ichec_hirham = gr_ichec_hirham.variables['sfcWind'][:,:,:]
gr_ichec_hirham.close()

gr_ichec_racmo = nc.Dataset('gr/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_gr_ichec_racmo = gr_ichec_racmo.variables['sfcWind'][:,:,:]
gr_ichec_racmo.close()

gr_ichec_rca = nc.Dataset('gr/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_gr_ichec_rca = gr_ichec_rca.variables['sfcWind'][:,:,:]
gr_ichec_rca.close()

gr_mpi_hirham = nc.Dataset('gr/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_gr_mpi_hirham = gr_mpi_hirham.variables['sfcWind'][:,:,:]
gr_mpi_hirham.close()

gr_mpi_rca = nc.Dataset('gr/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_gr_mpi_rca = gr_mpi_rca.variables['sfcWind'][:,:,:]
gr_mpi_rca.close()

gr_noresm_hirham = nc.Dataset('gr/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_gr_noresm_hirham = gr_noresm_hirham.variables['sfcWind'][:,:,:]
gr_noresm_hirham.close()

gr_noresm_racmo = nc.Dataset('gr/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_gr_noresm_racmo = gr_noresm_racmo.variables['sfcWind'][:,:,:]
gr_noresm_racmo.close()

gr_noresm_rca = nc.Dataset('gr/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_gr_noresm_rca = gr_noresm_rca.variables['sfcWind'][:,:,:]
gr_noresm_rca.close()


variab = ['sfcWind']
variab = variab * 130
sites= ['gr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_gr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_gr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_gr[i,0] = np.mean(sfcWind_gr_cerfacs_hirham[i,:,:])
    annual_sfcWind_gr[i,1] = np.mean(sfcWind_gr_cerfacs_rca[i,:,:])
    annual_sfcWind_gr[i,2] = np.mean(sfcWind_gr_ichec_hirham[i,:,:])
    annual_sfcWind_gr[i,3] = np.mean(sfcWind_gr_ichec_racmo[i,:,:])
    annual_sfcWind_gr[i,4] = np.mean(sfcWind_gr_ichec_rca[i,:,:])
    annual_sfcWind_gr[i,5] = np.mean(sfcWind_gr_mpi_hirham[i,:,:])
    annual_sfcWind_gr[i,6] = np.mean(sfcWind_gr_mpi_rca[i,:,:])
    annual_sfcWind_gr[i,7] = np.mean(sfcWind_gr_noresm_hirham[i,:,:])
    annual_sfcWind_gr[i,8] = np.mean(sfcWind_gr_noresm_racmo[i,:,:])
    annual_sfcWind_gr[i,9] = np.mean(sfcWind_gr_noresm_rca[i,:,:])
annual_sfcWind_gr= annual_sfcWind_gr
annual_sfcWind_gr = np.around(annual_sfcWind_gr,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_gr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Greece')

df_annual_sfcWind_gr = pd.DataFrame(annual_sfcWind_gr, columns = label_models)
df_annual_sfcWind_gr['var']=variab
df_annual_sfcWind_gr['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_gr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_gr.png',dpi=300)

"""ITALY"""
it_cerfacs_hirham = nc.Dataset('it/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_it_cerfacs_hirham = it_cerfacs_hirham.variables['sfcWind'][:,:,:]
it_cerfacs_hirham.close()

it_cerfacs_rca = nc.Dataset('it/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_it_cerfacs_rca = it_cerfacs_rca.variables['sfcWind'][:,:,:]
it_cerfacs_rca.close()

it_ichec_hirham = nc.Dataset('it/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_it_ichec_hirham = it_ichec_hirham.variables['sfcWind'][:,:,:]
it_ichec_hirham.close()

it_ichec_racmo = nc.Dataset('it/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_it_ichec_racmo = it_ichec_racmo.variables['sfcWind'][:,:,:]
it_ichec_racmo.close()

it_ichec_rca = nc.Dataset('it/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_it_ichec_rca = it_ichec_rca.variables['sfcWind'][:,:,:]
it_ichec_rca.close()

it_mpi_hirham = nc.Dataset('it/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_it_mpi_hirham = it_mpi_hirham.variables['sfcWind'][:,:,:]
it_mpi_hirham.close()

it_mpi_rca = nc.Dataset('it/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_it_mpi_rca = it_mpi_rca.variables['sfcWind'][:,:,:]
it_mpi_rca.close()

it_noresm_hirham = nc.Dataset('it/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_it_noresm_hirham = it_noresm_hirham.variables['sfcWind'][:,:,:]
it_noresm_hirham.close()

it_noresm_racmo = nc.Dataset('it/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_it_noresm_racmo = it_noresm_racmo.variables['sfcWind'][:,:,:]
it_noresm_racmo.close()

it_noresm_rca = nc.Dataset('it/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_it_noresm_rca = it_noresm_rca.variables['sfcWind'][:,:,:]
it_noresm_rca.close()


variab = ['sfcWind']
variab = variab * 130
sites= ['it']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_it_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_it = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_it[i,0] = np.mean(sfcWind_it_cerfacs_hirham[i,:,:])
    annual_sfcWind_it[i,1] = np.mean(sfcWind_it_cerfacs_rca[i,:,:])
    annual_sfcWind_it[i,2] = np.mean(sfcWind_it_ichec_hirham[i,:,:])
    annual_sfcWind_it[i,3] = np.mean(sfcWind_it_ichec_racmo[i,:,:])
    annual_sfcWind_it[i,4] = np.mean(sfcWind_it_ichec_rca[i,:,:])
    annual_sfcWind_it[i,5] = np.mean(sfcWind_it_mpi_hirham[i,:,:])
    annual_sfcWind_it[i,6] = np.mean(sfcWind_it_mpi_rca[i,:,:])
    annual_sfcWind_it[i,7] = np.mean(sfcWind_it_noresm_hirham[i,:,:])
    annual_sfcWind_it[i,8] = np.mean(sfcWind_it_noresm_racmo[i,:,:])
    annual_sfcWind_it[i,9] = np.mean(sfcWind_it_noresm_rca[i,:,:])
annual_sfcWind_it= annual_sfcWind_it
annual_sfcWind_it = np.around(annual_sfcWind_it,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_it[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Italy')

df_annual_sfcWind_it = pd.DataFrame(annual_sfcWind_it, columns = label_models)
df_annual_sfcWind_it['var']=variab
df_annual_sfcWind_it['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_it],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_it.png',dpi=300)

"""ROMANIA"""
ro_cerfacs_hirham = nc.Dataset('ro/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_ro_cerfacs_hirham = ro_cerfacs_hirham.variables['sfcWind'][:,:,:]
ro_cerfacs_hirham.close()

ro_cerfacs_rca = nc.Dataset('ro/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_ro_cerfacs_rca = ro_cerfacs_rca.variables['sfcWind'][:,:,:]
ro_cerfacs_rca.close()

ro_ichec_hirham = nc.Dataset('ro/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_ro_ichec_hirham = ro_ichec_hirham.variables['sfcWind'][:,:,:]
ro_ichec_hirham.close()

ro_ichec_racmo = nc.Dataset('ro/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_ro_ichec_racmo = ro_ichec_racmo.variables['sfcWind'][:,:,:]
ro_ichec_racmo.close()

ro_ichec_rca = nc.Dataset('ro/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_ro_ichec_rca = ro_ichec_rca.variables['sfcWind'][:,:,:]
ro_ichec_rca.close()

ro_mpi_hirham = nc.Dataset('ro/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_ro_mpi_hirham = ro_mpi_hirham.variables['sfcWind'][:,:,:]
ro_mpi_hirham.close()

ro_mpi_rca = nc.Dataset('ro/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_ro_mpi_rca = ro_mpi_rca.variables['sfcWind'][:,:,:]
ro_mpi_rca.close()

ro_noresm_hirham = nc.Dataset('ro/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_ro_noresm_hirham = ro_noresm_hirham.variables['sfcWind'][:,:,:]
ro_noresm_hirham.close()

ro_noresm_racmo = nc.Dataset('ro/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_ro_noresm_racmo = ro_noresm_racmo.variables['sfcWind'][:,:,:]
ro_noresm_racmo.close()

ro_noresm_rca = nc.Dataset('ro/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_ro_noresm_rca = ro_noresm_rca.variables['sfcWind'][:,:,:]
ro_noresm_rca.close()


variab = ['sfcWind']
variab = variab * 130
sites= ['ro']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_ro_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_ro = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_ro[i,0] = np.mean(sfcWind_ro_cerfacs_hirham[i,:,:])
    annual_sfcWind_ro[i,1] = np.mean(sfcWind_ro_cerfacs_rca[i,:,:])
    annual_sfcWind_ro[i,2] = np.mean(sfcWind_ro_ichec_hirham[i,:,:])
    annual_sfcWind_ro[i,3] = np.mean(sfcWind_ro_ichec_racmo[i,:,:])
    annual_sfcWind_ro[i,4] = np.mean(sfcWind_ro_ichec_rca[i,:,:])
    annual_sfcWind_ro[i,5] = np.mean(sfcWind_ro_mpi_hirham[i,:,:])
    annual_sfcWind_ro[i,6] = np.mean(sfcWind_ro_mpi_rca[i,:,:])
    annual_sfcWind_ro[i,7] = np.mean(sfcWind_ro_noresm_hirham[i,:,:])
    annual_sfcWind_ro[i,8] = np.mean(sfcWind_ro_noresm_racmo[i,:,:])
    annual_sfcWind_ro[i,9] = np.mean(sfcWind_ro_noresm_rca[i,:,:])
annual_sfcWind_ro= annual_sfcWind_ro
annual_sfcWind_ro = np.around(annual_sfcWind_ro,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_ro[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Romania')

df_annual_sfcWind_ro = pd.DataFrame(annual_sfcWind_ro, columns = label_models)
df_annual_sfcWind_ro['var']=variab
df_annual_sfcWind_ro['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_ro],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_ro.png',dpi=300)

"""SPAIN"""
sp_cerfacs_hirham = nc.Dataset('sp/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_sp_cerfacs_hirham = sp_cerfacs_hirham.variables['sfcWind'][:,:,:]
sp_cerfacs_hirham.close()

sp_cerfacs_rca = nc.Dataset('sp/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_sp_cerfacs_rca = sp_cerfacs_rca.variables['sfcWind'][:,:,:]
sp_cerfacs_rca.close()

sp_ichec_hirham = nc.Dataset('sp/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_sp_ichec_hirham = sp_ichec_hirham.variables['sfcWind'][:,:,:]
sp_ichec_hirham.close()

sp_ichec_racmo = nc.Dataset('sp/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_sp_ichec_racmo = sp_ichec_racmo.variables['sfcWind'][:,:,:]
sp_ichec_racmo.close()

sp_ichec_rca = nc.Dataset('sp/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_sp_ichec_rca = sp_ichec_rca.variables['sfcWind'][:,:,:]
sp_ichec_rca.close()

sp_mpi_hirham = nc.Dataset('sp/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_sp_mpi_hirham = sp_mpi_hirham.variables['sfcWind'][:,:,:]
sp_mpi_hirham.close()

sp_mpi_rca = nc.Dataset('sp/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_sp_mpi_rca = sp_mpi_rca.variables['sfcWind'][:,:,:]
sp_mpi_rca.close()

sp_noresm_hirham = nc.Dataset('sp/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_sp_noresm_hirham = sp_noresm_hirham.variables['sfcWind'][:,:,:]
sp_noresm_hirham.close()

sp_noresm_racmo = nc.Dataset('sp/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_sp_noresm_racmo = sp_noresm_racmo.variables['sfcWind'][:,:,:]
sp_noresm_racmo.close()

sp_noresm_rca = nc.Dataset('sp/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_sp_noresm_rca = sp_noresm_rca.variables['sfcWind'][:,:,:]
sp_noresm_rca.close()


variab = ['sfcWind']
variab = variab * 130
sites= ['sp']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_sp_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_sp = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_sp[i,0] = np.mean(sfcWind_sp_cerfacs_hirham[i,:,:])
    annual_sfcWind_sp[i,1] = np.mean(sfcWind_sp_cerfacs_rca[i,:,:])
    annual_sfcWind_sp[i,2] = np.mean(sfcWind_sp_ichec_hirham[i,:,:])
    annual_sfcWind_sp[i,3] = np.mean(sfcWind_sp_ichec_racmo[i,:,:])
    annual_sfcWind_sp[i,4] = np.mean(sfcWind_sp_ichec_rca[i,:,:])
    annual_sfcWind_sp[i,5] = np.mean(sfcWind_sp_mpi_hirham[i,:,:])
    annual_sfcWind_sp[i,6] = np.mean(sfcWind_sp_mpi_rca[i,:,:])
    annual_sfcWind_sp[i,7] = np.mean(sfcWind_sp_noresm_hirham[i,:,:])
    annual_sfcWind_sp[i,8] = np.mean(sfcWind_sp_noresm_racmo[i,:,:])
    annual_sfcWind_sp[i,9] = np.mean(sfcWind_sp_noresm_rca[i,:,:])
annual_sfcWind_sp= annual_sfcWind_sp
annual_sfcWind_sp = np.around(annual_sfcWind_sp,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_sp[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('Spain')

df_annual_sfcWind_sp = pd.DataFrame(annual_sfcWind_sp, columns = label_models)
df_annual_sfcWind_sp['var']=variab
df_annual_sfcWind_sp['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_sp],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_sp.png',dpi=300)

"""UK"""
uk_cerfacs_hirham = nc.Dataset('uk/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sfcWind_uk_cerfacs_hirham = uk_cerfacs_hirham.variables['sfcWind'][:,:,:]
uk_cerfacs_hirham.close()

uk_cerfacs_rca = nc.Dataset('uk/annual/sfcWind_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_uk_cerfacs_rca = uk_cerfacs_rca.variables['sfcWind'][:,:,:]
uk_cerfacs_rca.close()

uk_ichec_hirham = nc.Dataset('uk/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_uk_ichec_hirham = uk_ichec_hirham.variables['sfcWind'][:,:,:]
uk_ichec_hirham.close()

uk_ichec_racmo = nc.Dataset('uk/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_uk_ichec_racmo = uk_ichec_racmo.variables['sfcWind'][:,:,:]
uk_ichec_racmo.close()

uk_ichec_rca = nc.Dataset('uk/annual/sfcWind_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_uk_ichec_rca = uk_ichec_rca.variables['sfcWind'][:,:,:]
uk_ichec_rca.close()

uk_mpi_hirham = nc.Dataset('uk/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sfcWind_uk_mpi_hirham = uk_mpi_hirham.variables['sfcWind'][:,:,:]
uk_mpi_hirham.close()

uk_mpi_rca = nc.Dataset('uk/annual/sfcWind_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_uk_mpi_rca = uk_mpi_rca.variables['sfcWind'][:,:,:]
uk_mpi_rca.close()

uk_noresm_hirham = nc.Dataset('uk/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sfcWind_uk_noresm_hirham = uk_noresm_hirham.variables['sfcWind'][:,:,:]
uk_noresm_hirham.close()

uk_noresm_racmo = nc.Dataset('uk/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sfcWind_uk_noresm_racmo = uk_noresm_racmo.variables['sfcWind'][:,:,:]
uk_noresm_racmo.close()

uk_noresm_rca = nc.Dataset('uk/annual/sfcWind_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sfcWind_uk_noresm_rca = uk_noresm_rca.variables['sfcWind'][:,:,:]
uk_noresm_rca.close()

variab = ['sfcWind']
variab = variab * 130
sites= ['uk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sfcWind_uk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sfcWind_uk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sfcWind_uk[i,0] = np.mean(sfcWind_uk_cerfacs_hirham[i,:,:])
    annual_sfcWind_uk[i,1] = np.mean(sfcWind_uk_cerfacs_rca[i,:,:])
    annual_sfcWind_uk[i,2] = np.mean(sfcWind_uk_ichec_hirham[i,:,:])
    annual_sfcWind_uk[i,3] = np.mean(sfcWind_uk_ichec_racmo[i,:,:])
    annual_sfcWind_uk[i,4] = np.mean(sfcWind_uk_ichec_rca[i,:,:])
    annual_sfcWind_uk[i,5] = np.mean(sfcWind_uk_mpi_hirham[i,:,:])
    annual_sfcWind_uk[i,6] = np.mean(sfcWind_uk_mpi_rca[i,:,:])
    annual_sfcWind_uk[i,7] = np.mean(sfcWind_uk_noresm_hirham[i,:,:])
    annual_sfcWind_uk[i,8] = np.mean(sfcWind_uk_noresm_racmo[i,:,:])
    annual_sfcWind_uk[i,9] = np.mean(sfcWind_uk_noresm_rca[i,:,:])
annual_sfcWind_uk= annual_sfcWind_uk
annual_sfcWind_uk = np.around(annual_sfcWind_uk,decimals=2)

yrs = no_yrs+1971
annual_sfcWind_uk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sfcWind_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sfcWind_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Near-surface wind speed (m/s)')
plt.title('UK')

df_annual_sfcWind_uk = pd.DataFrame(annual_sfcWind_uk, columns = label_models)
df_annual_sfcWind_uk['var']=variab
df_annual_sfcWind_uk['site']=sites

df_all = pd.concat([df_all,df_annual_sfcWind_uk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sfcWind_uk.png',dpi=300)

#################
#################
#################
###hurs
#################
#################
#################
"""AUSTRIA"""
at_cerfacs_hirham = nc.Dataset('at/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_at_cerfacs_hirham = at_cerfacs_hirham.variables['hurs'][:,:,:]
at_cerfacs_hirham.close()

at_cerfacs_rca = nc.Dataset('at/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_at_cerfacs_rca = at_cerfacs_rca.variables['hurs'][:,:,:]
at_cerfacs_rca.close()

at_ichec_hirham = nc.Dataset('at/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_at_ichec_hirham = at_ichec_hirham.variables['hurs'][:,:,:]
at_ichec_hirham.close()

at_ichec_racmo = nc.Dataset('at/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_at_ichec_racmo = at_ichec_racmo.variables['hurs'][:,:,:]
at_ichec_racmo.close()

at_ichec_rca = nc.Dataset('at/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_at_ichec_rca = at_ichec_rca.variables['hurs'][:,:,:]
at_ichec_rca.close()

at_mpi_hirham = nc.Dataset('at/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_at_mpi_hirham = at_mpi_hirham.variables['hurs'][:,:,:]
at_mpi_hirham.close()

at_mpi_rca = nc.Dataset('at/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_at_mpi_rca = at_mpi_rca.variables['hurs'][:,:,:]
at_mpi_rca.close()

at_noresm_hirham = nc.Dataset('at/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_at_noresm_hirham = at_noresm_hirham.variables['hurs'][:,:,:]
at_noresm_hirham.close()

at_noresm_racmo = nc.Dataset('at/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_at_noresm_racmo = at_noresm_racmo.variables['hurs'][:,:,:]
at_noresm_racmo.close()

at_noresm_rca = nc.Dataset('at/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_at_noresm_rca = at_noresm_rca.variables['hurs'][:,:,:]
at_noresm_rca.close()

len_yrs= len(hurs_at_cerfacs_rca)
no_yrs = np.arange(0,len_yrs)
annual_hurs_at = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_at[i,0] = np.mean(hurs_at_cerfacs_hirham[i,:,:])
    annual_hurs_at[i,1] = np.mean(hurs_at_cerfacs_rca[i,:,:])
    annual_hurs_at[i,2] = np.mean(hurs_at_ichec_hirham[i,:,:])
    annual_hurs_at[i,3] = np.mean(hurs_at_ichec_racmo[i,:,:])
    annual_hurs_at[i,4] = np.mean(hurs_at_ichec_rca[i,:,:])
    annual_hurs_at[i,5] = np.mean(hurs_at_mpi_hirham[i,:,:])
    annual_hurs_at[i,6] = np.mean(hurs_at_mpi_rca[i,:,:])
    annual_hurs_at[i,7] = np.mean(hurs_at_noresm_hirham[i,:,:])
    annual_hurs_at[i,8] = np.mean(hurs_at_noresm_racmo[i,:,:])
    annual_hurs_at[i,9] = np.mean(hurs_at_noresm_rca[i,:,:])
annual_hurs_at= annual_hurs_at
annual_hurs_at = np.around(annual_hurs_at,decimals=2)

yrs = no_yrs+1971
annual_hurs_at[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)

variab = ['hurs']
variab = variab * 130
sites= ['at']
sites = sites* 130



label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']
models_ap = []
for ii in np.arange(0,len(label_models)):
    models = [label_models[ii]]
    
    models = np.repeat(models,1300)
    models_ap.append(models)


plt.plot(yrs,annual_hurs_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Austria')


df_annual_hurs_at = pd.DataFrame(annual_hurs_at, columns = label_models)
df_annual_hurs_at['var']=variab
df_annual_hurs_at['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_at],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)
plt.grid(True)
plt.show
plt.savefig('annual_hurs_at.png',dpi=300)

"""DENMARK"""
dk_cerfacs_hirham = nc.Dataset('dk/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_dk_cerfacs_hirham = dk_cerfacs_hirham.variables['hurs'][:,:,:]
dk_cerfacs_hirham.close()

dk_cerfacs_rca = nc.Dataset('dk/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dk_cerfacs_rca = dk_cerfacs_rca.variables['hurs'][:,:,:]
dk_cerfacs_rca.close()

dk_ichec_hirham = nc.Dataset('dk/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_dk_ichec_hirham = dk_ichec_hirham.variables['hurs'][:,:,:]
dk_ichec_hirham.close()

dk_ichec_racmo = nc.Dataset('dk/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_dk_ichec_racmo = dk_ichec_racmo.variables['hurs'][:,:,:]
dk_ichec_racmo.close()

dk_ichec_rca = nc.Dataset('dk/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dk_ichec_rca = dk_ichec_rca.variables['hurs'][:,:,:]
dk_ichec_rca.close()

dk_mpi_hirham = nc.Dataset('dk/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_dk_mpi_hirham = dk_mpi_hirham.variables['hurs'][:,:,:]
dk_mpi_hirham.close()

dk_mpi_rca = nc.Dataset('dk/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dk_mpi_rca = dk_mpi_rca.variables['hurs'][:,:,:]
dk_mpi_rca.close()

dk_noresm_hirham = nc.Dataset('dk/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_dk_noresm_hirham = dk_noresm_hirham.variables['hurs'][:,:,:]
dk_noresm_hirham.close()

dk_noresm_racmo = nc.Dataset('dk/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_dk_noresm_racmo = dk_noresm_racmo.variables['hurs'][:,:,:]
dk_noresm_racmo.close()

dk_noresm_rca = nc.Dataset('dk/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dk_noresm_rca = dk_noresm_rca.variables['hurs'][:,:,:]
dk_noresm_rca.close()

variab = ['hurs']
variab = variab * 130
sites= ['dk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_dk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_dk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_dk[i,0] = np.mean(hurs_dk_cerfacs_hirham[i,:,:])
    annual_hurs_dk[i,1] = np.mean(hurs_dk_cerfacs_rca[i,:,:])
    annual_hurs_dk[i,2] = np.mean(hurs_dk_ichec_hirham[i,:,:])
    annual_hurs_dk[i,3] = np.mean(hurs_dk_ichec_racmo[i,:,:])
    annual_hurs_dk[i,4] = np.mean(hurs_dk_ichec_rca[i,:,:])
    annual_hurs_dk[i,5] = np.mean(hurs_dk_mpi_hirham[i,:,:])
    annual_hurs_dk[i,6] = np.mean(hurs_dk_mpi_rca[i,:,:])
    annual_hurs_dk[i,7] = np.mean(hurs_dk_noresm_hirham[i,:,:])
    annual_hurs_dk[i,8] = np.mean(hurs_dk_noresm_racmo[i,:,:])
    annual_hurs_dk[i,9] = np.mean(hurs_dk_noresm_rca[i,:,:])
annual_hurs_dk= annual_hurs_dk
annual_hurs_dk = np.around(annual_hurs_dk,decimals=2)

yrs = no_yrs+1971
annual_hurs_dk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Denmark')

df_annual_hurs_dk = pd.DataFrame(annual_hurs_dk, columns = label_models)
df_annual_hurs_dk['var']=variab
df_annual_hurs_dk['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_dk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_dk.png',dpi=300)

"""GERMANY"""
dl_cerfacs_hirham = nc.Dataset('dl/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_dl_cerfacs_hirham = dl_cerfacs_hirham.variables['hurs'][:,:,:]
dl_cerfacs_hirham.close()

dl_cerfacs_rca = nc.Dataset('dl/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dl_cerfacs_rca = dl_cerfacs_rca.variables['hurs'][:,:,:]
dl_cerfacs_rca.close()

dl_ichec_hirham = nc.Dataset('dl/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_dl_ichec_hirham = dl_ichec_hirham.variables['hurs'][:,:,:]
dl_ichec_hirham.close()

dl_ichec_racmo = nc.Dataset('dl/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_dl_ichec_racmo = dl_ichec_racmo.variables['hurs'][:,:,:]
dl_ichec_racmo.close()

dl_ichec_rca = nc.Dataset('dl/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dl_ichec_rca = dl_ichec_rca.variables['hurs'][:,:,:]
dl_ichec_rca.close()

dl_mpi_hirham = nc.Dataset('dl/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_dl_mpi_hirham = dl_mpi_hirham.variables['hurs'][:,:,:]
dl_mpi_hirham.close()

dl_mpi_rca = nc.Dataset('dl/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dl_mpi_rca = dl_mpi_rca.variables['hurs'][:,:,:]
dl_mpi_rca.close()

dl_noresm_hirham = nc.Dataset('dl/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_dl_noresm_hirham = dl_noresm_hirham.variables['hurs'][:,:,:]
dl_noresm_hirham.close()

dl_noresm_racmo = nc.Dataset('dl/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_dl_noresm_racmo = dl_noresm_racmo.variables['hurs'][:,:,:]
dl_noresm_racmo.close()

dl_noresm_rca = nc.Dataset('dl/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_dl_noresm_rca = dl_noresm_rca.variables['hurs'][:,:,:]
dl_noresm_rca.close()

variab = ['hurs']
variab = variab * 130
sites= ['dl']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_dl_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_dl = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_dl[i,0] = np.mean(hurs_dl_cerfacs_hirham[i,:,:])
    annual_hurs_dl[i,1] = np.mean(hurs_dl_cerfacs_rca[i,:,:])
    annual_hurs_dl[i,2] = np.mean(hurs_dl_ichec_hirham[i,:,:])
    annual_hurs_dl[i,3] = np.mean(hurs_dl_ichec_racmo[i,:,:])
    annual_hurs_dl[i,4] = np.mean(hurs_dl_ichec_rca[i,:,:])
    annual_hurs_dl[i,5] = np.mean(hurs_dl_mpi_hirham[i,:,:])
    annual_hurs_dl[i,6] = np.mean(hurs_dl_mpi_rca[i,:,:])
    annual_hurs_dl[i,7] = np.mean(hurs_dl_noresm_hirham[i,:,:])
    annual_hurs_dl[i,8] = np.mean(hurs_dl_noresm_racmo[i,:,:])
    annual_hurs_dl[i,9] = np.mean(hurs_dl_noresm_rca[i,:,:])
annual_hurs_dl= annual_hurs_dl
annual_hurs_dl = np.around(annual_hurs_dl,decimals=2)

yrs = no_yrs+1971
annual_hurs_dl[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Germany')

df_annual_hurs_dl = pd.DataFrame(annual_hurs_dl, columns = label_models)
df_annual_hurs_dl['var']=variab
df_annual_hurs_dl['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_dl],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_dl.png',dpi=300)


"""FINLAND"""
fi_cerfacs_hirham = nc.Dataset('fi/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_fi_cerfacs_hirham = fi_cerfacs_hirham.variables['hurs'][:,:,:]
fi_cerfacs_hirham.close()

fi_cerfacs_rca = nc.Dataset('fi/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fi_cerfacs_rca = fi_cerfacs_rca.variables['hurs'][:,:,:]
fi_cerfacs_rca.close()

fi_ichec_hirham = nc.Dataset('fi/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_fi_ichec_hirham = fi_ichec_hirham.variables['hurs'][:,:,:]
fi_ichec_hirham.close()

fi_ichec_racmo = nc.Dataset('fi/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_fi_ichec_racmo = fi_ichec_racmo.variables['hurs'][:,:,:]
fi_ichec_racmo.close()

fi_ichec_rca = nc.Dataset('fi/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fi_ichec_rca = fi_ichec_rca.variables['hurs'][:,:,:]
fi_ichec_rca.close()

fi_mpi_hirham = nc.Dataset('fi/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_fi_mpi_hirham = fi_mpi_hirham.variables['hurs'][:,:,:]
fi_mpi_hirham.close()

fi_mpi_rca = nc.Dataset('fi/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fi_mpi_rca = fi_mpi_rca.variables['hurs'][:,:,:]
fi_mpi_rca.close()

fi_noresm_hirham = nc.Dataset('fi/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_fi_noresm_hirham = fi_noresm_hirham.variables['hurs'][:,:,:]
fi_noresm_hirham.close()

fi_noresm_racmo = nc.Dataset('fi/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_fi_noresm_racmo = fi_noresm_racmo.variables['hurs'][:,:,:]
fi_noresm_racmo.close()

fi_noresm_rca = nc.Dataset('fi/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fi_noresm_rca = fi_noresm_rca.variables['hurs'][:,:,:]
fi_noresm_rca.close()

variab = ['hurs']
variab = variab * 130
sites= ['fi']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_fi_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_fi = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_fi[i,0] = np.mean(hurs_fi_cerfacs_hirham[i,:,:])
    annual_hurs_fi[i,1] = np.mean(hurs_fi_cerfacs_rca[i,:,:])
    annual_hurs_fi[i,2] = np.mean(hurs_fi_ichec_hirham[i,:,:])
    annual_hurs_fi[i,3] = np.mean(hurs_fi_ichec_racmo[i,:,:])
    annual_hurs_fi[i,4] = np.mean(hurs_fi_ichec_rca[i,:,:])
    annual_hurs_fi[i,5] = np.mean(hurs_fi_mpi_hirham[i,:,:])
    annual_hurs_fi[i,6] = np.mean(hurs_fi_mpi_rca[i,:,:])
    annual_hurs_fi[i,7] = np.mean(hurs_fi_noresm_hirham[i,:,:])
    annual_hurs_fi[i,8] = np.mean(hurs_fi_noresm_racmo[i,:,:])
    annual_hurs_fi[i,9] = np.mean(hurs_fi_noresm_rca[i,:,:])
annual_hurs_fi= annual_hurs_fi
annual_hurs_fi = np.around(annual_hurs_fi,decimals=2)

yrs = no_yrs+1971
annual_hurs_fi[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Finland')

df_annual_hurs_fi = pd.DataFrame(annual_hurs_fi, columns = label_models)
df_annual_hurs_fi['var']=variab
df_annual_hurs_fi['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_fi],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_fi.png',dpi=300)

"""FRANCE"""
fr_cerfacs_hirham = nc.Dataset('fr/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_fr_cerfacs_hirham = fr_cerfacs_hirham.variables['hurs'][:,:,:]
fr_cerfacs_hirham.close()

fr_cerfacs_rca = nc.Dataset('fr/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fr_cerfacs_rca = fr_cerfacs_rca.variables['hurs'][:,:,:]
fr_cerfacs_rca.close()

fr_ichec_hirham = nc.Dataset('fr/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_fr_ichec_hirham = fr_ichec_hirham.variables['hurs'][:,:,:]
fr_ichec_hirham.close()

fr_ichec_racmo = nc.Dataset('fr/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_fr_ichec_racmo = fr_ichec_racmo.variables['hurs'][:,:,:]
fr_ichec_racmo.close()

fr_ichec_rca = nc.Dataset('fr/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fr_ichec_rca = fr_ichec_rca.variables['hurs'][:,:,:]
fr_ichec_rca.close()

fr_mpi_hirham = nc.Dataset('fr/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_fr_mpi_hirham = fr_mpi_hirham.variables['hurs'][:,:,:]
fr_mpi_hirham.close()

fr_mpi_rca = nc.Dataset('fr/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fr_mpi_rca = fr_mpi_rca.variables['hurs'][:,:,:]
fr_mpi_rca.close()

fr_noresm_hirham = nc.Dataset('fr/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_fr_noresm_hirham = fr_noresm_hirham.variables['hurs'][:,:,:]
fr_noresm_hirham.close()

fr_noresm_racmo = nc.Dataset('fr/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_fr_noresm_racmo = fr_noresm_racmo.variables['hurs'][:,:,:]
fr_noresm_racmo.close()

fr_noresm_rca = nc.Dataset('fr/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_fr_noresm_rca = fr_noresm_rca.variables['hurs'][:,:,:]
fr_noresm_rca.close()


variab = ['hurs']
variab = variab * 130
sites= ['fr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_fr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_fr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_fr[i,0] = np.mean(hurs_fr_cerfacs_hirham[i,:,:])
    annual_hurs_fr[i,1] = np.mean(hurs_fr_cerfacs_rca[i,:,:])
    annual_hurs_fr[i,2] = np.mean(hurs_fr_ichec_hirham[i,:,:])
    annual_hurs_fr[i,3] = np.mean(hurs_fr_ichec_racmo[i,:,:])
    annual_hurs_fr[i,4] = np.mean(hurs_fr_ichec_rca[i,:,:])
    annual_hurs_fr[i,5] = np.mean(hurs_fr_mpi_hirham[i,:,:])
    annual_hurs_fr[i,6] = np.mean(hurs_fr_mpi_rca[i,:,:])
    annual_hurs_fr[i,7] = np.mean(hurs_fr_noresm_hirham[i,:,:])
    annual_hurs_fr[i,8] = np.mean(hurs_fr_noresm_racmo[i,:,:])
    annual_hurs_fr[i,9] = np.mean(hurs_fr_noresm_rca[i,:,:])
annual_hurs_fr= annual_hurs_fr
annual_hurs_fr = np.around(annual_hurs_fr,decimals=2)

yrs = no_yrs+1971
annual_hurs_fr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('France')

df_annual_hurs_fr = pd.DataFrame(annual_hurs_fr, columns = label_models)
df_annual_hurs_fr['var']=variab
df_annual_hurs_fr['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_fr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_fr.png',dpi=300)

"""GREECE"""
gr_cerfacs_hirham = nc.Dataset('gr/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_gr_cerfacs_hirham = gr_cerfacs_hirham.variables['hurs'][:,:,:]
gr_cerfacs_hirham.close()

gr_cerfacs_rca = nc.Dataset('gr/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_gr_cerfacs_rca = gr_cerfacs_rca.variables['hurs'][:,:,:]
gr_cerfacs_rca.close()

gr_ichec_hirham = nc.Dataset('gr/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_gr_ichec_hirham = gr_ichec_hirham.variables['hurs'][:,:,:]
gr_ichec_hirham.close()

gr_ichec_racmo = nc.Dataset('gr/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_gr_ichec_racmo = gr_ichec_racmo.variables['hurs'][:,:,:]
gr_ichec_racmo.close()

gr_ichec_rca = nc.Dataset('gr/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_gr_ichec_rca = gr_ichec_rca.variables['hurs'][:,:,:]
gr_ichec_rca.close()

gr_mpi_hirham = nc.Dataset('gr/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_gr_mpi_hirham = gr_mpi_hirham.variables['hurs'][:,:,:]
gr_mpi_hirham.close()

gr_mpi_rca = nc.Dataset('gr/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_gr_mpi_rca = gr_mpi_rca.variables['hurs'][:,:,:]
gr_mpi_rca.close()

gr_noresm_hirham = nc.Dataset('gr/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_gr_noresm_hirham = gr_noresm_hirham.variables['hurs'][:,:,:]
gr_noresm_hirham.close()

gr_noresm_racmo = nc.Dataset('gr/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_gr_noresm_racmo = gr_noresm_racmo.variables['hurs'][:,:,:]
gr_noresm_racmo.close()

gr_noresm_rca = nc.Dataset('gr/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_gr_noresm_rca = gr_noresm_rca.variables['hurs'][:,:,:]
gr_noresm_rca.close()


variab = ['hurs']
variab = variab * 130
sites= ['gr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_gr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_gr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_gr[i,0] = np.mean(hurs_gr_cerfacs_hirham[i,:,:])
    annual_hurs_gr[i,1] = np.mean(hurs_gr_cerfacs_rca[i,:,:])
    annual_hurs_gr[i,2] = np.mean(hurs_gr_ichec_hirham[i,:,:])
    annual_hurs_gr[i,3] = np.mean(hurs_gr_ichec_racmo[i,:,:])
    annual_hurs_gr[i,4] = np.mean(hurs_gr_ichec_rca[i,:,:])
    annual_hurs_gr[i,5] = np.mean(hurs_gr_mpi_hirham[i,:,:])
    annual_hurs_gr[i,6] = np.mean(hurs_gr_mpi_rca[i,:,:])
    annual_hurs_gr[i,7] = np.mean(hurs_gr_noresm_hirham[i,:,:])
    annual_hurs_gr[i,8] = np.mean(hurs_gr_noresm_racmo[i,:,:])
    annual_hurs_gr[i,9] = np.mean(hurs_gr_noresm_rca[i,:,:])
annual_hurs_gr= annual_hurs_gr
annual_hurs_gr = np.around(annual_hurs_gr,decimals=2)

yrs = no_yrs+1971
annual_hurs_gr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Greece')

df_annual_hurs_gr = pd.DataFrame(annual_hurs_gr, columns = label_models)
df_annual_hurs_gr['var']=variab
df_annual_hurs_gr['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_gr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_gr.png',dpi=300)

"""ITALY"""
it_cerfacs_hirham = nc.Dataset('it/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_it_cerfacs_hirham = it_cerfacs_hirham.variables['hurs'][:,:,:]
it_cerfacs_hirham.close()

it_cerfacs_rca = nc.Dataset('it/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_it_cerfacs_rca = it_cerfacs_rca.variables['hurs'][:,:,:]
it_cerfacs_rca.close()

it_ichec_hirham = nc.Dataset('it/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_it_ichec_hirham = it_ichec_hirham.variables['hurs'][:,:,:]
it_ichec_hirham.close()

it_ichec_racmo = nc.Dataset('it/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_it_ichec_racmo = it_ichec_racmo.variables['hurs'][:,:,:]
it_ichec_racmo.close()

it_ichec_rca = nc.Dataset('it/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_it_ichec_rca = it_ichec_rca.variables['hurs'][:,:,:]
it_ichec_rca.close()

it_mpi_hirham = nc.Dataset('it/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_it_mpi_hirham = it_mpi_hirham.variables['hurs'][:,:,:]
it_mpi_hirham.close()

it_mpi_rca = nc.Dataset('it/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_it_mpi_rca = it_mpi_rca.variables['hurs'][:,:,:]
it_mpi_rca.close()

it_noresm_hirham = nc.Dataset('it/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_it_noresm_hirham = it_noresm_hirham.variables['hurs'][:,:,:]
it_noresm_hirham.close()

it_noresm_racmo = nc.Dataset('it/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_it_noresm_racmo = it_noresm_racmo.variables['hurs'][:,:,:]
it_noresm_racmo.close()

it_noresm_rca = nc.Dataset('it/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_it_noresm_rca = it_noresm_rca.variables['hurs'][:,:,:]
it_noresm_rca.close()


variab = ['hurs']
variab = variab * 130
sites= ['it']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_it_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_it = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_it[i,0] = np.mean(hurs_it_cerfacs_hirham[i,:,:])
    annual_hurs_it[i,1] = np.mean(hurs_it_cerfacs_rca[i,:,:])
    annual_hurs_it[i,2] = np.mean(hurs_it_ichec_hirham[i,:,:])
    annual_hurs_it[i,3] = np.mean(hurs_it_ichec_racmo[i,:,:])
    annual_hurs_it[i,4] = np.mean(hurs_it_ichec_rca[i,:,:])
    annual_hurs_it[i,5] = np.mean(hurs_it_mpi_hirham[i,:,:])
    annual_hurs_it[i,6] = np.mean(hurs_it_mpi_rca[i,:,:])
    annual_hurs_it[i,7] = np.mean(hurs_it_noresm_hirham[i,:,:])
    annual_hurs_it[i,8] = np.mean(hurs_it_noresm_racmo[i,:,:])
    annual_hurs_it[i,9] = np.mean(hurs_it_noresm_rca[i,:,:])
annual_hurs_it= annual_hurs_it
annual_hurs_it = np.around(annual_hurs_it,decimals=2)

yrs = no_yrs+1971
annual_hurs_it[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Italy')

df_annual_hurs_it = pd.DataFrame(annual_hurs_it, columns = label_models)
df_annual_hurs_it['var']=variab
df_annual_hurs_it['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_it],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_it.png',dpi=300)

"""ROMANIA"""
ro_cerfacs_hirham = nc.Dataset('ro/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_ro_cerfacs_hirham = ro_cerfacs_hirham.variables['hurs'][:,:,:]
ro_cerfacs_hirham.close()

ro_cerfacs_rca = nc.Dataset('ro/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_ro_cerfacs_rca = ro_cerfacs_rca.variables['hurs'][:,:,:]
ro_cerfacs_rca.close()

ro_ichec_hirham = nc.Dataset('ro/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_ro_ichec_hirham = ro_ichec_hirham.variables['hurs'][:,:,:]
ro_ichec_hirham.close()

ro_ichec_racmo = nc.Dataset('ro/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_ro_ichec_racmo = ro_ichec_racmo.variables['hurs'][:,:,:]
ro_ichec_racmo.close()

ro_ichec_rca = nc.Dataset('ro/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_ro_ichec_rca = ro_ichec_rca.variables['hurs'][:,:,:]
ro_ichec_rca.close()

ro_mpi_hirham = nc.Dataset('ro/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_ro_mpi_hirham = ro_mpi_hirham.variables['hurs'][:,:,:]
ro_mpi_hirham.close()

ro_mpi_rca = nc.Dataset('ro/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_ro_mpi_rca = ro_mpi_rca.variables['hurs'][:,:,:]
ro_mpi_rca.close()

ro_noresm_hirham = nc.Dataset('ro/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_ro_noresm_hirham = ro_noresm_hirham.variables['hurs'][:,:,:]
ro_noresm_hirham.close()

ro_noresm_racmo = nc.Dataset('ro/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_ro_noresm_racmo = ro_noresm_racmo.variables['hurs'][:,:,:]
ro_noresm_racmo.close()

ro_noresm_rca = nc.Dataset('ro/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_ro_noresm_rca = ro_noresm_rca.variables['hurs'][:,:,:]
ro_noresm_rca.close()


variab = ['hurs']
variab = variab * 130
sites= ['ro']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_ro_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_ro = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_ro[i,0] = np.mean(hurs_ro_cerfacs_hirham[i,:,:])
    annual_hurs_ro[i,1] = np.mean(hurs_ro_cerfacs_rca[i,:,:])
    annual_hurs_ro[i,2] = np.mean(hurs_ro_ichec_hirham[i,:,:])
    annual_hurs_ro[i,3] = np.mean(hurs_ro_ichec_racmo[i,:,:])
    annual_hurs_ro[i,4] = np.mean(hurs_ro_ichec_rca[i,:,:])
    annual_hurs_ro[i,5] = np.mean(hurs_ro_mpi_hirham[i,:,:])
    annual_hurs_ro[i,6] = np.mean(hurs_ro_mpi_rca[i,:,:])
    annual_hurs_ro[i,7] = np.mean(hurs_ro_noresm_hirham[i,:,:])
    annual_hurs_ro[i,8] = np.mean(hurs_ro_noresm_racmo[i,:,:])
    annual_hurs_ro[i,9] = np.mean(hurs_ro_noresm_rca[i,:,:])
annual_hurs_ro= annual_hurs_ro
annual_hurs_ro = np.around(annual_hurs_ro,decimals=2)

yrs = no_yrs+1971
annual_hurs_ro[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Romania')

df_annual_hurs_ro = pd.DataFrame(annual_hurs_ro, columns = label_models)
df_annual_hurs_ro['var']=variab
df_annual_hurs_ro['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_ro],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_ro.png',dpi=300)

"""SPAIN"""
sp_cerfacs_hirham = nc.Dataset('sp/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_sp_cerfacs_hirham = sp_cerfacs_hirham.variables['hurs'][:,:,:]
sp_cerfacs_hirham.close()

sp_cerfacs_rca = nc.Dataset('sp/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_sp_cerfacs_rca = sp_cerfacs_rca.variables['hurs'][:,:,:]
sp_cerfacs_rca.close()

sp_ichec_hirham = nc.Dataset('sp/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_sp_ichec_hirham = sp_ichec_hirham.variables['hurs'][:,:,:]
sp_ichec_hirham.close()

sp_ichec_racmo = nc.Dataset('sp/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_sp_ichec_racmo = sp_ichec_racmo.variables['hurs'][:,:,:]
sp_ichec_racmo.close()

sp_ichec_rca = nc.Dataset('sp/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_sp_ichec_rca = sp_ichec_rca.variables['hurs'][:,:,:]
sp_ichec_rca.close()

sp_mpi_hirham = nc.Dataset('sp/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_sp_mpi_hirham = sp_mpi_hirham.variables['hurs'][:,:,:]
sp_mpi_hirham.close()

sp_mpi_rca = nc.Dataset('sp/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_sp_mpi_rca = sp_mpi_rca.variables['hurs'][:,:,:]
sp_mpi_rca.close()

sp_noresm_hirham = nc.Dataset('sp/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_sp_noresm_hirham = sp_noresm_hirham.variables['hurs'][:,:,:]
sp_noresm_hirham.close()

sp_noresm_racmo = nc.Dataset('sp/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_sp_noresm_racmo = sp_noresm_racmo.variables['hurs'][:,:,:]
sp_noresm_racmo.close()

sp_noresm_rca = nc.Dataset('sp/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_sp_noresm_rca = sp_noresm_rca.variables['hurs'][:,:,:]
sp_noresm_rca.close()


variab = ['hurs']
variab = variab * 130
sites= ['sp']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_sp_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_sp = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_sp[i,0] = np.mean(hurs_sp_cerfacs_hirham[i,:,:])
    annual_hurs_sp[i,1] = np.mean(hurs_sp_cerfacs_rca[i,:,:])
    annual_hurs_sp[i,2] = np.mean(hurs_sp_ichec_hirham[i,:,:])
    annual_hurs_sp[i,3] = np.mean(hurs_sp_ichec_racmo[i,:,:])
    annual_hurs_sp[i,4] = np.mean(hurs_sp_ichec_rca[i,:,:])
    annual_hurs_sp[i,5] = np.mean(hurs_sp_mpi_hirham[i,:,:])
    annual_hurs_sp[i,6] = np.mean(hurs_sp_mpi_rca[i,:,:])
    annual_hurs_sp[i,7] = np.mean(hurs_sp_noresm_hirham[i,:,:])
    annual_hurs_sp[i,8] = np.mean(hurs_sp_noresm_racmo[i,:,:])
    annual_hurs_sp[i,9] = np.mean(hurs_sp_noresm_rca[i,:,:])
annual_hurs_sp= annual_hurs_sp
annual_hurs_sp = np.around(annual_hurs_sp,decimals=2)

yrs = no_yrs+1971
annual_hurs_sp[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('Spain')

df_annual_hurs_sp = pd.DataFrame(annual_hurs_sp, columns = label_models)
df_annual_hurs_sp['var']=variab
df_annual_hurs_sp['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_sp],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_sp.png',dpi=300)

"""UK"""
uk_cerfacs_hirham = nc.Dataset('uk/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
hurs_uk_cerfacs_hirham = uk_cerfacs_hirham.variables['hurs'][:,:,:]
uk_cerfacs_hirham.close()

uk_cerfacs_rca = nc.Dataset('uk/annual/hurs_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_uk_cerfacs_rca = uk_cerfacs_rca.variables['hurs'][:,:,:]
uk_cerfacs_rca.close()

uk_ichec_hirham = nc.Dataset('uk/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_uk_ichec_hirham = uk_ichec_hirham.variables['hurs'][:,:,:]
uk_ichec_hirham.close()

uk_ichec_racmo = nc.Dataset('uk/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_uk_ichec_racmo = uk_ichec_racmo.variables['hurs'][:,:,:]
uk_ichec_racmo.close()

uk_ichec_rca = nc.Dataset('uk/annual/hurs_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_uk_ichec_rca = uk_ichec_rca.variables['hurs'][:,:,:]
uk_ichec_rca.close()

uk_mpi_hirham = nc.Dataset('uk/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
hurs_uk_mpi_hirham = uk_mpi_hirham.variables['hurs'][:,:,:]
uk_mpi_hirham.close()

uk_mpi_rca = nc.Dataset('uk/annual/hurs_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_uk_mpi_rca = uk_mpi_rca.variables['hurs'][:,:,:]
uk_mpi_rca.close()

uk_noresm_hirham = nc.Dataset('uk/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
hurs_uk_noresm_hirham = uk_noresm_hirham.variables['hurs'][:,:,:]
uk_noresm_hirham.close()

uk_noresm_racmo = nc.Dataset('uk/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
hurs_uk_noresm_racmo = uk_noresm_racmo.variables['hurs'][:,:,:]
uk_noresm_racmo.close()

uk_noresm_rca = nc.Dataset('uk/annual/hurs_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
hurs_uk_noresm_rca = uk_noresm_rca.variables['hurs'][:,:,:]
uk_noresm_rca.close()

variab = ['hurs']
variab = variab * 130
sites= ['uk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(hurs_uk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_hurs_uk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_hurs_uk[i,0] = np.mean(hurs_uk_cerfacs_hirham[i,:,:])
    annual_hurs_uk[i,1] = np.mean(hurs_uk_cerfacs_rca[i,:,:])
    annual_hurs_uk[i,2] = np.mean(hurs_uk_ichec_hirham[i,:,:])
    annual_hurs_uk[i,3] = np.mean(hurs_uk_ichec_racmo[i,:,:])
    annual_hurs_uk[i,4] = np.mean(hurs_uk_ichec_rca[i,:,:])
    annual_hurs_uk[i,5] = np.mean(hurs_uk_mpi_hirham[i,:,:])
    annual_hurs_uk[i,6] = np.mean(hurs_uk_mpi_rca[i,:,:])
    annual_hurs_uk[i,7] = np.mean(hurs_uk_noresm_hirham[i,:,:])
    annual_hurs_uk[i,8] = np.mean(hurs_uk_noresm_racmo[i,:,:])
    annual_hurs_uk[i,9] = np.mean(hurs_uk_noresm_rca[i,:,:])
annual_hurs_uk= annual_hurs_uk
annual_hurs_uk = np.around(annual_hurs_uk,decimals=2)

yrs = no_yrs+1971
annual_hurs_uk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_hurs_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_hurs_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Relative humidity (%)')
plt.title('UK')

df_annual_hurs_uk = pd.DataFrame(annual_hurs_uk, columns = label_models)
df_annual_hurs_uk['var']=variab
df_annual_hurs_uk['site']=sites

df_all = pd.concat([df_all,df_annual_hurs_uk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_hurs_uk.png',dpi=300)

#################
#################
#################
###sund
#################
#################
#################
"""AUSTRIA"""
at_cerfacs_hirham = nc.Dataset('at/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_at_cerfacs_hirham = at_cerfacs_hirham.variables['sund'][:,:,:]
at_cerfacs_hirham.close()

at_cerfacs_rca = nc.Dataset('at/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_at_cerfacs_rca = at_cerfacs_rca.variables['sund'][:,:,:]
at_cerfacs_rca.close()

at_ichec_hirham = nc.Dataset('at/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_at_ichec_hirham = at_ichec_hirham.variables['sund'][:,:,:]
at_ichec_hirham.close()

at_ichec_racmo = nc.Dataset('at/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_at_ichec_racmo = at_ichec_racmo.variables['sund'][:,:,:]
at_ichec_racmo.close()

at_ichec_rca = nc.Dataset('at/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_at_ichec_rca = at_ichec_rca.variables['sund'][:,:,:]
at_ichec_rca.close()

at_mpi_hirham = nc.Dataset('at/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_at_mpi_hirham = at_mpi_hirham.variables['sund'][:,:,:]
at_mpi_hirham.close()

at_mpi_rca = nc.Dataset('at/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_at_mpi_rca = at_mpi_rca.variables['sund'][:,:,:]
at_mpi_rca.close()

at_noresm_hirham = nc.Dataset('at/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_at_noresm_hirham = at_noresm_hirham.variables['sund'][:,:,:]
at_noresm_hirham.close()

at_noresm_racmo = nc.Dataset('at/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_at_noresm_racmo = at_noresm_racmo.variables['sund'][:,:,:]
at_noresm_racmo.close()

at_noresm_rca = nc.Dataset('at/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_at_noresm_rca = at_noresm_rca.variables['sund'][:,:,:]
at_noresm_rca.close()

len_yrs= len(sund_at_cerfacs_rca)
no_yrs = np.arange(0,len_yrs)
annual_sund_at = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_at[i,0] = np.mean(sund_at_cerfacs_hirham[i,:,:])
    annual_sund_at[i,1] = np.mean(sund_at_cerfacs_rca[i,:,:])
    annual_sund_at[i,2] = np.mean(sund_at_ichec_hirham[i,:,:])
    annual_sund_at[i,3] = np.mean(sund_at_ichec_racmo[i,:,:])
    annual_sund_at[i,4] = np.mean(sund_at_ichec_rca[i,:,:])
    annual_sund_at[i,5] = np.mean(sund_at_mpi_hirham[i,:,:])
    annual_sund_at[i,6] = np.mean(sund_at_mpi_rca[i,:,:])
    annual_sund_at[i,7] = np.mean(sund_at_noresm_hirham[i,:,:])
    annual_sund_at[i,8] = np.mean(sund_at_noresm_racmo[i,:,:])
    annual_sund_at[i,9] = np.mean(sund_at_noresm_rca[i,:,:])
annual_sund_at= annual_sund_at/3600
annual_sund_at = np.around(annual_sund_at,decimals=2)

yrs = no_yrs+1971
annual_sund_at[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)

variab = ['sund']
variab = variab * 130
sites= ['at']
sites = sites* 130



label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']
models_ap = []
for ii in np.arange(0,len(label_models)):
    models = [label_models[ii]]
    
    models = np.repeat(models,1300)
    models_ap.append(models)


plt.plot(yrs,annual_sund_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Austria')


df_annual_sund_at = pd.DataFrame(annual_sund_at, columns = label_models)
df_annual_sund_at['var']=variab
df_annual_sund_at['site']=sites

df_all = pd.concat([df_all,df_annual_sund_at],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)
plt.grid(True)
plt.show
plt.savefig('annual_sund_at.png',dpi=300)

"""DENMARK"""
dk_cerfacs_hirham = nc.Dataset('dk/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_dk_cerfacs_hirham = dk_cerfacs_hirham.variables['sund'][:,:,:]
dk_cerfacs_hirham.close()

dk_cerfacs_rca = nc.Dataset('dk/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dk_cerfacs_rca = dk_cerfacs_rca.variables['sund'][:,:,:]
dk_cerfacs_rca.close()

dk_ichec_hirham = nc.Dataset('dk/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_dk_ichec_hirham = dk_ichec_hirham.variables['sund'][:,:,:]
dk_ichec_hirham.close()

dk_ichec_racmo = nc.Dataset('dk/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_dk_ichec_racmo = dk_ichec_racmo.variables['sund'][:,:,:]
dk_ichec_racmo.close()

dk_ichec_rca = nc.Dataset('dk/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dk_ichec_rca = dk_ichec_rca.variables['sund'][:,:,:]
dk_ichec_rca.close()

dk_mpi_hirham = nc.Dataset('dk/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_dk_mpi_hirham = dk_mpi_hirham.variables['sund'][:,:,:]
dk_mpi_hirham.close()

dk_mpi_rca = nc.Dataset('dk/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dk_mpi_rca = dk_mpi_rca.variables['sund'][:,:,:]
dk_mpi_rca.close()

dk_noresm_hirham = nc.Dataset('dk/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_dk_noresm_hirham = dk_noresm_hirham.variables['sund'][:,:,:]
dk_noresm_hirham.close()

dk_noresm_racmo = nc.Dataset('dk/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_dk_noresm_racmo = dk_noresm_racmo.variables['sund'][:,:,:]
dk_noresm_racmo.close()

dk_noresm_rca = nc.Dataset('dk/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dk_noresm_rca = dk_noresm_rca.variables['sund'][:,:,:]
dk_noresm_rca.close()

variab = ['sund']
variab = variab * 130
sites= ['dk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_dk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_dk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_dk[i,0] = np.mean(sund_dk_cerfacs_hirham[i,:,:])
    annual_sund_dk[i,1] = np.mean(sund_dk_cerfacs_rca[i,:,:])
    annual_sund_dk[i,2] = np.mean(sund_dk_ichec_hirham[i,:,:])
    annual_sund_dk[i,3] = np.mean(sund_dk_ichec_racmo[i,:,:])
    annual_sund_dk[i,4] = np.mean(sund_dk_ichec_rca[i,:,:])
    annual_sund_dk[i,5] = np.mean(sund_dk_mpi_hirham[i,:,:])
    annual_sund_dk[i,6] = np.mean(sund_dk_mpi_rca[i,:,:])
    annual_sund_dk[i,7] = np.mean(sund_dk_noresm_hirham[i,:,:])
    annual_sund_dk[i,8] = np.mean(sund_dk_noresm_racmo[i,:,:])
    annual_sund_dk[i,9] = np.mean(sund_dk_noresm_rca[i,:,:])
annual_sund_dk= annual_sund_dk/3600
annual_sund_dk = np.around(annual_sund_dk,decimals=2)

yrs = no_yrs+1971
annual_sund_dk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Denmark')

df_annual_sund_dk = pd.DataFrame(annual_sund_dk, columns = label_models)
df_annual_sund_dk['var']=variab
df_annual_sund_dk['site']=sites

df_all = pd.concat([df_all,df_annual_sund_dk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_dk.png',dpi=300)

"""GERMANY"""
dl_cerfacs_hirham = nc.Dataset('dl/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_dl_cerfacs_hirham = dl_cerfacs_hirham.variables['sund'][:,:,:]
dl_cerfacs_hirham.close()

dl_cerfacs_rca = nc.Dataset('dl/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dl_cerfacs_rca = dl_cerfacs_rca.variables['sund'][:,:,:]
dl_cerfacs_rca.close()

dl_ichec_hirham = nc.Dataset('dl/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_dl_ichec_hirham = dl_ichec_hirham.variables['sund'][:,:,:]
dl_ichec_hirham.close()

dl_ichec_racmo = nc.Dataset('dl/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_dl_ichec_racmo = dl_ichec_racmo.variables['sund'][:,:,:]
dl_ichec_racmo.close()

dl_ichec_rca = nc.Dataset('dl/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dl_ichec_rca = dl_ichec_rca.variables['sund'][:,:,:]
dl_ichec_rca.close()

dl_mpi_hirham = nc.Dataset('dl/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_dl_mpi_hirham = dl_mpi_hirham.variables['sund'][:,:,:]
dl_mpi_hirham.close()

dl_mpi_rca = nc.Dataset('dl/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dl_mpi_rca = dl_mpi_rca.variables['sund'][:,:,:]
dl_mpi_rca.close()

dl_noresm_hirham = nc.Dataset('dl/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_dl_noresm_hirham = dl_noresm_hirham.variables['sund'][:,:,:]
dl_noresm_hirham.close()

dl_noresm_racmo = nc.Dataset('dl/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_dl_noresm_racmo = dl_noresm_racmo.variables['sund'][:,:,:]
dl_noresm_racmo.close()

dl_noresm_rca = nc.Dataset('dl/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_dl_noresm_rca = dl_noresm_rca.variables['sund'][:,:,:]
dl_noresm_rca.close()

variab = ['sund']
variab = variab * 130
sites= ['dl']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_dl_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_dl = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_dl[i,0] = np.mean(sund_dl_cerfacs_hirham[i,:,:])
    annual_sund_dl[i,1] = np.mean(sund_dl_cerfacs_rca[i,:,:])
    annual_sund_dl[i,2] = np.mean(sund_dl_ichec_hirham[i,:,:])
    annual_sund_dl[i,3] = np.mean(sund_dl_ichec_racmo[i,:,:])
    annual_sund_dl[i,4] = np.mean(sund_dl_ichec_rca[i,:,:])
    annual_sund_dl[i,5] = np.mean(sund_dl_mpi_hirham[i,:,:])
    annual_sund_dl[i,6] = np.mean(sund_dl_mpi_rca[i,:,:])
    annual_sund_dl[i,7] = np.mean(sund_dl_noresm_hirham[i,:,:])
    annual_sund_dl[i,8] = np.mean(sund_dl_noresm_racmo[i,:,:])
    annual_sund_dl[i,9] = np.mean(sund_dl_noresm_rca[i,:,:])
annual_sund_dl= annual_sund_dl/3600
annual_sund_dl = np.around(annual_sund_dl,decimals=2)

yrs = no_yrs+1971
annual_sund_dl[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Germany')

df_annual_sund_dl = pd.DataFrame(annual_sund_dl, columns = label_models)
df_annual_sund_dl['var']=variab
df_annual_sund_dl['site']=sites

df_all = pd.concat([df_all,df_annual_sund_dl],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_dl.png',dpi=300)


"""FINLAND"""
fi_cerfacs_hirham = nc.Dataset('fi/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_fi_cerfacs_hirham = fi_cerfacs_hirham.variables['sund'][:,:,:]
fi_cerfacs_hirham.close()

fi_cerfacs_rca = nc.Dataset('fi/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fi_cerfacs_rca = fi_cerfacs_rca.variables['sund'][:,:,:]
fi_cerfacs_rca.close()

fi_ichec_hirham = nc.Dataset('fi/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_fi_ichec_hirham = fi_ichec_hirham.variables['sund'][:,:,:]
fi_ichec_hirham.close()

fi_ichec_racmo = nc.Dataset('fi/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_fi_ichec_racmo = fi_ichec_racmo.variables['sund'][:,:,:]
fi_ichec_racmo.close()

fi_ichec_rca = nc.Dataset('fi/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fi_ichec_rca = fi_ichec_rca.variables['sund'][:,:,:]
fi_ichec_rca.close()

fi_mpi_hirham = nc.Dataset('fi/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_fi_mpi_hirham = fi_mpi_hirham.variables['sund'][:,:,:]
fi_mpi_hirham.close()

fi_mpi_rca = nc.Dataset('fi/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fi_mpi_rca = fi_mpi_rca.variables['sund'][:,:,:]
fi_mpi_rca.close()

fi_noresm_hirham = nc.Dataset('fi/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_fi_noresm_hirham = fi_noresm_hirham.variables['sund'][:,:,:]
fi_noresm_hirham.close()

fi_noresm_racmo = nc.Dataset('fi/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_fi_noresm_racmo = fi_noresm_racmo.variables['sund'][:,:,:]
fi_noresm_racmo.close()

fi_noresm_rca = nc.Dataset('fi/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fi_noresm_rca = fi_noresm_rca.variables['sund'][:,:,:]
fi_noresm_rca.close()

variab = ['sund']
variab = variab * 130
sites= ['fi']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_fi_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_fi = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_fi[i,0] = np.mean(sund_fi_cerfacs_hirham[i,:,:])
    annual_sund_fi[i,1] = np.mean(sund_fi_cerfacs_rca[i,:,:])
    annual_sund_fi[i,2] = np.mean(sund_fi_ichec_hirham[i,:,:])
    annual_sund_fi[i,3] = np.mean(sund_fi_ichec_racmo[i,:,:])
    annual_sund_fi[i,4] = np.mean(sund_fi_ichec_rca[i,:,:])
    annual_sund_fi[i,5] = np.mean(sund_fi_mpi_hirham[i,:,:])
    annual_sund_fi[i,6] = np.mean(sund_fi_mpi_rca[i,:,:])
    annual_sund_fi[i,7] = np.mean(sund_fi_noresm_hirham[i,:,:])
    annual_sund_fi[i,8] = np.mean(sund_fi_noresm_racmo[i,:,:])
    annual_sund_fi[i,9] = np.mean(sund_fi_noresm_rca[i,:,:])
annual_sund_fi= annual_sund_fi/3600
annual_sund_fi = np.around(annual_sund_fi,decimals=2)

yrs = no_yrs+1971
annual_sund_fi[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Finland')

df_annual_sund_fi = pd.DataFrame(annual_sund_fi, columns = label_models)
df_annual_sund_fi['var']=variab
df_annual_sund_fi['site']=sites

df_all = pd.concat([df_all,df_annual_sund_fi],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_fi.png',dpi=300)

"""FRANCE"""
fr_cerfacs_hirham = nc.Dataset('fr/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_fr_cerfacs_hirham = fr_cerfacs_hirham.variables['sund'][:,:,:]
fr_cerfacs_hirham.close()

fr_cerfacs_rca = nc.Dataset('fr/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fr_cerfacs_rca = fr_cerfacs_rca.variables['sund'][:,:,:]
fr_cerfacs_rca.close()

fr_ichec_hirham = nc.Dataset('fr/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_fr_ichec_hirham = fr_ichec_hirham.variables['sund'][:,:,:]
fr_ichec_hirham.close()

fr_ichec_racmo = nc.Dataset('fr/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_fr_ichec_racmo = fr_ichec_racmo.variables['sund'][:,:,:]
fr_ichec_racmo.close()

fr_ichec_rca = nc.Dataset('fr/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fr_ichec_rca = fr_ichec_rca.variables['sund'][:,:,:]
fr_ichec_rca.close()

fr_mpi_hirham = nc.Dataset('fr/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_fr_mpi_hirham = fr_mpi_hirham.variables['sund'][:,:,:]
fr_mpi_hirham.close()

fr_mpi_rca = nc.Dataset('fr/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fr_mpi_rca = fr_mpi_rca.variables['sund'][:,:,:]
fr_mpi_rca.close()

fr_noresm_hirham = nc.Dataset('fr/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_fr_noresm_hirham = fr_noresm_hirham.variables['sund'][:,:,:]
fr_noresm_hirham.close()

fr_noresm_racmo = nc.Dataset('fr/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_fr_noresm_racmo = fr_noresm_racmo.variables['sund'][:,:,:]
fr_noresm_racmo.close()

fr_noresm_rca = nc.Dataset('fr/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_fr_noresm_rca = fr_noresm_rca.variables['sund'][:,:,:]
fr_noresm_rca.close()


variab = ['sund']
variab = variab * 130
sites= ['fr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_fr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_fr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_fr[i,0] = np.mean(sund_fr_cerfacs_hirham[i,:,:])
    annual_sund_fr[i,1] = np.mean(sund_fr_cerfacs_rca[i,:,:])
    annual_sund_fr[i,2] = np.mean(sund_fr_ichec_hirham[i,:,:])
    annual_sund_fr[i,3] = np.mean(sund_fr_ichec_racmo[i,:,:])
    annual_sund_fr[i,4] = np.mean(sund_fr_ichec_rca[i,:,:])
    annual_sund_fr[i,5] = np.mean(sund_fr_mpi_hirham[i,:,:])
    annual_sund_fr[i,6] = np.mean(sund_fr_mpi_rca[i,:,:])
    annual_sund_fr[i,7] = np.mean(sund_fr_noresm_hirham[i,:,:])
    annual_sund_fr[i,8] = np.mean(sund_fr_noresm_racmo[i,:,:])
    annual_sund_fr[i,9] = np.mean(sund_fr_noresm_rca[i,:,:])
annual_sund_fr= annual_sund_fr/3600
annual_sund_fr = np.around(annual_sund_fr,decimals=2)

yrs = no_yrs+1971
annual_sund_fr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('France')

df_annual_sund_fr = pd.DataFrame(annual_sund_fr, columns = label_models)
df_annual_sund_fr['var']=variab
df_annual_sund_fr['site']=sites

df_all = pd.concat([df_all,df_annual_sund_fr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)


plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_fr.png',dpi=300)

"""GREECE"""
gr_cerfacs_hirham = nc.Dataset('gr/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_gr_cerfacs_hirham = gr_cerfacs_hirham.variables['sund'][:,:,:]
gr_cerfacs_hirham.close()

gr_cerfacs_rca = nc.Dataset('gr/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_gr_cerfacs_rca = gr_cerfacs_rca.variables['sund'][:,:,:]
gr_cerfacs_rca.close()

gr_ichec_hirham = nc.Dataset('gr/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_gr_ichec_hirham = gr_ichec_hirham.variables['sund'][:,:,:]
gr_ichec_hirham.close()

gr_ichec_racmo = nc.Dataset('gr/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_gr_ichec_racmo = gr_ichec_racmo.variables['sund'][:,:,:]
gr_ichec_racmo.close()

gr_ichec_rca = nc.Dataset('gr/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_gr_ichec_rca = gr_ichec_rca.variables['sund'][:,:,:]
gr_ichec_rca.close()

gr_mpi_hirham = nc.Dataset('gr/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_gr_mpi_hirham = gr_mpi_hirham.variables['sund'][:,:,:]
gr_mpi_hirham.close()

gr_mpi_rca = nc.Dataset('gr/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_gr_mpi_rca = gr_mpi_rca.variables['sund'][:,:,:]
gr_mpi_rca.close()

gr_noresm_hirham = nc.Dataset('gr/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_gr_noresm_hirham = gr_noresm_hirham.variables['sund'][:,:,:]
gr_noresm_hirham.close()

gr_noresm_racmo = nc.Dataset('gr/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_gr_noresm_racmo = gr_noresm_racmo.variables['sund'][:,:,:]
gr_noresm_racmo.close()

gr_noresm_rca = nc.Dataset('gr/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_gr_noresm_rca = gr_noresm_rca.variables['sund'][:,:,:]
gr_noresm_rca.close()


variab = ['sund']
variab = variab * 130
sites= ['gr']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_gr_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_gr = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_gr[i,0] = np.mean(sund_gr_cerfacs_hirham[i,:,:])
    annual_sund_gr[i,1] = np.mean(sund_gr_cerfacs_rca[i,:,:])
    annual_sund_gr[i,2] = np.mean(sund_gr_ichec_hirham[i,:,:])
    annual_sund_gr[i,3] = np.mean(sund_gr_ichec_racmo[i,:,:])
    annual_sund_gr[i,4] = np.mean(sund_gr_ichec_rca[i,:,:])
    annual_sund_gr[i,5] = np.mean(sund_gr_mpi_hirham[i,:,:])
    annual_sund_gr[i,6] = np.mean(sund_gr_mpi_rca[i,:,:])
    annual_sund_gr[i,7] = np.mean(sund_gr_noresm_hirham[i,:,:])
    annual_sund_gr[i,8] = np.mean(sund_gr_noresm_racmo[i,:,:])
    annual_sund_gr[i,9] = np.mean(sund_gr_noresm_rca[i,:,:])
annual_sund_gr= annual_sund_gr/3600
annual_sund_gr = np.around(annual_sund_gr,decimals=2)

yrs = no_yrs+1971
annual_sund_gr[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Greece')

df_annual_sund_gr = pd.DataFrame(annual_sund_gr, columns = label_models)
df_annual_sund_gr['var']=variab
df_annual_sund_gr['site']=sites

df_all = pd.concat([df_all,df_annual_sund_gr],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_gr.png',dpi=300)

"""ITALY"""
it_cerfacs_hirham = nc.Dataset('it/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_it_cerfacs_hirham = it_cerfacs_hirham.variables['sund'][:,:,:]
it_cerfacs_hirham.close()

it_cerfacs_rca = nc.Dataset('it/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_it_cerfacs_rca = it_cerfacs_rca.variables['sund'][:,:,:]
it_cerfacs_rca.close()

it_ichec_hirham = nc.Dataset('it/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_it_ichec_hirham = it_ichec_hirham.variables['sund'][:,:,:]
it_ichec_hirham.close()

it_ichec_racmo = nc.Dataset('it/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_it_ichec_racmo = it_ichec_racmo.variables['sund'][:,:,:]
it_ichec_racmo.close()

it_ichec_rca = nc.Dataset('it/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_it_ichec_rca = it_ichec_rca.variables['sund'][:,:,:]
it_ichec_rca.close()

it_mpi_hirham = nc.Dataset('it/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_it_mpi_hirham = it_mpi_hirham.variables['sund'][:,:,:]
it_mpi_hirham.close()

it_mpi_rca = nc.Dataset('it/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_it_mpi_rca = it_mpi_rca.variables['sund'][:,:,:]
it_mpi_rca.close()

it_noresm_hirham = nc.Dataset('it/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_it_noresm_hirham = it_noresm_hirham.variables['sund'][:,:,:]
it_noresm_hirham.close()

it_noresm_racmo = nc.Dataset('it/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_it_noresm_racmo = it_noresm_racmo.variables['sund'][:,:,:]
it_noresm_racmo.close()

it_noresm_rca = nc.Dataset('it/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_it_noresm_rca = it_noresm_rca.variables['sund'][:,:,:]
it_noresm_rca.close()


variab = ['sund']
variab = variab * 130
sites= ['it']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_it_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_it = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_it[i,0] = np.mean(sund_it_cerfacs_hirham[i,:,:])
    annual_sund_it[i,1] = np.mean(sund_it_cerfacs_rca[i,:,:])
    annual_sund_it[i,2] = np.mean(sund_it_ichec_hirham[i,:,:])
    annual_sund_it[i,3] = np.mean(sund_it_ichec_racmo[i,:,:])
    annual_sund_it[i,4] = np.mean(sund_it_ichec_rca[i,:,:])
    annual_sund_it[i,5] = np.mean(sund_it_mpi_hirham[i,:,:])
    annual_sund_it[i,6] = np.mean(sund_it_mpi_rca[i,:,:])
    annual_sund_it[i,7] = np.mean(sund_it_noresm_hirham[i,:,:])
    annual_sund_it[i,8] = np.mean(sund_it_noresm_racmo[i,:,:])
    annual_sund_it[i,9] = np.mean(sund_it_noresm_rca[i,:,:])
annual_sund_it= annual_sund_it/3600
annual_sund_it = np.around(annual_sund_it,decimals=2)

yrs = no_yrs+1971
annual_sund_it[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Italy')

df_annual_sund_it = pd.DataFrame(annual_sund_it, columns = label_models)
df_annual_sund_it['var']=variab
df_annual_sund_it['site']=sites

df_all = pd.concat([df_all,df_annual_sund_it],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_it.png',dpi=300)

"""ROMANIA"""
ro_cerfacs_hirham = nc.Dataset('ro/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_ro_cerfacs_hirham = ro_cerfacs_hirham.variables['sund'][:,:,:]
ro_cerfacs_hirham.close()

ro_cerfacs_rca = nc.Dataset('ro/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_ro_cerfacs_rca = ro_cerfacs_rca.variables['sund'][:,:,:]
ro_cerfacs_rca.close()

ro_ichec_hirham = nc.Dataset('ro/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_ro_ichec_hirham = ro_ichec_hirham.variables['sund'][:,:,:]
ro_ichec_hirham.close()

ro_ichec_racmo = nc.Dataset('ro/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_ro_ichec_racmo = ro_ichec_racmo.variables['sund'][:,:,:]
ro_ichec_racmo.close()

ro_ichec_rca = nc.Dataset('ro/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_ro_ichec_rca = ro_ichec_rca.variables['sund'][:,:,:]
ro_ichec_rca.close()

ro_mpi_hirham = nc.Dataset('ro/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_ro_mpi_hirham = ro_mpi_hirham.variables['sund'][:,:,:]
ro_mpi_hirham.close()

ro_mpi_rca = nc.Dataset('ro/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_ro_mpi_rca = ro_mpi_rca.variables['sund'][:,:,:]
ro_mpi_rca.close()

ro_noresm_hirham = nc.Dataset('ro/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_ro_noresm_hirham = ro_noresm_hirham.variables['sund'][:,:,:]
ro_noresm_hirham.close()

ro_noresm_racmo = nc.Dataset('ro/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_ro_noresm_racmo = ro_noresm_racmo.variables['sund'][:,:,:]
ro_noresm_racmo.close()

ro_noresm_rca = nc.Dataset('ro/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_ro_noresm_rca = ro_noresm_rca.variables['sund'][:,:,:]
ro_noresm_rca.close()


variab = ['sund']
variab = variab * 130
sites= ['ro']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_ro_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_ro = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_ro[i,0] = np.mean(sund_ro_cerfacs_hirham[i,:,:])
    annual_sund_ro[i,1] = np.mean(sund_ro_cerfacs_rca[i,:,:])
    annual_sund_ro[i,2] = np.mean(sund_ro_ichec_hirham[i,:,:])
    annual_sund_ro[i,3] = np.mean(sund_ro_ichec_racmo[i,:,:])
    annual_sund_ro[i,4] = np.mean(sund_ro_ichec_rca[i,:,:])
    annual_sund_ro[i,5] = np.mean(sund_ro_mpi_hirham[i,:,:])
    annual_sund_ro[i,6] = np.mean(sund_ro_mpi_rca[i,:,:])
    annual_sund_ro[i,7] = np.mean(sund_ro_noresm_hirham[i,:,:])
    annual_sund_ro[i,8] = np.mean(sund_ro_noresm_racmo[i,:,:])
    annual_sund_ro[i,9] = np.mean(sund_ro_noresm_rca[i,:,:])
annual_sund_ro= annual_sund_ro/3600
annual_sund_ro = np.around(annual_sund_ro,decimals=2)

yrs = no_yrs+1971
annual_sund_ro[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Romania')

df_annual_sund_ro = pd.DataFrame(annual_sund_ro, columns = label_models)
df_annual_sund_ro['var']=variab
df_annual_sund_ro['site']=sites

df_all = pd.concat([df_all,df_annual_sund_ro],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_ro.png',dpi=300)

"""SPAIN"""
sp_cerfacs_hirham = nc.Dataset('sp/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_sp_cerfacs_hirham = sp_cerfacs_hirham.variables['sund'][:,:,:]
sp_cerfacs_hirham.close()

sp_cerfacs_rca = nc.Dataset('sp/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_sp_cerfacs_rca = sp_cerfacs_rca.variables['sund'][:,:,:]
sp_cerfacs_rca.close()

sp_ichec_hirham = nc.Dataset('sp/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_sp_ichec_hirham = sp_ichec_hirham.variables['sund'][:,:,:]
sp_ichec_hirham.close()

sp_ichec_racmo = nc.Dataset('sp/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_sp_ichec_racmo = sp_ichec_racmo.variables['sund'][:,:,:]
sp_ichec_racmo.close()

sp_ichec_rca = nc.Dataset('sp/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_sp_ichec_rca = sp_ichec_rca.variables['sund'][:,:,:]
sp_ichec_rca.close()

sp_mpi_hirham = nc.Dataset('sp/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_sp_mpi_hirham = sp_mpi_hirham.variables['sund'][:,:,:]
sp_mpi_hirham.close()

sp_mpi_rca = nc.Dataset('sp/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_sp_mpi_rca = sp_mpi_rca.variables['sund'][:,:,:]
sp_mpi_rca.close()

sp_noresm_hirham = nc.Dataset('sp/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_sp_noresm_hirham = sp_noresm_hirham.variables['sund'][:,:,:]
sp_noresm_hirham.close()

sp_noresm_racmo = nc.Dataset('sp/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_sp_noresm_racmo = sp_noresm_racmo.variables['sund'][:,:,:]
sp_noresm_racmo.close()

sp_noresm_rca = nc.Dataset('sp/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_sp_noresm_rca = sp_noresm_rca.variables['sund'][:,:,:]
sp_noresm_rca.close()


variab = ['sund']
variab = variab * 130
sites= ['sp']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_sp_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_sp = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_sp[i,0] = np.mean(sund_sp_cerfacs_hirham[i,:,:])
    annual_sund_sp[i,1] = np.mean(sund_sp_cerfacs_rca[i,:,:])
    annual_sund_sp[i,2] = np.mean(sund_sp_ichec_hirham[i,:,:])
    annual_sund_sp[i,3] = np.mean(sund_sp_ichec_racmo[i,:,:])
    annual_sund_sp[i,4] = np.mean(sund_sp_ichec_rca[i,:,:])
    annual_sund_sp[i,5] = np.mean(sund_sp_mpi_hirham[i,:,:])
    annual_sund_sp[i,6] = np.mean(sund_sp_mpi_rca[i,:,:])
    annual_sund_sp[i,7] = np.mean(sund_sp_noresm_hirham[i,:,:])
    annual_sund_sp[i,8] = np.mean(sund_sp_noresm_racmo[i,:,:])
    annual_sund_sp[i,9] = np.mean(sund_sp_noresm_rca[i,:,:])
annual_sund_sp= annual_sund_sp/3600
annual_sund_sp = np.around(annual_sund_sp,decimals=2)

yrs = no_yrs+1971
annual_sund_sp[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('Spain')

df_annual_sund_sp = pd.DataFrame(annual_sund_sp, columns = label_models)
df_annual_sund_sp['var']=variab
df_annual_sund_sp['site']=sites

df_all = pd.concat([df_all,df_annual_sund_sp],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_sp.png',dpi=300)

"""UK"""
uk_cerfacs_hirham = nc.Dataset('uk/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_DMI-HIRHAM5_v2_day_all.nc')
sund_uk_cerfacs_hirham = uk_cerfacs_hirham.variables['sund'][:,:,:]
uk_cerfacs_hirham.close()

uk_cerfacs_rca = nc.Dataset('uk/annual/sund_EUR-11_CNRM-CERFACS-CNRM-CM5_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_uk_cerfacs_rca = uk_cerfacs_rca.variables['sund'][:,:,:]
uk_cerfacs_rca.close()

uk_ichec_hirham = nc.Dataset('uk/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_uk_ichec_hirham = uk_ichec_hirham.variables['sund'][:,:,:]
uk_ichec_hirham.close()

uk_ichec_racmo = nc.Dataset('uk/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_uk_ichec_racmo = uk_ichec_racmo.variables['sund'][:,:,:]
uk_ichec_racmo.close()

uk_ichec_rca = nc.Dataset('uk/annual/sund_EUR-11_ICHEC-EC-EARTH_rcp85_r12i1p1_SMHI-RCA4_v1_day_all.nc')
sund_uk_ichec_rca = uk_ichec_rca.variables['sund'][:,:,:]
uk_ichec_rca.close()

uk_mpi_hirham = nc.Dataset('uk/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r1i1p1_DMI-HIRHAM5_v1_day_all.nc')
sund_uk_mpi_hirham = uk_mpi_hirham.variables['sund'][:,:,:]
uk_mpi_hirham.close()

uk_mpi_rca = nc.Dataset('uk/annual/sund_EUR-11_MPI-M-MPI-ESM-LR_rcp85_r2i1p1_SMHI-RCA4_v1_day_all.nc')
sund_uk_mpi_rca = uk_mpi_rca.variables['sund'][:,:,:]
uk_mpi_rca.close()

uk_noresm_hirham = nc.Dataset('uk/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_DMI-HIRHAM5_v3_day_all.nc')
sund_uk_noresm_hirham = uk_noresm_hirham.variables['sund'][:,:,:]
uk_noresm_hirham.close()

uk_noresm_racmo = nc.Dataset('uk/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_KNMI-RACMO22E_v1_day_all.nc')
sund_uk_noresm_racmo = uk_noresm_racmo.variables['sund'][:,:,:]
uk_noresm_racmo.close()

uk_noresm_rca = nc.Dataset('uk/annual/sund_EUR-11_NCC-NorESM1-M_rcp85_r1i1p1_SMHI-RCA4_v1_day_all.nc')
sund_uk_noresm_rca = uk_noresm_rca.variables['sund'][:,:,:]
uk_noresm_rca.close()

variab = ['sund']
variab = variab * 130
sites= ['uk']
sites = sites* 130

label_models = ['cerfacs_hirham','cerfacs_rca','ichec_hirham','ichec_racmo','ichec_rca','mpi_hiram','mpi_rca','noresm_hirham','norems_racmo','noresm_rca','year']

len_yrs= len(sund_uk_cerfacs_hirham)
no_yrs = np.arange(0,len_yrs)
annual_sund_uk = np.zeros([len_yrs,11])
for i in no_yrs:
    annual_sund_uk[i,0] = np.mean(sund_uk_cerfacs_hirham[i,:,:])
    annual_sund_uk[i,1] = np.mean(sund_uk_cerfacs_rca[i,:,:])
    annual_sund_uk[i,2] = np.mean(sund_uk_ichec_hirham[i,:,:])
    annual_sund_uk[i,3] = np.mean(sund_uk_ichec_racmo[i,:,:])
    annual_sund_uk[i,4] = np.mean(sund_uk_ichec_rca[i,:,:])
    annual_sund_uk[i,5] = np.mean(sund_uk_mpi_hirham[i,:,:])
    annual_sund_uk[i,6] = np.mean(sund_uk_mpi_rca[i,:,:])
    annual_sund_uk[i,7] = np.mean(sund_uk_noresm_hirham[i,:,:])
    annual_sund_uk[i,8] = np.mean(sund_uk_noresm_racmo[i,:,:])
    annual_sund_uk[i,9] = np.mean(sund_uk_noresm_rca[i,:,:])
annual_sund_uk= annual_sund_uk/3600
annual_sund_uk = np.around(annual_sund_uk,decimals=2)

yrs = no_yrs+1971
annual_sund_uk[:,10] = yrs
ax=plt.gca()
figure(figsize=(14, 8), dpi=100)
plt.plot(yrs,annual_sund_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
plt.plot(yrs,annual_sund_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
plt.plot(yrs,annual_sund_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
plt.plot(yrs,annual_sund_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
plt.plot(yrs,annual_sund_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
plt.plot(yrs,annual_sund_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
plt.plot(yrs,annual_sund_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
plt.plot(yrs,annual_sund_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
plt.plot(yrs,annual_sund_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
plt.plot(yrs,annual_sund_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
plt.ylabel('Mean daily sunshine hours')
plt.title('UK')

df_annual_sund_uk = pd.DataFrame(annual_sund_uk, columns = label_models)
df_annual_sund_uk['var']=variab
df_annual_sund_uk['site']=sites

df_all = pd.concat([df_all,df_annual_sund_uk],ignore_index=True, axis=0)
df_all.to_csv('C:/Users/epz/Desktop/UEF/PET/CMs/df_all_annual.csv',index=False)

plt.legend(loc='lower right')
plt.xlim(1970,2100)

plt.grid(True)
plt.show
plt.savefig('annual_sund_uk.png',dpi=300)

"""ASSESSMENT OF THE UNCERTAINTIES OF CLIMATE MODEL ELEVATION

TO ASSESS:
    
    MEAN OF THE ELEVATIONS IN THE CMS AND RANGE
    
"""

import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import scipy.stats as stats
from scipy.stats import gamma
import netCDF4 as nc 
import csv
import os

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/orog/orog_range.nc')# the rcm in the historical period
#lat_bnd_rcm_at = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_at = rcm.variables['lon_bnds'][:]
lat_rcm_all = rcm.variables['lat'][:]
lon_rcm_all = rcm.variables['lon'][:]
orog_rcm_all = rcm.variables['orog'][:]


centroids_all = np.zeros([412,424,2])
orog_all = orog_rcm_all
x_s = np.arange(0,412)
y_s = np.arange(0,424)



for i in x_s:
    for ii in y_s:
        centroids_all[i,ii,0]=lat_rcm_all[i,ii]
        centroids_all[i,ii,1]=lon_rcm_all[i,ii]
        

fig= plt.figure(figsize=(20,20))
fontsize=20

plt.scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain')
plt.colorbar()
plt.show()

rcm.close()


rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_at.nc')# the rcm in the historical period
#lat_bnd_rcm_at = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_at = rcm.variables['lon_bnds'][:]
lat_rcm_at = rcm.variables['lat'][:]
lon_rcm_at = rcm.variables['lon'][:]

centroids_at = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_at[i,ii,0]=lat_rcm_at[i,ii]
        centroids_at[i,ii,1]=lon_rcm_at[i,ii]
        


rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_sp.nc')# the rcm in the historical period
#lat_bnd_rcm_at = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_at = rcm.variables['lon_bnds'][:]
lat_rcm_sp = rcm.variables['lat'][:]
lon_rcm_sp = rcm.variables['lon'][:]

centroids_sp = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_sp[i,ii,0]=lat_rcm_sp[i,ii]
        centroids_sp[i,ii,1]=lon_rcm_sp[i,ii]

rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_uk.nc')# the rcm in the historical period
#lat_bnd_rcm_at = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_at = rcm.variables['lon_bnds'][:]
lat_rcm_uk = rcm.variables['lat'][:]
lon_rcm_uk = rcm.variables['lon'][:]

centroids_uk = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_uk[i,ii,0]=lat_rcm_uk[i,ii]
        centroids_uk[i,ii,1]=lon_rcm_uk[i,ii]
        
rcm.close()


rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_dk.nc')# the rcm in the historical period
#lat_bnd_rcm_at = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_at = rcm.variables['lon_bnds'][:]
lat_rcm_dk = rcm.variables['lat'][:]
lon_rcm_dk = rcm.variables['lon'][:]

centroids_dk = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_dk[i,ii,0]=lat_rcm_dk[i,ii]
        centroids_dk[i,ii,1]=lon_rcm_dk[i,ii]
        
rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_fi.nc')# the rcm in the historical period
#lat_bnd_rcm_fi = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_fi = rcm.variables['lon_bnds'][:]
lat_rcm_fi = rcm.variables['lat'][:]
lon_rcm_fi = rcm.variables['lon'][:]

centroids_fi = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_fi[i,ii,0]=lat_rcm_fi[i,ii]
        centroids_fi[i,ii,1]=lon_rcm_fi[i,ii]
        
rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_gr.nc')# the rcm in the historical period
#lat_bnd_rcm_gr = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_gr = rcm.variables['lon_bnds'][:]
lat_rcm_gr = rcm.variables['lat'][:]
lon_rcm_gr = rcm.variables['lon'][:]

centroids_gr = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_gr[i,ii,0]=lat_rcm_gr[i,ii]
        centroids_gr[i,ii,1]=lon_rcm_gr[i,ii]

rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_ro.nc')# the rcm in the historical period
#lat_bnd_rcm_gr = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_gr = rcm.variables['lon_bnds'][:]
lat_rcm_ro = rcm.variables['lat'][:]
lon_rcm_ro = rcm.variables['lon'][:]

centroids_ro = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_ro[i,ii,0]=lat_rcm_ro[i,ii]
        centroids_ro[i,ii,1]=lon_rcm_ro[i,ii]
        
rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_dl.nc')# the rcm in the historical period
#lat_bnd_rcm_gr = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_gr = rcm.variables['lon_bnds'][:]
lat_rcm_dl = rcm.variables['lat'][:]
lon_rcm_dl = rcm.variables['lon'][:]

centroids_dl = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_dl[i,ii,0]=lat_rcm_dl[i,ii]
        centroids_dl[i,ii,1]=lon_rcm_dl[i,ii]

rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_fr.nc')# the rcm in the historical period
#lat_bnd_rcm_gr = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_gr = rcm.variables['lon_bnds'][:]
lat_rcm_fr = rcm.variables['lat'][:]
lon_rcm_fr = rcm.variables['lon'][:]

centroids_fr = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_fr[i,ii,0]=lat_rcm_fr[i,ii]
        centroids_fr[i,ii,1]=lon_rcm_fr[i,ii]
        
rcm.close()

rcm = nc.Dataset('C:/Users/epz/Desktop/UEF/PET/CMs/reference_map_it.nc')# the rcm in the historical period
#lat_bnd_rcm_gr = rcm.variables['lat_bnds'][:]
#lon_bnd_rcm_gr = rcm.variables['lon_bnds'][:]
lat_rcm_it = rcm.variables['lat'][:]
lon_rcm_it = rcm.variables['lon'][:]

centroids_it = np.zeros([6,6,2])

x_s = np.arange(0,6)
y_s = np.arange(0,6)



for i in x_s:
    for ii in y_s:
        centroids_it[i,ii,0]=lat_rcm_it[i,ii]
        centroids_it[i,ii,1]=lon_rcm_it[i,ii]
        
rcm.close()

font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 22}

fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
plt.scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain')
plt.colorbar()
plt.scatter(centroids_at[:,:,1],centroids_at[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_dk[:,:,1],centroids_dk[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_sp[:,:,1],centroids_sp[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_uk[:,:,1],centroids_uk[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_ro[:,:,1],centroids_ro[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_gr[:,:,1],centroids_gr[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_fi[:,:,1],centroids_fi[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_it[:,:,1],centroids_it[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_fr[:,:,1],centroids_fr[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.scatter(centroids_dl[:,:,1],centroids_dl[:,:,0],10,marker='s',edgecolors='r',facecolors='none')
plt.text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
plt.text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
plt.text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
plt.text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
plt.text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
plt.text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
plt.text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
plt.text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
plt.text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
plt.text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
plt.text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
plt.ylim(34,69)
plt.xlim(-15,38)
plt.show()




######################
### 2 x2 plot   #####
#######################

#### AT ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([45,50])
axs[0,0].set_xlim([8,18])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_at[:,:,1],centroids_at[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
axs[0,0].text(12.5,47.5,'AT',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -AT-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('AT')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('AT')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_at[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_at[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('AT')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_at.tiff', dpi=200) 


####    DK ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([53,59])
axs[0,0].set_xlim([4,14])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_dk[:,:,1],centroids_dk[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -DK-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('DK')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('DK')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_dk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('DK')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_dk.tiff', dpi=200) 


####    DL ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([45,51])
axs[0,0].set_xlim([3,13])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_dl[:,:,1],centroids_dl[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -DL-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('DL')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('DL')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_dl[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_dl[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('DL')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_dl.tiff', dpi=200) 



####    FI ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([56,66])
axs[0,0].set_xlim([24,34])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_fi[:,:,1],centroids_fi[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -FI-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('FI')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('FI')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_fi[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fi[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('FI')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_fi.tiff', dpi=200) 


####    FR ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([42,48])
axs[0,0].set_xlim([-6,6])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_fr[:,:,1],centroids_fr[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -FR-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('FR')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('FR')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_fr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_fr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('FR')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_fr.tiff', dpi=200) 


####  GR ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([30,40])
axs[0,0].set_xlim([20,30])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_gr[:,:,1],centroids_gr[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -GR-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('GR')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('GR')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_gr[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_gr[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('GR')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_gr.tiff', dpi=200) 


####    IT ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([37,43])
axs[0,0].set_xlim([4,14])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_it[:,:,1],centroids_it[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -IT-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('IT')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('IT')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_it[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_it[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('IT')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_it.tiff', dpi=200) 


####    RO ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([42,50])
axs[0,0].set_xlim([24,34])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_ro[:,:,1],centroids_ro[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -RO-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('RO')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('RO')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_ro[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_ro[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('RO')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_ro.tiff', dpi=200) 


####    SP ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([39,45])
axs[0,0].set_xlim([-6,6])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_sp[:,:,1],centroids_sp[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -SP-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('SP')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('SP')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_sp[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_sp[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('SP')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_sp.tiff', dpi=200) 


####    UK ####


fig, axs = plt.subplots(2, 2,figsize=(30,20) )
fontsize=20
plt.rc('font', **font)
z1_plot = axs[0,0].scatter(centroids_all[:,:,1],centroids_all[:,:,0],c=orog_all,cmap='terrain',marker='s', s = 160)
axs[0,0].set_ylim([50,55])
axs[0,0].set_xlim([-6,6])
plt.colorbar(z1_plot,ax=axs[0,0])
axs[0,0].scatter(centroids_uk[:,:,1],centroids_uk[:,:,0],10,marker='.',edgecolors='r',facecolors='none')
#axs[0,0].text(12.5,47.5,'at',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8,56.6,'dk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(8.8,40.5,'it',fontsize=20,fontweight='bold', color='red')
##axs[0,0].text(24.2,35.8,'gr',fontsize=20,fontweight='bold', color='red')
axs[0,0].text(-2,52.3,'uk',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,42.7,'sp',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.4,45.8,'ro',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(28.3,62.2,'fi',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(7,48.2,'dl',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(-0.8,45.8,'fr',fontsize=20,fontweight='bold', color='red')
#axs[0,0].text(40.5,33.3,'Range (m)',fontsize=20,fontweight='bold', color='black')
axs[0, 0].set_title('Elevation bias (range in meters) -UK-')
axs[0, 0].set_xlabel('Longitude')
axs[0, 0].set_ylabel('Latitude')
axs[0, 1].plot(yrs,annual_tas_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[0, 1].plot(yrs,annual_tas_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[0,1].set_title('UK')
#axs[0,1].legend(loc='lower right')
axs[0,1].set_xlim(1970,2100)
axs[0,1].grid(True)
axs[0, 1].set_xlabel('Year')
axs[0, 1].set_ylabel('Annual mean temperature (Celsius)')
axs[1, 0].set_xlabel('Year')
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 0].plot(yrs,annual_sfcWind_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1, 0].set_ylabel('Annual mean near-surface wind velocity (m/s)')
axs[1, 0].set_title('UK')
#axs[1, 0].legend(loc='lower right')
axs[1, 0].set_xlim(1970,2100)
axs[1, 0].grid(True)
axs[1, 1].plot(yrs,annual_hurs_uk[:,0],label=label_models[0],color='blue',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,1],label=label_models[1],color='blue',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,2],label=label_models[2],color='green',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,3],label=label_models[3],color='green',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,4],label=label_models[4],color='green',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,5],label=label_models[5],color='red',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,6],label=label_models[6],color='red',marker='+',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,7],label=label_models[7],color='black',marker='s',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,8],label=label_models[8],color='black',marker='x',markevery=5)
axs[1, 1].plot(yrs,annual_hurs_uk[:,9],label=label_models[9],color='black',marker='+',markevery=5)
axs[1,1].set_ylabel('Relative humidity (%)')
axs[1,1].set_title('UK')
axs[1,1].legend(loc='lower right',fontsize=9)
axs[1,1].set_xlim(1970,2100)
axs[1, 1].set_xlabel('Year')
axs[1,1].grid(True)
fig.savefig('C:/Users/epz/Desktop/UEF/PET/CMs/elev_bias_annual_ts_uk.tiff', dpi=200) 

# Saving the data outputs


headers = ['YEAR','CERFACRS-HIRHAM','CERFACS-RCA','ICHEC-HIRHAM','ICHEC-RACMO','ICHEC-RCA','MPI-HIRHAM','MPI-RCA','NORESM-HIRHAM','NORESM-RACMO','NORESM-RCA','SITE']
dash_yrs = np.arange(1971,2101)

site_at = np.zeros([130])
site_at = site_at.astype('str')
for i in no_yrs:
    site_at[i]='AT'
annual_tas_at_new = np.column_stack([dash_yrs,annual_tas_at,site_at])

site_dk = np.zeros([130])
site_dk = site_dk.astype('str')
for i in no_yrs:
    site_dk[i]='DK'
annual_tas_dk_new = np.column_stack([dash_yrs,annual_tas_dk,site_dk])

site_dl = np.zeros([130])
site_dl = site_dl.astype('str')
for i in no_yrs:
    site_dl[i]='DL'
annual_tas_dl_new = np.column_stack([dash_yrs,annual_tas_dl,site_dl])

site_fi = np.zeros([130])
site_fi = site_fi.astype('str')
for i in no_yrs:
    site_fi[i]='FI'
annual_tas_fi_new = np.column_stack([dash_yrs,annual_tas_fi,site_fi])

site_fr = np.zeros([130])
site_fr = site_fr.astype('str')
for i in no_yrs:
    site_fr[i]='FR'
annual_tas_fr_new = np.column_stack([dash_yrs,annual_tas_fr,site_fr])

site_gr = np.zeros([130])
site_gr = site_gr.astype('str')
for i in no_yrs:
    site_gr[i]='GR'
annual_tas_gr_new = np.column_stack([dash_yrs,annual_tas_gr,site_gr])

site_it = np.zeros([130])
site_it = site_it.astype('str')
for i in no_yrs:
    site_it[i]='IT'
annual_tas_it_new = np.column_stack([dash_yrs,annual_tas_it,site_it])

site_ro = np.zeros([130])
site_ro = site_ro.astype('str')
for i in no_yrs:
    site_ro[i]='RO'
annual_tas_ro_new = np.column_stack([dash_yrs,annual_tas_ro,site_ro])

site_sp = np.zeros([130])
site_sp = site_sp.astype('str')
for i in no_yrs:
    site_sp[i]='SP'
annual_tas_sp_new = np.column_stack([dash_yrs,annual_tas_sp,site_sp])

site_uk = np.zeros([130])
site_uk = site_uk.astype('str')
for i in no_yrs:
    site_uk[i]='UK'
annual_tas_uk_new = np.column_stack([dash_yrs,annual_tas_uk,site_uk])

annual_tas_all = np.append(annual_tas_at_new,annual_tas_dk_new, axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_dl_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_fi_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_fr_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_gr_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_it_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_ro_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_sp_new,axis=0)
annual_tas_all = np.append(annual_tas_all,annual_tas_uk_new,axis=0)
    

np.savetxt('C:/Users/epz/Desktop/UEF/PET/Python/Outputs/annual_tas_all.csv',annual_tas_all, fmt='%s', delimiter=',', header=', '.join(headers), comments='')


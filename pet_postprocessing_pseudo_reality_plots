"""
Pet plots for post processing, to run after post_processing_pseudo_reality

Opens the npy files created by post_processing_pseudo_reality.npy

Per site:

Five plots

1. Mean annual pet timeseries
2. Bias for corrected models compared to benchmarked model for each pet
    2.1 Mean bias for each model considering all pet methods
3. SNR for 2
4. 


"""   

import pandas as pd
import numpy as np
import netCDF4 as nc 
import math
import datetime
import os
import matplotlib.pyplot as plt
from matplotlib.patches import Patch
from matplotlib.lines import Line2D


def roundup(x):
    return int(math.ceil(x / 100.0)) * 100

def rounddown(x):
    return int(math.floor(x / 100.0)) * 100



site_list = ['at','dk','dl','fi','fr','gr','it','ro','sp','uk']
for i in np.arange(1,10): 
    site_n=site_list[i]
    print(site_n)

    hamon_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_hamon_all.npy')
    har_sam_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_har_sam_all.npy')
    hargreaves_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_hargreaves_all.npy')
    jen_hai_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_jen_hai_all.npy')
    makkink_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_makkink_all.npy')
    oudin_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_oudin_all.npy')
    penman_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_penman_all.npy')
    penman_monteith_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_penman_monteith_all.npy')
    pri_tay_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_pri_tay_all.npy')
    turc_annual = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/delta/corrected/pet/both_annual_pet_turc_all.npy')
    
    models = ['Cerfacs-Hirham','Cerfacs-RCA','ICHEC-RCA','ICHEC-Hirman','ICHEC-Racmo','MPI-Hirham','MPI-RCA','NorESM-Hirham','NorESM-Racmo','NorESM-RCA']


    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_hamon = rounddown(np.min(hamon_annual))
    ymax_hamon = roundup(np.max(hamon_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,hamon_annual[:,:,0])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,hamon_annual[:,:,1])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,hamon_annual[:,:,2])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,hamon_annual[:,:,3])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,hamon_annual[:,:,4])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,hamon_annual[:,:,5])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,hamon_annual[:,:,6])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,hamon_annual[:,:,7])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,hamon_annual[:,:,8])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,hamon_annual[:,:,9])
    plt.ylim(ymin_hamon,ymax_hamon)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: Hamon')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: Hamon')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: Hamon')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: Hamon')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: Hamon')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: Hamon')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: Hamon')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: Hamon')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: Hamon')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: Hamon')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_hamon_'+site_n+'.png')
    
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_har_sam = rounddown(np.min(har_sam_annual))
    ymax_har_sam = roundup(np.max(har_sam_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,har_sam_annual[:,:,0])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,har_sam_annual[:,:,1])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,har_sam_annual[:,:,2])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,har_sam_annual[:,:,3])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,har_sam_annual[:,:,4])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,har_sam_annual[:,:,5])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,har_sam_annual[:,:,6])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,har_sam_annual[:,:,7])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,har_sam_annual[:,:,8])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,har_sam_annual[:,:,9])
    plt.ylim(ymin_har_sam,ymax_har_sam)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: har_sam')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: har_sam')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: har_sam')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: har_sam')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: har_sam')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: har_sam')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: har_sam')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: har_sam')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: har_sam')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: har_sam')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_har_sam_'+site_n+'.png')
    
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_hargreaves = rounddown(np.min(hargreaves_annual))
    ymax_hargreaves = roundup(np.max(hargreaves_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,hargreaves_annual[:,:,0])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,hargreaves_annual[:,:,1])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,hargreaves_annual[:,:,2])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,hargreaves_annual[:,:,3])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,hargreaves_annual[:,:,4])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,hargreaves_annual[:,:,5])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,hargreaves_annual[:,:,6])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,hargreaves_annual[:,:,7])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,hargreaves_annual[:,:,8])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,hargreaves_annual[:,:,9])
    plt.ylim(ymin_hargreaves,ymax_hargreaves)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: hargreaves')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: hargreaves')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: hargreaves')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: hargreaves')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: hargreaves')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: hargreaves')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: hargreaves')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: hargreaves')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: hargreaves')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: hargreaves')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_hargreaves_'+site_n+'.png')
    
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_jen_hai = rounddown(np.min(jen_hai_annual))
    ymax_jen_hai = roundup(np.max(jen_hai_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,jen_hai_annual[:,:,0])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,jen_hai_annual[:,:,1])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,jen_hai_annual[:,:,2])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,jen_hai_annual[:,:,3])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,jen_hai_annual[:,:,4])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,jen_hai_annual[:,:,5])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,jen_hai_annual[:,:,6])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,jen_hai_annual[:,:,7])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,jen_hai_annual[:,:,8])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,jen_hai_annual[:,:,9])
    plt.ylim(ymin_jen_hai,ymax_jen_hai)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: jen_hai')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: jen_hai')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: jen_hai')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: jen_hai')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: jen_hai')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: jen_hai')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: jen_hai')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: jen_hai')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: jen_hai')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: jen_hai')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_jen_hai_'+site_n+'.png')
    
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_makkink = rounddown(np.min(makkink_annual))
    ymax_makkink = roundup(np.max(makkink_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,makkink_annual[:,:,0])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,makkink_annual[:,:,1])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,makkink_annual[:,:,2])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,makkink_annual[:,:,3])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,makkink_annual[:,:,4])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,makkink_annual[:,:,5])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,makkink_annual[:,:,6])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,makkink_annual[:,:,7])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,makkink_annual[:,:,8])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,makkink_annual[:,:,9])
    plt.ylim(ymin_makkink,ymax_makkink)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: makkink')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: makkink')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: makkink')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: makkink')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: makkink')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: makkink')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: makkink')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: makkink')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: makkink')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: makkink')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_makkink_'+site_n+'.png')
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_oudin = rounddown(np.min(oudin_annual))
    ymax_oudin = roundup(np.max(oudin_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,oudin_annual[:,:,0])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,oudin_annual[:,:,1])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,oudin_annual[:,:,2])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,oudin_annual[:,:,3])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,oudin_annual[:,:,4])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,oudin_annual[:,:,5])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,oudin_annual[:,:,6])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,oudin_annual[:,:,7])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,oudin_annual[:,:,8])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,oudin_annual[:,:,9])
    plt.ylim(ymin_oudin,ymax_oudin)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: oudin')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: oudin')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: oudin')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: oudin')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: oudin')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: oudin')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: oudin')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: oudin')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: oudin')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: oudin')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_oudin_'+site_n+'.png')
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_penman = rounddown(np.min(penman_annual))
    ymax_penman = roundup(np.max(penman_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,penman_annual[:,:,0])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,penman_annual[:,:,1])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,penman_annual[:,:,2])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,penman_annual[:,:,3])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,penman_annual[:,:,4])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,penman_annual[:,:,5])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,penman_annual[:,:,6])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,penman_annual[:,:,7])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,penman_annual[:,:,8])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,penman_annual[:,:,9])
    plt.ylim(ymin_penman,ymax_penman)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: penman')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: penman')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: penman')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: penman')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: penman')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: penman')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: penman')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: penman')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: penman')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: penman')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_penman_'+site_n+'.png')
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_penman_monteith = rounddown(np.min(penman_monteith_annual))
    ymax_penman_monteith = roundup(np.max(penman_monteith_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,penman_monteith_annual[:,:,0])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,penman_monteith_annual[:,:,1])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,penman_monteith_annual[:,:,2])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,penman_monteith_annual[:,:,3])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,penman_monteith_annual[:,:,4])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,penman_monteith_annual[:,:,5])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,penman_monteith_annual[:,:,6])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,penman_monteith_annual[:,:,7])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,penman_monteith_annual[:,:,8])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,penman_monteith_annual[:,:,9])
    plt.ylim(ymin_penman_monteith,ymax_penman_monteith)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: penman_monteith')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: penman_monteith')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: penman_monteith')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: penman_monteith')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: penman_monteith')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: penman_monteith')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: penman_monteith')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: penman_monteith')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: penman_monteith')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: penman_monteith')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_penman_monteith_'+site_n+'.png')
    
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_pri_tay = rounddown(np.min(pri_tay_annual))
    ymax_pri_tay = roundup(np.max(pri_tay_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,pri_tay_annual[:,:,0])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,pri_tay_annual[:,:,1])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,pri_tay_annual[:,:,2])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,pri_tay_annual[:,:,3])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,pri_tay_annual[:,:,4])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,pri_tay_annual[:,:,5])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,pri_tay_annual[:,:,6])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,pri_tay_annual[:,:,7])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,pri_tay_annual[:,:,8])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,pri_tay_annual[:,:,9])
    plt.ylim(ymin_pri_tay,ymax_pri_tay)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: pri_tay')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: pri_tay')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: pri_tay')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: pri_tay')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: pri_tay')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: pri_tay')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: pri_tay')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: pri_tay')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: pri_tay')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: pri_tay')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_pri_tay_'+site_n+'.png')
    
    yrs = np.arange(1976,2101)
    font = {'family' : 'normal',
    'weight' : 'normal',
    'size'   : 22}
    fig= plt.figure(figsize=(40,20))
    fontsize=20
    plt.rc('font', **font)
    ymin_turc = rounddown(np.min(turc_annual))
    ymax_turc = roundup(np.max(turc_annual))
    plt.subplot(5,2,1)
    plt.plot(yrs,turc_annual[:,:,0])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,2)
    plt.plot(yrs,turc_annual[:,:,1])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,3)
    plt.plot(yrs,turc_annual[:,:,2])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,4)
    plt.plot(yrs,turc_annual[:,:,3])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,5)
    plt.plot(yrs,turc_annual[:,:,4])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,6)
    plt.plot(yrs,turc_annual[:,:,5])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,7)
    plt.plot(yrs,turc_annual[:,:,6])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,8)
    plt.plot(yrs,turc_annual[:,:,7])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,9)
    plt.plot(yrs,turc_annual[:,:,8])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.subplot(5,2,10)
    plt.plot(yrs,turc_annual[:,:,9])
    plt.ylim(ymin_turc,ymax_turc)
    plt.ylabel('Annual PET (mm)')
    plt.legend(models)
    plt.figtext(0.15,0.85, 'BM - '+site_n+' - 1: turc')
    plt.figtext(0.58,0.85, 'BM - '+site_n+' - 2: turc')
    plt.figtext(0.15,0.68, 'BM - '+site_n+' - 3: turc')
    plt.figtext(0.58,0.68, 'BM - '+site_n+' - 4: turc')
    plt.figtext(0.15,0.52, 'BM - '+site_n+' - 5: turc')
    plt.figtext(0.58,0.52, 'BM - '+site_n+' - 6: turc')
    plt.figtext(0.15,0.37, 'BM - '+site_n+' - 7: turc')
    plt.figtext(0.58,0.37, 'BM - '+site_n+' - 8: turc')
    plt.figtext(0.15,0.21, 'BM - '+site_n+' - 9: turc')
    plt.figtext(0.58,0.21, 'BM - '+site_n+' - 10: turc')
    plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/annual_timeseries_pseudo_turc_'+site_n+'.png')
    


    period_means_hamon = np.zeros([4,10,10])
    period_changes_hamon = np.zeros([3,10,10])
    
    period_means_har_sam = np.zeros([4,10,10])
    period_changes_har_sam = np.zeros([3,10,10])
    
    period_means_hargreaves = np.zeros([4,10,10])
    period_changes_hargreaves = np.zeros([3,10,10])
    
    period_means_jen_hai = np.zeros([4,10,10])
    period_changes_jen_hai = np.zeros([3,10,10])
    
    period_means_makkink = np.zeros([4,10,10])
    period_changes_makkink = np.zeros([3,10,10])
    
    period_means_oudin = np.zeros([4,10,10])
    period_changes_oudin = np.zeros([3,10,10])
    
    period_means_penman = np.zeros([4,10,10])
    period_changes_penman = np.zeros([3,10,10])
    
    period_means_penman_monteith = np.zeros([4,10,10])
    period_changes_penman_monteith = np.zeros([3,10,10])
    
    period_means_pri_tay = np.zeros([4,10,10])
    period_changes_pri_tay = np.zeros([3,10,10])
    
    period_means_turc = np.zeros([4,10,10])
    period_changes_turc = np.zeros([3,10,10])
    
    
    
    for xx in np.arange(0,10):
        for xxx in np.arange(0,10):
            period_hamon = hamon_annual[:,:,xx]
            period_hamon_ref=period_hamon[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_hamon[0,xxx,xx] = np.mean(period_hamon_ref[:,xxx])
            period_hamon_near=period_hamon[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_hamon[1,xxx,xx] = np.mean(period_hamon_near[:,xxx])
            period_hamon_mid=period_hamon[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_hamon[2,xxx,xx] = np.mean(period_hamon_mid[:,xxx])
            period_hamon_far=period_hamon[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_hamon[3,xxx,xx] = np.mean(period_hamon_far[:,xxx])
            
            period_har_sam = har_sam_annual[:,:,xx]
            period_har_sam_ref=period_har_sam[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_har_sam[0,xxx,xx] = np.mean(period_har_sam_ref[:,xxx])
            period_har_sam_near=period_har_sam[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_har_sam[1,xxx,xx] = np.mean(period_har_sam_near[:,xxx])
            period_har_sam_mid=period_har_sam[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_har_sam[2,xxx,xx] = np.mean(period_har_sam_mid[:,xxx])
            period_har_sam_far=period_har_sam[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_har_sam[3,xxx,xx] = np.mean(period_har_sam_far[:,xxx])
            
            period_hargreaves = hargreaves_annual[:,:,xx]
            period_hargreaves_ref=period_hargreaves[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_hargreaves[0,xxx,xx] = np.mean(period_hargreaves_ref[:,xxx])
            period_hargreaves_near=period_hargreaves[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_hargreaves[1,xxx,xx] = np.mean(period_hargreaves_near[:,xxx])
            period_hargreaves_mid=period_hargreaves[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_hargreaves[2,xxx,xx] = np.mean(period_hargreaves_mid[:,xxx])
            period_hargreaves_far=period_hargreaves[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_hargreaves[3,xxx,xx] = np.mean(period_hargreaves_far[:,xxx])
            
            period_jen_hai = jen_hai_annual[:,:,xx]
            period_jen_hai_ref=period_jen_hai[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_jen_hai[0,xxx,xx] = np.mean(period_jen_hai_ref[:,xxx])
            period_jen_hai_near=period_jen_hai[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_jen_hai[1,xxx,xx] = np.mean(period_jen_hai_near[:,xxx])
            period_jen_hai_mid=period_jen_hai[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_jen_hai[2,xxx,xx] = np.mean(period_jen_hai_mid[:,xxx])
            period_jen_hai_far=period_jen_hai[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_jen_hai[3,xxx,xx] = np.mean(period_jen_hai_far[:,xxx])
            
            period_makkink = makkink_annual[:,:,xx]
            period_makkink_ref=period_makkink[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_makkink[0,xxx,xx] = np.mean(period_makkink_ref[:,xxx])
            period_makkink_near=period_makkink[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_makkink[1,xxx,xx] = np.mean(period_makkink_near[:,xxx])
            period_makkink_mid=period_makkink[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_makkink[2,xxx,xx] = np.mean(period_makkink_mid[:,xxx])
            period_makkink_far=period_makkink[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_makkink[3,xxx,xx] = np.mean(period_makkink_far[:,xxx])
            
            period_oudin = oudin_annual[:,:,xx]
            period_oudin_ref=period_oudin[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_oudin[0,xxx,xx] = np.mean(period_oudin_ref[:,xxx])
            period_oudin_near=period_oudin[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_oudin[1,xxx,xx] = np.mean(period_oudin_near[:,xxx])
            period_oudin_mid=period_oudin[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_oudin[2,xxx,xx] = np.mean(period_oudin_mid[:,xxx])
            period_oudin_far=period_oudin[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_oudin[3,xxx,xx] = np.mean(period_oudin_far[:,xxx])
            
            period_penman = penman_annual[:,:,xx]
            period_penman_ref=period_penman[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_penman[0,xxx,xx] = np.mean(period_penman_ref[:,xxx])
            period_penman_near=period_penman[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_penman[1,xxx,xx] = np.mean(period_penman_near[:,xxx])
            period_penman_mid=period_penman[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_penman[2,xxx,xx] = np.mean(period_penman_mid[:,xxx])
            period_penman_far=period_penman[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_penman[3,xxx,xx] = np.mean(period_penman_far[:,xxx])
            
            period_penman_monteith = penman_monteith_annual[:,:,xx]
            period_penman_monteith_ref=period_penman_monteith[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_penman_monteith[0,xxx,xx] = np.mean(period_penman_monteith_ref[:,xxx])
            period_penman_monteith_near=period_penman_monteith[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_penman_monteith[1,xxx,xx] = np.mean(period_penman_monteith_near[:,xxx])
            period_penman_monteith_mid=period_penman_monteith[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_penman_monteith[2,xxx,xx] = np.mean(period_penman_monteith_mid[:,xxx])
            period_penman_monteith_far=period_penman_monteith[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_penman_monteith[3,xxx,xx] = np.mean(period_penman_monteith_far[:,xxx])
            
            period_pri_tay = pri_tay_annual[:,:,xx]
            period_pri_tay_ref=period_pri_tay[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_pri_tay[0,xxx,xx] = np.mean(period_pri_tay_ref[:,xxx])
            period_pri_tay_near=period_pri_tay[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_pri_tay[1,xxx,xx] = np.mean(period_pri_tay_near[:,xxx])
            period_pri_tay_mid=period_pri_tay[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_pri_tay[2,xxx,xx] = np.mean(period_pri_tay_mid[:,xxx])
            period_pri_tay_far=period_pri_tay[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_pri_tay[3,xxx,xx] = np.mean(period_pri_tay_far[:,xxx])
            
            period_turc = turc_annual[:,:,xx]
            period_turc_ref=period_turc[(yrs >= 1976) & (yrs <= 2005)] 
            period_means_turc[0,xxx,xx] = np.mean(period_turc_ref[:,xxx])
            period_turc_near=period_turc[(yrs >= 2011) & (yrs <= 2040)] 
            period_means_turc[1,xxx,xx] = np.mean(period_turc_near[:,xxx])
            period_turc_mid=period_turc[(yrs >= 2041) & (yrs <= 2070)] 
            period_means_turc[2,xxx,xx] = np.mean(period_turc_mid[:,xxx])
            period_turc_far=period_turc[(yrs >= 2071) & (yrs <= 2100)] 
            period_means_turc[3,xxx,xx] = np.mean(period_turc_far[:,xxx])
      
                       
            
        
        for xxx in np.arange(0,10):
            #Near
            period_changes_hamon[0,xxx,xx] = 100*((period_means_hamon[1,xxx,xx]-period_means_hamon[0,xxx,xx])/period_means_hamon[0,xxx,xx])
            #Mid
            period_changes_hamon[1,xxx,xx] = 100*((period_means_hamon[2,xxx,xx]-period_means_hamon[0,xxx,xx])/period_means_hamon[0,xxx,xx])
            #Far
            period_changes_hamon[2,xxx,xx] = 100*((period_means_hamon[3,xxx,xx]-period_means_hamon[0,xxx,xx])/period_means_hamon[0,xxx,xx])
            
            #Near
            period_changes_har_sam[0,xxx,xx] = 100*((period_means_har_sam[1,xxx,xx]-period_means_har_sam[0,xxx,xx])/period_means_har_sam[0,xxx,xx])
            #Mid
            period_changes_har_sam[1,xxx,xx] = 100*((period_means_har_sam[2,xxx,xx]-period_means_har_sam[0,xxx,xx])/period_means_har_sam[0,xxx,xx])
            #Far
            period_changes_har_sam[2,xxx,xx] = 100*((period_means_har_sam[3,xxx,xx]-period_means_har_sam[0,xxx,xx])/period_means_har_sam[0,xxx,xx])
            
            #Near
            period_changes_hargreaves[0,xxx,xx] = 100*((period_means_hargreaves[1,xxx,xx]-period_means_hargreaves[0,xxx,xx])/period_means_hargreaves[0,xxx,xx])
            #Mid
            period_changes_hargreaves[1,xxx,xx] = 100*((period_means_hargreaves[2,xxx,xx]-period_means_hargreaves[0,xxx,xx])/period_means_hargreaves[0,xxx,xx])
            #Far
            period_changes_hargreaves[2,xxx,xx] = 100*((period_means_hargreaves[3,xxx,xx]-period_means_hargreaves[0,xxx,xx])/period_means_hargreaves[0,xxx,xx])
            
            #Near
            period_changes_jen_hai[0,xxx,xx] = 100*((period_means_jen_hai[1,xxx,xx]-period_means_jen_hai[0,xxx,xx])/period_means_jen_hai[0,xxx,xx])
            #Mid
            period_changes_jen_hai[1,xxx,xx] = 100*((period_means_jen_hai[2,xxx,xx]-period_means_jen_hai[0,xxx,xx])/period_means_jen_hai[0,xxx,xx])
            #Far
            period_changes_jen_hai[2,xxx,xx] = 100*((period_means_jen_hai[3,xxx,xx]-period_means_jen_hai[0,xxx,xx])/period_means_jen_hai[0,xxx,xx])
            
            #Near
            period_changes_makkink[0,xxx,xx] = 100*((period_means_makkink[1,xxx,xx]-period_means_makkink[0,xxx,xx])/period_means_makkink[0,xxx,xx])
            #Mid
            period_changes_makkink[1,xxx,xx] = 100*((period_means_makkink[2,xxx,xx]-period_means_makkink[0,xxx,xx])/period_means_makkink[0,xxx,xx])
            #Far
            period_changes_makkink[2,xxx,xx] = 100*((period_means_makkink[3,xxx,xx]-period_means_makkink[0,xxx,xx])/period_means_makkink[0,xxx,xx])
            
            #Near
            period_changes_oudin[0,xxx,xx] = 100*((period_means_oudin[1,xxx,xx]-period_means_oudin[0,xxx,xx])/period_means_oudin[0,xxx,xx])
            #Mid
            period_changes_oudin[1,xxx,xx] = 100*((period_means_oudin[2,xxx,xx]-period_means_oudin[0,xxx,xx])/period_means_oudin[0,xxx,xx])
            #Far
            period_changes_oudin[2,xxx,xx] = 100*((period_means_oudin[3,xxx,xx]-period_means_oudin[0,xxx,xx])/period_means_oudin[0,xxx,xx])
            
            #Near
            period_changes_penman[0,xxx,xx] = 100*((period_means_penman[1,xxx,xx]-period_means_penman[0,xxx,xx])/period_means_penman[0,xxx,xx])
            #Mid
            period_changes_penman[1,xxx,xx] = 100*((period_means_penman[2,xxx,xx]-period_means_penman[0,xxx,xx])/period_means_penman[0,xxx,xx])
            #Far
            period_changes_penman[2,xxx,xx] = 100*((period_means_penman[3,xxx,xx]-period_means_penman[0,xxx,xx])/period_means_penman[0,xxx,xx])
            
            #Near
            period_changes_penman_monteith[0,xxx,xx] = 100*((period_means_penman_monteith[1,xxx,xx]-period_means_penman_monteith[0,xxx,xx])/period_means_penman_monteith[0,xxx,xx])
            #Mid
            period_changes_penman_monteith[1,xxx,xx] = 100*((period_means_penman_monteith[2,xxx,xx]-period_means_penman_monteith[0,xxx,xx])/period_means_penman_monteith[0,xxx,xx])
            #Far
            period_changes_penman_monteith[2,xxx,xx] = 100*((period_means_penman_monteith[3,xxx,xx]-period_means_penman_monteith[0,xxx,xx])/period_means_penman_monteith[0,xxx,xx])
            
            #Near
            period_changes_pri_tay[0,xxx,xx] = 100*((period_means_pri_tay[1,xxx,xx]-period_means_pri_tay[0,xxx,xx])/period_means_pri_tay[0,xxx,xx])
            #Mid
            period_changes_pri_tay[1,xxx,xx] = 100*((period_means_pri_tay[2,xxx,xx]-period_means_pri_tay[0,xxx,xx])/period_means_pri_tay[0,xxx,xx])
            #Far
            period_changes_pri_tay[2,xxx,xx] = 100*((period_means_pri_tay[3,xxx,xx]-period_means_pri_tay[0,xxx,xx])/period_means_pri_tay[0,xxx,xx])
            
            #Near
            period_changes_turc[0,xxx,xx] = 100*((period_means_turc[1,xxx,xx]-period_means_turc[0,xxx,xx])/period_means_turc[0,xxx,xx])
            #Mid
            period_changes_turc[1,xxx,xx] = 100*((period_means_turc[2,xxx,xx]-period_means_turc[0,xxx,xx])/period_means_turc[0,xxx,xx])
            #Far
            period_changes_turc[2,xxx,xx] = 100*((period_means_turc[3,xxx,xx]-period_means_turc[0,xxx,xx])/period_means_turc[0,xxx,xx])
            
    period_changes_hamon_bias = np.zeros([3,10,10])
    period_changes_hamon_bias[period_changes_hamon_bias==0]=-np.nan
    period_changes_har_sam_bias = np.zeros([3,10,10])
    period_changes_har_sam_bias[period_changes_har_sam_bias==0]=-np.nan
    period_changes_hargreaves_bias = np.zeros([3,10,10])
    period_changes_hargreaves_bias[period_changes_hargreaves_bias==0]=-np.nan
    period_changes_jen_hai_bias = np.zeros([3,10,10])
    period_changes_jen_hai_bias[period_changes_jen_hai_bias==0]=-np.nan
    period_changes_makkink_bias = np.zeros([3,10,10])
    period_changes_makkink_bias[period_changes_makkink_bias==0]=-np.nan
    period_changes_oudin_bias = np.zeros([3,10,10])
    period_changes_oudin_bias[period_changes_oudin_bias==0]=-np.nan
    period_changes_penman_bias = np.zeros([3,10,10])
    period_changes_penman_bias[period_changes_penman_bias==0]=-np.nan
    period_changes_penman_monteith_bias = np.zeros([3,10,10])
    period_changes_penman_monteith_bias[period_changes_penman_monteith_bias==0]=-np.nan
    period_changes_pri_tay_bias = np.zeros([3,10,10])
    period_changes_pri_tay_bias[period_changes_pri_tay_bias==0]=-np.nan
    period_changes_turc_bias = np.zeros([3,10,10])
    period_changes_turc_bias[period_changes_turc_bias==0]=-np.nan
    
    for c in np.arange(0,10): # c represents the cth benchmark model
        for cc in np.arange(0,10): # represents the models that were corrected to match the benchmark model
            period_changes_hamon_bias[0,cc,c] = round((period_changes_hamon[0,c,c]-period_changes_hamon[0,cc,c]),1)
            period_changes_hamon_bias[1,cc,c] = round((period_changes_hamon[1,c,c]-period_changes_hamon[1,cc,c]),1)
            period_changes_hamon_bias[2,cc,c] = round((period_changes_hamon[2,c,c]-period_changes_hamon[2,cc,c]),1)       
            period_changes_har_sam_bias[0,cc,c] = round((period_changes_har_sam[0,c,c]-period_changes_har_sam[0,cc,c]),1)
            period_changes_har_sam_bias[1,cc,c] = round((period_changes_har_sam[1,c,c]-period_changes_har_sam[1,cc,c]),1)
            period_changes_har_sam_bias[2,cc,c] = round((period_changes_har_sam[2,c,c]-period_changes_har_sam[2,cc,c]),1) 
            period_changes_hargreaves_bias[0,cc,c] = round((period_changes_hargreaves[0,c,c]-period_changes_hargreaves[0,cc,c]),1)
            period_changes_hargreaves_bias[1,cc,c] = round((period_changes_hargreaves[1,c,c]-period_changes_hargreaves[1,cc,c]),1)
            period_changes_hargreaves_bias[2,cc,c] = round((period_changes_hargreaves[2,c,c]-period_changes_hargreaves[2,cc,c]),1)             
            period_changes_jen_hai_bias[0,cc,c] = round((period_changes_jen_hai[0,c,c]-period_changes_jen_hai[0,cc,c]),1)
            period_changes_jen_hai_bias[1,cc,c] = round((period_changes_jen_hai[1,c,c]-period_changes_jen_hai[1,cc,c]),1)
            period_changes_jen_hai_bias[2,cc,c] = round((period_changes_jen_hai[2,c,c]-period_changes_jen_hai[2,cc,c]),1)       
            period_changes_makkink_bias[0,cc,c] = round((period_changes_makkink[0,c,c]-period_changes_makkink[0,cc,c]),1)
            period_changes_makkink_bias[1,cc,c] = round((period_changes_makkink[1,c,c]-period_changes_makkink[1,cc,c]),1)
            period_changes_makkink_bias[2,cc,c] = round((period_changes_makkink[2,c,c]-period_changes_makkink[2,cc,c]),1)       
            period_changes_oudin_bias[0,cc,c] = round((period_changes_oudin[0,c,c]-period_changes_oudin[0,cc,c]),1)
            period_changes_oudin_bias[1,cc,c] = round((period_changes_oudin[1,c,c]-period_changes_oudin[1,cc,c]),1)
            period_changes_oudin_bias[2,cc,c] = round((period_changes_oudin[2,c,c]-period_changes_oudin[2,cc,c]),1)       
            period_changes_penman_bias[0,cc,c] = round((period_changes_penman[0,c,c]-period_changes_penman[0,cc,c]),1)
            period_changes_penman_bias[1,cc,c] = round((period_changes_penman[1,c,c]-period_changes_penman[1,cc,c]),1)
            period_changes_penman_bias[2,cc,c] = round((period_changes_penman[2,c,c]-period_changes_penman[2,cc,c]),1)       
            period_changes_penman_monteith_bias[0,cc,c] = round((period_changes_penman_monteith[0,c,c]-period_changes_penman_monteith[0,cc,c]),1)
            period_changes_penman_monteith_bias[1,cc,c] = round((period_changes_penman_monteith[1,c,c]-period_changes_penman_monteith[1,cc,c]),1)
            period_changes_penman_monteith_bias[2,cc,c] = round((period_changes_penman_monteith[2,c,c]-period_changes_penman_monteith[2,cc,c]),1)       
            period_changes_pri_tay_bias[0,cc,c] = round((period_changes_pri_tay[0,c,c]-period_changes_pri_tay[0,cc,c]),1)
            period_changes_pri_tay_bias[1,cc,c] = round((period_changes_pri_tay[1,c,c]-period_changes_pri_tay[1,cc,c]),1)
            period_changes_pri_tay_bias[2,cc,c] = round((period_changes_pri_tay[2,c,c]-period_changes_pri_tay[2,cc,c]),1)       
            period_changes_turc_bias[0,cc,c] = round((period_changes_turc[0,c,c]-period_changes_turc[0,cc,c]),1)
            period_changes_turc_bias[1,cc,c] = round((period_changes_turc[1,c,c]-period_changes_turc[1,cc,c]),1)
            period_changes_turc_bias[2,cc,c] = round((period_changes_turc[2,c,c]-period_changes_turc[2,cc,c]),1)       
            
    periods = ['Near','Mid','Far']
    CMs = ['1','2','3','4','5','6','7','8','9','10']
    
    min_period_changes_hamon_bias = np.min(period_changes_hamon_bias)
    max_period_changes_hamon_bias = np.max(period_changes_hamon_bias)
    min_period_changes_har_sam_bias = np.min(period_changes_har_sam_bias)
    max_period_changes_har_sam_bias = np.max(period_changes_har_sam_bias)
    min_period_changes_hargreaves_bias = np.min(period_changes_hargreaves_bias)
    max_period_changes_hargreaves_bias = np.max(period_changes_hargreaves_bias)
    min_period_changes_jen_hai_bias = np.min(period_changes_jen_hai_bias)
    max_period_changes_jen_hai_bias = np.max(period_changes_jen_hai_bias)
    min_period_changes_makkink_bias = np.min(period_changes_makkink_bias)
    max_period_changes_makkink_bias = np.max(period_changes_makkink_bias)    
    min_period_changes_oudin_bias = np.min(period_changes_oudin_bias)
    max_period_changes_oudin_bias = np.max(period_changes_oudin_bias)
    min_period_changes_penman_bias = np.min(period_changes_penman_bias)
    max_period_changes_penman_bias = np.max(period_changes_penman_bias)
    min_period_changes_penman_monteith_bias = np.min(period_changes_penman_monteith_bias)
    max_period_changes_penman_monteith_bias = np.max(period_changes_penman_monteith_bias)
    min_period_changes_pri_tay_bias = np.min(period_changes_pri_tay_bias)
    max_period_changes_pri_tay_bias = np.max(period_changes_pri_tay_bias)
    min_period_changes_turc_bias = np.min(period_changes_turc_bias)
    max_period_changes_turc_bias = np.max(period_changes_turc_bias)
    
    for xx in np.arange(0,10):
        #Hamon
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_hamon_bias[:,:,xx],vmin=min_period_changes_hamon_bias, vmax=max_period_changes_hamon_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_hamon_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \nHamon')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_hamon_'+site_n+'.png')
        plt.show()
        
        #Har_sam
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_har_sam_bias[:,:,xx],vmin=min_period_changes_har_sam_bias, vmax=max_period_changes_har_sam_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_har_sam_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \nHar-Sam')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_har_sam_'+site_n+'.png')
        plt.show()
        
        #Hargreaves
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_hargreaves_bias[:,:,xx],vmin=min_period_changes_hargreaves_bias, vmax=max_period_changes_hargreaves_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_hargreaves_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \nhargreaves')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_hargreaves_'+site_n+'.png')
        plt.show()
        
        #Jensen-Haise
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_jen_hai_bias[:,:,xx],vmin=min_period_changes_jen_hai_bias, vmax=max_period_changes_jen_hai_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_jen_hai_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \njen_hai')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_jen_hai_'+site_n+'.png')
        plt.show()
        
        #Makkink
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_makkink_bias[:,:,xx],vmin=min_period_changes_makkink_bias, vmax=max_period_changes_makkink_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_makkink_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \nmakkink')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_makkink_'+site_n+'.png')
        plt.show()
        
        #Oudin
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_oudin_bias[:,:,xx],vmin=min_period_changes_oudin_bias, vmax=max_period_changes_oudin_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_oudin_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \noudin')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_oudin_'+site_n+'.png')
        plt.show()
        
        #Penman
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_penman_bias[:,:,xx],vmin=min_period_changes_penman_bias, vmax=max_period_changes_penman_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_penman_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \npenman')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_penman_'+site_n+'.png')
        plt.show()
        
        #Penman-Monteith
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_penman_monteith_bias[:,:,xx],vmin=min_period_changes_penman_monteith_bias, vmax=max_period_changes_penman_monteith_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_penman_monteith_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \npenman_monteith')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_penman_monteith_'+site_n+'.png')
        plt.show()
        
        #Priestley-Taylor
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_pri_tay_bias[:,:,xx],vmin=min_period_changes_pri_tay_bias, vmax=max_period_changes_pri_tay_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_pri_tay_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \npri_tay')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_pri_tay_'+site_n+'.png')
        plt.show()

        #Turc
        font = {'family' : 'normal',
        'weight' : 'normal',
        'size'   : 16}
        fig= plt.figure(figsize=(40,20))      
        plt.rc('font', **font)
        
        fig, ax = plt.subplots()
       
        fontsize=14
        plt.imshow(period_changes_turc_bias[:,:,xx],vmin=min_period_changes_turc_bias, vmax=max_period_changes_turc_bias)
        
        # Setting the labels
        ax.set_xticks(np.arange(len(CMs)))
        ax.set_yticks(np.arange(len(periods)))
        # labeling respective list entries
        ax.set_xticklabels(CMs)
        ax.set_yticklabels(periods)
        
        # Creating text annotations by using for loop
        for j in range(len(periods)):
           for i in range(len(CMs)):
              text = ax.text(i,j,period_changes_turc_bias[j,i,xx],
                            ha="center", va="center", color="w",fontsize=10)
        
        clim_mod = xx+1
        clim_mod = str(clim_mod)
        ax.set_title('Projected change bias (%) relative\n to benchmark CM' +clim_mod+' in ' +site_n+' using \nturc')
               
        plt.colorbar(orientation='horizontal')
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/change_bias_matrix_bch_'+clim_mod+'_turc_'+site_n+'.png')
        plt.show()
        
        
#Mean bias for each CM considerin all pseudo reality experiments for each Pet method




    """
    for c in np.arange(0,10):
        for cc in np.arange(0,10):
            
            

     
        for n in np.arange(0,10): # Hamon files
        data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_hamon[n])
        data_mean = np.zeros([len(data),])
        for nn in np.arange(0,len(data)):
            data_mean[nn]=np.mean(data[nn,:,:])
        plt.plot(data_mean)
        plt.title('Daily PET estimation timeseries - Delta BC, Hamon - '+site_n)
        plt.ylim(0,15)
        plt.ylabel('Monthly PET (mm/month)')
        plt.xlabel('Days since 1971')
        plt.legend()
        plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_hamon_'+site_n+'.png')



for 

   







ref_file_har_sam = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_har_sam[ii])
ref_file_hargreaves = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_hargreaves[ii])
ref_file_jen_hai = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_jen_hai[ii])
ref_file_makkink = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_makkink[ii])
ref_file_oudin = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_oudin[ii])
ref_file_penman = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_penman[ii])
ref_file_penman_monteith = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_penman_monteith[ii])
ref_file_pri_tay = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_pri_tay[ii])
ref_file_turc = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/raw/'+file_ref_list_turc[ii])





df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[ii]]
pet_annual_ref_sum_all_cms_hamon[yy-1971,ii] = np.sum(df_cm.Hamon)


pet_annual_ref_sum_all_cms_hamon_reference

#Reference period 
for yy in np.arange(1971,1972): ## yy as in year

#Plotting the time series to check that bias-correction did not produce artifacts
for iii in np.arange(0,90):
cor_file_hamon = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_hamon[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Hamon files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_hamon[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Hamon - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_hamon_'+site_n+'.png')

cor_file_har_sam = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_har_sam[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Har-sam files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_har_sam[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Hargreaves-Samani - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_har_sam_'+site_n+'.png')

cor_file_hargreaves = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_hargreaves[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Hargreaves files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_hargreaves[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Hargreaves - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_hargreaves_'+site_n+'.png')

cor_file_jen_hai = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_jen_hai[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Jensen-Haise files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_jen_hai[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Jensen-Haise - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_jen_hai_'+site_n+'.png')

cor_file_makkink = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_makkink[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Makkink files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_makkink[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Makkink - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_makkink_'+site_n+'.png')

cor_file_oudin = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_oudin[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Oudin files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_oudin[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Oudin - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_oudin_'+site_n+'.png')

cor_file_penman = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_penman[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Penman files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_penman[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Penman - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_penman_'+site_n+'.png')

cor_file_penman_montheit = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_penman_monteith[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # penman_monteith files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_penman_monteith[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Penman-Monteith - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_penman_monteith_'+site_n+'.png')

cor_file_penman_montheit = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_pri_tay[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Priestly-Taylor files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_pri_tay[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Priestly-Taylor - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_pri_tay_'+site_n+'.png')

cor_file_penman_montheit = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_turc[iii])
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(40,20))
fontsize=20
plt.rc('font', **font)
for n in np.arange(0,10): # Turc files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_list[i]+'/pet/delta/corrected/pet/'+file_list_turc[n])
data_mean = np.zeros([len(data),])
for nn in np.arange(0,len(data)):
    data_mean[nn]=np.mean(data[nn,:,:])
plt.plot(data_mean)
plt.title('Daily PET estimation timeseries - Delta BC, Turc - '+site_n)
plt.ylim(0,15)
plt.ylabel('Monthly PET (mm/month)')
plt.xlabel('Days since 1971')
plt.legend()
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/delta/daily_pet_timeseries_turc_'+site_n+'.png')


   

   

   

   

   

   

   

   

   





print('Analysing corrected model:',file_list_hamon[iii],'for reference model:',file_ref_list_hamon[ii])

  
#Reference period 
for yy in np.arange(1971,2001): ## yy as in year










df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_ref_sum_all_cms_hamon[yy-1971,cm_i] = np.sum(df_cm.Hamon)
pet_annual_ref_sum_all_cms_har_sam[yy-1971,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_ref_sum_all_cms_hargreaves[yy-1971,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_ref_sum_all_cms_jen_hai[yy-1971,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_ref_sum_all_cms_makkink[yy-1971,cm_i] = np.sum(df_cm.Makkink)            
pet_annual_ref_sum_all_cms_oudin[yy-1971,cm_i] = np.sum(df_cm.Oudin)
pet_annual_ref_sum_all_cms_penman[yy-1971,cm_i] = np.sum(df_cm.Penman)
pet_annual_ref_sum_all_cms_penman_montheit[yy-1971,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_ref_sum_all_cms_pri_tay[yy-1971,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_ref_sum_all_cms_turc[yy-1971,cm_i] = np.sum(df_cm.Turc)
                   
#Near period 
for yy in np.arange(2011,2041): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_near_sum_all_cms_hamon[yy-2011,cm_i] = np.sum(df_cm.Hamon)
pet_annual_near_sum_all_cms_har_sam[yy-2011,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_near_sum_all_cms_hargreaves[yy-2011,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_near_sum_all_cms_jen_hai[yy-2011,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_near_sum_all_cms_makkink[yy-2011,cm_i] = np.sum(df_cm.Makkink)
pet_annual_near_sum_all_cms_oudin[yy-2011,cm_i] = np.sum(df_cm.Oudin)
pet_annual_near_sum_all_cms_penman[yy-2011,cm_i] = np.sum(df_cm.Penman)
pet_annual_near_sum_all_cms_penman_montheit[yy-2011,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_near_sum_all_cms_pri_tay[yy-2011,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_near_sum_all_cms_turc[yy-2011,cm_i] = np.sum(df_cm.Turc)

#mid_period
for yy in np.arange(2041,2071): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_mid_sum_all_cms_hamon[yy-2041,cm_i] = np.sum(df_cm.Hamon)
pet_annual_mid_sum_all_cms_har_sam[yy-2041,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_mid_sum_all_cms_hargreaves[yy-2041,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_mid_sum_all_cms_jen_hai[yy-2041,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_mid_sum_all_cms_makkink[yy-2041,cm_i] = np.sum(df_cm.Makkink)            
pet_annual_mid_sum_all_cms_oudin[yy-2041,cm_i] = np.sum(df_cm.Oudin)
pet_annual_mid_sum_all_cms_penman[yy-2041,cm_i] = np.sum(df_cm.Penman)
pet_annual_mid_sum_all_cms_penman_montheit[yy-2041,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_mid_sum_all_cms_pri_tay[yy-2041,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_mid_sum_all_cms_turc[yy-2041,cm_i] = np.sum(df_cm.Turc)
               
#far period 
for yy in np.arange(2071,2101): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_far_sum_all_cms_hamon[yy-2071,cm_i] = np.sum(df_cm.Hamon)
pet_annual_far_sum_all_cms_har_sam[yy-2071,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_far_sum_all_cms_hargreaves[yy-2071,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_far_sum_all_cms_jen_hai[yy-2071,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_far_sum_all_cms_makkink[yy-2071,cm_i] = np.sum(df_cm.Makkink)
pet_annual_far_sum_all_cms_oudin[yy-2071,cm_i] = np.sum(df_cm.Oudin)
pet_annual_far_sum_all_cms_penman[yy-2071,cm_i] = np.sum(df_cm.Penman)
pet_annual_far_sum_all_cms_penman_montheit[yy-2071,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_far_sum_all_cms_pri_tay[yy-2071,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_far_sum_all_cms_turc[yy-2071,cm_i] = np.sum(df_cm.Turc)





et_models = pd.read_excel('C:/Users/erpasten/Documents/UEF/PET/Python/et_modles.xlsx', header=None)
et_models = np.array(et_models)
climate_models = ['CERFACS_HIRHAM','CERFACS_RCA','ICHEC_HIRHAM','ICHEC_RACMO','ICHEC_RCA','MPI_HIRHAM','MPI_RCA','NORESM_HIRHAM','NORESM_RACMO','NORESM_RCA']
climate_models = climate_models*10
dates = pd.read_excel('C:/Users/erpasten/Documents/UEF/PET/Python/dates1971.xlsx')
month = dates.Month
year = dates.Year
dates_no_leap = pd.read_excel('C:/Users/erpasten/Documents/UEF/PET/Python/dates1971_noleap.xlsx')
month_noleap = dates_no_leap.Month 
year_noleap = dates_no_leap.Year
n_years= np.arange(1971,2101)
n_months = np.arange(1,13)


site_list = ['at','dk','dl','fi','fr','gr','it','ro','sp','uk']
for site_n in site_list:
print(site_n)
file_list = [filename for filename in os.listdir('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/') if filename.startswith('raw') and filename.endswith('.npy')]
hamon_all = np.array(1,)
har_sam_all = np.array(1,)
hargreaves_all = np.array(1,)
jen_hai_all = np.array(1,)
makkink_all = np.array(1,)
oudin_all = np.array(1,)
penman_all = np.array(1,)
penman_mon_all = np.array(1,)
priest_tay_all = np.array(1,)
turc_all = np.array(1,)
#print(file_list)

#monthly_pet = np.zeros([len(file_list),130,12]) #[model_method,year,month]

for i in np.arange(0,10): # Hamon files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
hamon_all = np.append(hamon_all, data_mean)

for i in np.arange(10,20): #Hargreaves files
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
hargreaves_all = np.append(hargreaves_all, data_mean)

for i in np.arange(20,30):# Har_sam
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
har_sam_all = np.append(har_sam_all, data_mean)

for i in np.arange(30,40):#Jensen Haise
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
jen_hai_all = np.append(jen_hai_all, data_mean)

for i in np.arange(40,50):#Makkink
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
makkink_all = np.append(makkink_all, data_mean)

for i in np.arange(50,60):#Oudin
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
oudin_all = np.append(oudin_all, data_mean)

for i in np.arange(60,70):#Penman
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
penman_all = np.append(penman_all, data_mean)

for i in np.arange(70,80):#Penman-Monteith
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
penman_mon_all = np.append(penman_mon_all, data_mean)

for i in np.arange(80,90):#Priestly Taylor
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
priest_tay_all = np.append(priest_tay_all, data_mean)

for i in np.arange(90,100):#Turc
data = np.load('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/'+file_list[i])
print(file_list[i],' - max:',np.around(np.max(data),decimals=3),'min:',np.around(np.min(data),decimals=3))
print(len(data))
data_mean = np.zeros([len(data),])
for n in np.arange(0,len(data)):
data_mean[n]=np.mean(data[n,:,:])
turc_all = np.append(turc_all, data_mean)

df = pd.read_excel('C:/Users/erpasten/Documents/UEF/PET/Python/dataframe.xlsx')
df.loc[df['Site'] == 'at', 'Site'] = site_n # The original dataframe (one line above) has 'at' ad default Site value
hamon_all = hamon_all[1:,]
har_sam_all = har_sam_all[1:,]
hargreaves_all = hargreaves_all[1:,]
oudin_all = oudin_all[1:,]
penman_all = penman_all[1:,]
penman_mon_all = penman_mon_all[1:,]
turc_all = turc_all[1:,]
priest_tay_all = priest_tay_all[1:,]
jen_hai_all = jen_hai_all[1:,]
makkink_all = makkink_all[1:,]
df['Hamon']= hamon_all
df['Hargreaves_Samani']=har_sam_all
df['Hargreaves']=hargreaves_all
df['Jensen_Haisse']= jen_hai_all
df['Oudin']=oudin_all
df['Makkink']=makkink_all
df['Penman']=penman_all
df['Penman_Montheit']=penman_mon_all    
df['Priestly_Taylor']= priest_tay_all
df['Turc']= turc_all

df.to_csv('C:/Users/erpasten/Documents/UEF/PET/dataframes/df_raw_'+site_n+'.csv')

"""
"""

df_list = [filename for filename in os.listdir('C:/Users/erpasten/Documents/UEF/PET/dataframes/') if filename.startswith('df') and filename.endswith('.csv')]

for df_list_n in df_list:
df = pd.read_csv('C:/Users/erpasten/Documents/UEF/PET/dataframes/'+df_list_n)
print(df_list_n)

pet_month_means_all_cms = np.zeros([12,10])#Hamon,
for mm in np.arange(1,13):
pet_month_means_all_cms[mm-1,0] = np.sum(df.loc[df.Month==mm,:].Hamon)/1300 # this is the average
pet_month_means_all_cms[mm-1,1] = np.sum(df.loc[df.Month==mm,:].Hargreaves_Samani)/1300
pet_month_means_all_cms[mm-1,2] = np.sum(df.loc[df.Month==mm,:].Hargreaves)/1300
pet_month_means_all_cms[mm-1,3] = np.sum(df.loc[df.Month==mm,:].Jensen_Haisse)/1300
pet_month_means_all_cms[mm-1,4] = np.sum(df.loc[df.Month==mm,:].Makkink)/1300
pet_month_means_all_cms[mm-1,5] = np.sum(df.loc[df.Month==mm,:].Oudin)/1300
pet_month_means_all_cms[mm-1,6] = np.sum(df.loc[df.Month==mm,:].Penman)/1300
pet_month_means_all_cms[mm-1,7] = np.sum(df.loc[df.Month==mm,:].Penman_Montheit)/1300
pet_month_means_all_cms[mm-1,8] = np.sum(df.loc[df.Month==mm,:].Priestly_Taylor)/1300
pet_month_means_all_cms[mm-1,9] = np.sum(df.loc[df.Month==mm,:].Turc)/1300    

import seaborn as sn
df = df.loc[:, ~df.columns.str.contains('^Unnamed')]
df_for_corr = df
df_for_corr.drop(['Month','Day','Year','Julian'],axis=1,inplace=True)
corrMatrix = df_for_corr.corr()
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}
fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
sn.heatmap(corrMatrix, annot=True)
plt.title('Correlation Matrix for the Monthly accumulated PE:' +df_list_n[7:9])
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/correlation_monthly_pet_'+df_list_n[7:9]+'.png')


# Monthly mean - PET mthod

font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
name_months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']
pet_list = ['Hamon','Har-Sam','Hargreaves','Jensen-Haise','Makkink','Oudin','Penman','Penman-Monteith','Priestley-Taylor','Turc']
data_monthly_pet = np.zeros([100,12])
for nn in np.arange(0,10):
plt.plot(name_months,pet_month_means_all_cms[:,nn],label=pet_list[nn],markevery=5)          


   # np.save('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/monthly_pet_all.npy',data_monthly_pet)

plt.grid(True)
plt.legend()
plt.title('Monthly accumulated PE:' +df_list_n[7:9])
plt.xlabel('Month')
plt.ylabel('Accumulated PE (mm/month)')
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/monthly_pet_'+df_list_n[7:9]+'.png')

# Projected change 

pet_annual_ref_sum_all_cms_hamon = np.zeros([30,10])
pet_annual_ref_sum_all_cms_har_sam = np.zeros([30,10])
pet_annual_ref_sum_all_cms_hargreaves = np.zeros([30,10])
pet_annual_ref_sum_all_cms_jen_hai = np.zeros([30,10])
pet_annual_ref_sum_all_cms_makkink = np.zeros([30,10])
pet_annual_ref_sum_all_cms_oudin = np.zeros([30,10])
pet_annual_ref_sum_all_cms_penman = np.zeros([30,10])
pet_annual_ref_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_annual_ref_sum_all_cms_pri_tay = np.zeros([30,10])
pet_annual_ref_sum_all_cms_turc = np.zeros([30,10])

pet_annual_near_sum_all_cms_hamon = np.zeros([30,10])
pet_annual_near_sum_all_cms_har_sam = np.zeros([30,10])
pet_annual_near_sum_all_cms_hargreaves = np.zeros([30,10])
pet_annual_near_sum_all_cms_jen_hai = np.zeros([30,10])
pet_annual_near_sum_all_cms_makkink = np.zeros([30,10])
pet_annual_near_sum_all_cms_oudin = np.zeros([30,10])
pet_annual_near_sum_all_cms_penman = np.zeros([30,10])
pet_annual_near_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_annual_near_sum_all_cms_pri_tay = np.zeros([30,10])
pet_annual_near_sum_all_cms_turc = np.zeros([30,10])


pet_annual_far_sum_all_cms_hamon = np.zeros([30,10])
pet_annual_far_sum_all_cms_har_sam = np.zeros([30,10])
pet_annual_far_sum_all_cms_hargreaves = np.zeros([30,10])
pet_annual_far_sum_all_cms_jen_hai = np.zeros([30,10])
pet_annual_far_sum_all_cms_makkink = np.zeros([30,10])   
pet_annual_far_sum_all_cms_oudin = np.zeros([30,10])
pet_annual_far_sum_all_cms_penman = np.zeros([30,10])
pet_annual_far_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_annual_far_sum_all_cms_pri_tay = np.zeros([30,10])
pet_annual_far_sum_all_cms_turc = np.zeros([30,10])

pet_annual_mid_sum_all_cms_hamon = np.zeros([30,10])
pet_annual_mid_sum_all_cms_har_sam = np.zeros([30,10])
pet_annual_mid_sum_all_cms_hargreaves = np.zeros([30,10])
pet_annual_mid_sum_all_cms_jen_hai = np.zeros([30,10])
pet_annual_mid_sum_all_cms_makkink = np.zeros([30,10])
pet_annual_mid_sum_all_cms_oudin = np.zeros([30,10])
pet_annual_mid_sum_all_cms_penman = np.zeros([30,10])
pet_annual_mid_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_annual_mid_sum_all_cms_pri_tay = np.zeros([30,10])
pet_annual_mid_sum_all_cms_turc = np.zeros([30,10])


pet_summer_ref_sum_all_cms_hamon = np.zeros([30,10])
pet_summer_ref_sum_all_cms_har_sam = np.zeros([30,10])
pet_summer_ref_sum_all_cms_hargreaves = np.zeros([30,10])
pet_summer_ref_sum_all_cms_jen_hai = np.zeros([30,10])
pet_summer_ref_sum_all_cms_makkink = np.zeros([30,10])
pet_summer_ref_sum_all_cms_oudin = np.zeros([30,10])
pet_summer_ref_sum_all_cms_penman = np.zeros([30,10])
pet_summer_ref_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_summer_ref_sum_all_cms_pri_tay = np.zeros([30,10])
pet_summer_ref_sum_all_cms_turc = np.zeros([30,10])

pet_summer_near_sum_all_cms_hamon = np.zeros([30,10])
pet_summer_near_sum_all_cms_har_sam = np.zeros([30,10])
pet_summer_near_sum_all_cms_hargreaves = np.zeros([30,10])
pet_summer_near_sum_all_cms_jen_hai = np.zeros([30,10])
pet_summer_near_sum_all_cms_makkink = np.zeros([30,10])
pet_summer_near_sum_all_cms_oudin = np.zeros([30,10])
pet_summer_near_sum_all_cms_penman = np.zeros([30,10])
pet_summer_near_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_summer_near_sum_all_cms_pri_tay = np.zeros([30,10])
pet_summer_near_sum_all_cms_turc = np.zeros([30,10])


pet_summer_far_sum_all_cms_hamon = np.zeros([30,10])
pet_summer_far_sum_all_cms_har_sam = np.zeros([30,10])
pet_summer_far_sum_all_cms_hargreaves = np.zeros([30,10])
pet_summer_far_sum_all_cms_jen_hai = np.zeros([30,10])
pet_summer_far_sum_all_cms_makkink = np.zeros([30,10])
pet_summer_far_sum_all_cms_oudin = np.zeros([30,10])
pet_summer_far_sum_all_cms_penman = np.zeros([30,10])
pet_summer_far_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_summer_far_sum_all_cms_pri_tay = np.zeros([30,10])
pet_summer_far_sum_all_cms_turc = np.zeros([30,10])


pet_summer_mid_sum_all_cms_hamon = np.zeros([30,10])
pet_summer_mid_sum_all_cms_har_sam = np.zeros([30,10])
pet_summer_mid_sum_all_cms_hargreaves = np.zeros([30,10])
pet_summer_mid_sum_all_cms_jen_hai = np.zeros([30,10])
pet_summer_mid_sum_all_cms_makkink = np.zeros([30,10])
pet_summer_mid_sum_all_cms_oudin = np.zeros([30,10])
pet_summer_mid_sum_all_cms_penman = np.zeros([30,10])
pet_summer_mid_sum_all_cms_penman_montheit = np.zeros([30,10])
pet_summer_mid_sum_all_cms_pri_tay = np.zeros([30,10])
pet_summer_mid_sum_all_cms_turc = np.zeros([30,10])


df = pd.read_csv('C:/Users/erpasten/Documents/UEF/PET/dataframes/'+df_list_n)
unique_CMs = df.CM.unique()
no_CMs = np.arange(0,10)
for cm_i in no_CMs:

#Reference period 
for yy in np.arange(1971,2001): ## yy as in year

df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_ref_sum_all_cms_hamon[yy-1971,cm_i] = np.sum(df_cm.Hamon)
pet_annual_ref_sum_all_cms_har_sam[yy-1971,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_ref_sum_all_cms_hargreaves[yy-1971,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_ref_sum_all_cms_jen_hai[yy-1971,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_ref_sum_all_cms_makkink[yy-1971,cm_i] = np.sum(df_cm.Makkink)            
pet_annual_ref_sum_all_cms_oudin[yy-1971,cm_i] = np.sum(df_cm.Oudin)
pet_annual_ref_sum_all_cms_penman[yy-1971,cm_i] = np.sum(df_cm.Penman)
pet_annual_ref_sum_all_cms_penman_montheit[yy-1971,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_ref_sum_all_cms_pri_tay[yy-1971,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_ref_sum_all_cms_turc[yy-1971,cm_i] = np.sum(df_cm.Turc)
                   
#Near period 
for yy in np.arange(2011,2041): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_near_sum_all_cms_hamon[yy-2011,cm_i] = np.sum(df_cm.Hamon)
pet_annual_near_sum_all_cms_har_sam[yy-2011,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_near_sum_all_cms_hargreaves[yy-2011,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_near_sum_all_cms_jen_hai[yy-2011,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_near_sum_all_cms_makkink[yy-2011,cm_i] = np.sum(df_cm.Makkink)
pet_annual_near_sum_all_cms_oudin[yy-2011,cm_i] = np.sum(df_cm.Oudin)
pet_annual_near_sum_all_cms_penman[yy-2011,cm_i] = np.sum(df_cm.Penman)
pet_annual_near_sum_all_cms_penman_montheit[yy-2011,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_near_sum_all_cms_pri_tay[yy-2011,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_near_sum_all_cms_turc[yy-2011,cm_i] = np.sum(df_cm.Turc)

#mid_period
for yy in np.arange(2041,2071): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_mid_sum_all_cms_hamon[yy-2041,cm_i] = np.sum(df_cm.Hamon)
pet_annual_mid_sum_all_cms_har_sam[yy-2041,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_mid_sum_all_cms_hargreaves[yy-2041,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_mid_sum_all_cms_jen_hai[yy-2041,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_mid_sum_all_cms_makkink[yy-2041,cm_i] = np.sum(df_cm.Makkink)            
pet_annual_mid_sum_all_cms_oudin[yy-2041,cm_i] = np.sum(df_cm.Oudin)
pet_annual_mid_sum_all_cms_penman[yy-2041,cm_i] = np.sum(df_cm.Penman)
pet_annual_mid_sum_all_cms_penman_montheit[yy-2041,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_mid_sum_all_cms_pri_tay[yy-2041,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_mid_sum_all_cms_turc[yy-2041,cm_i] = np.sum(df_cm.Turc)
               
#far period 
for yy in np.arange(2071,2101): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_cm=df_yy.loc[df_yy.CM==unique_CMs[cm_i]]
pet_annual_far_sum_all_cms_hamon[yy-2071,cm_i] = np.sum(df_cm.Hamon)
pet_annual_far_sum_all_cms_har_sam[yy-2071,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_annual_far_sum_all_cms_hargreaves[yy-2071,cm_i] = np.sum(df_cm.Hargreaves)
pet_annual_far_sum_all_cms_jen_hai[yy-2071,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_annual_far_sum_all_cms_makkink[yy-2071,cm_i] = np.sum(df_cm.Makkink)
pet_annual_far_sum_all_cms_oudin[yy-2071,cm_i] = np.sum(df_cm.Oudin)
pet_annual_far_sum_all_cms_penman[yy-2071,cm_i] = np.sum(df_cm.Penman)
pet_annual_far_sum_all_cms_penman_montheit[yy-2071,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_annual_far_sum_all_cms_pri_tay[yy-2071,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_annual_far_sum_all_cms_turc[yy-2071,cm_i] = np.sum(df_cm.Turc)

# Seasonal ==> summer
# Reference 

for yy in np.arange(1971,2001): ## yy as in year
df_yy = df.loc[df.Year==yy]

df_ss_a = df_yy.loc[df_yy.Month>=6]
df_ss = df_ss_a.loc[df_ss_a.Month<=8]
#df_yy_sum = df_ss.loc[df_ss.Year==yy]
df_cm=df_ss.loc[df_ss.CM==unique_CMs[cm_i]]
pet_summer_ref_sum_all_cms_hamon[yy-1971,cm_i] = np.sum(df_cm.Hamon)
pet_summer_ref_sum_all_cms_har_sam[yy-1971,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_summer_ref_sum_all_cms_hargreaves[yy-1971,cm_i] = np.sum(df_cm.Hargreaves)
pet_summer_ref_sum_all_cms_jen_hai[yy-1971,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_summer_ref_sum_all_cms_makkink[yy-1971,cm_i] = np.sum(df_cm.Makkink)
pet_summer_ref_sum_all_cms_oudin[yy-1971,cm_i] = np.sum(df_cm.Oudin)
pet_summer_ref_sum_all_cms_penman[yy-1971,cm_i] = np.sum(df_cm.Penman)
pet_summer_ref_sum_all_cms_penman_montheit[yy-1971,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_summer_ref_sum_all_cms_pri_tay[yy-1971,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_summer_ref_sum_all_cms_turc[yy-1971,cm_i] = np.sum(df_cm.Turc)

# Near
for yy in np.arange(2011,2041): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_ss_a = df_yy.loc[df_yy.Month>=6]
df_ss = df_ss_a.loc[df_ss_a.Month<=8]
df_cm=df_ss.loc[df_ss.CM==unique_CMs[cm_i]]
pet_summer_near_sum_all_cms_hamon[yy-2011,cm_i] = np.sum(df_cm.Hamon)
pet_summer_near_sum_all_cms_har_sam[yy-2011,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_summer_near_sum_all_cms_hargreaves[yy-2011,cm_i] = np.sum(df_cm.Hargreaves)
pet_summer_near_sum_all_cms_jen_hai[yy-2011,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_summer_near_sum_all_cms_makkink[yy-2011,cm_i] = np.sum(df_cm.Makkink)            
pet_summer_near_sum_all_cms_oudin[yy-2011,cm_i] = np.sum(df_cm.Oudin)
pet_summer_near_sum_all_cms_penman[yy-2011,cm_i] = np.sum(df_cm.Penman)
pet_summer_near_sum_all_cms_penman_montheit[yy-2011,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_summer_near_sum_all_cms_pri_tay[yy-2011,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_summer_near_sum_all_cms_turc[yy-2011,cm_i] = np.sum(df_cm.Turc)

#Mid
for yy in np.arange(2041,2071): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_ss_a = df_yy.loc[df_yy.Month>=6]
df_ss = df_ss_a.loc[df_ss_a.Month<=8]
df_cm=df_ss.loc[df_ss.CM==unique_CMs[cm_i]]
pet_summer_mid_sum_all_cms_hamon[yy-2041,cm_i] = np.sum(df_cm.Hamon)
pet_summer_mid_sum_all_cms_har_sam[yy-2041,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_summer_mid_sum_all_cms_hargreaves[yy-2041,cm_i] = np.sum(df_cm.Hargreaves)
pet_summer_mid_sum_all_cms_jen_hai[yy-2041,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_summer_mid_sum_all_cms_makkink[yy-2041,cm_i] = np.sum(df_cm.Makkink)
pet_summer_mid_sum_all_cms_oudin[yy-2041,cm_i] = np.sum(df_cm.Oudin)
pet_summer_mid_sum_all_cms_penman[yy-2041,cm_i] = np.sum(df_cm.Penman)
pet_summer_mid_sum_all_cms_penman_montheit[yy-2041,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_summer_mid_sum_all_cms_pri_tay[yy-2041,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_summer_mid_sum_all_cms_turc[yy-2041,cm_i] = np.sum(df_cm.Turc)            

# Far
for yy in np.arange(2071,2101): ## yy as in year
df_yy = df.loc[df.Year==yy]
df_ss_a = df_yy.loc[df_yy.Month>=6]
df_ss = df_ss_a.loc[df_ss_a.Month<=8]
df_cm=df_ss.loc[df_ss.CM==unique_CMs[cm_i]]
pet_summer_far_sum_all_cms_hamon[yy-2071,cm_i] = np.sum(df_cm.Hamon)
pet_summer_far_sum_all_cms_har_sam[yy-2071,cm_i] = np.sum(df_cm.Hargreaves_Samani)
pet_summer_far_sum_all_cms_hargreaves[yy-2071,cm_i] = np.sum(df_cm.Hargreaves)
pet_summer_far_sum_all_cms_jen_hai[yy-2071,cm_i] = np.sum(df_cm.Jensen_Haisse)
pet_summer_far_sum_all_cms_makkink[yy-2071,cm_i] = np.sum(df_cm.Makkink)
pet_summer_far_sum_all_cms_oudin[yy-2071,cm_i] = np.sum(df_cm.Oudin)
pet_summer_far_sum_all_cms_penman[yy-2071,cm_i] = np.sum(df_cm.Penman)
pet_summer_far_sum_all_cms_penman_montheit[yy-2071,cm_i] = np.sum(df_cm.Penman_Montheit)
pet_summer_far_sum_all_cms_pri_tay[yy-2071,cm_i] = np.sum(df_cm.Priestly_Taylor)
pet_summer_far_sum_all_cms_turc[yy-2071,cm_i] = np.sum(df_cm.Turc)
       

av_pet_annual_ref_sum_all_cms_hamon = np.mean(pet_annual_ref_sum_all_cms_hamon,axis=0)
av_pet_annual_ref_sum_all_cms_har_sam = np.mean(pet_annual_ref_sum_all_cms_har_sam,axis=0)
av_pet_annual_ref_sum_all_cms_hargreaves = np.mean(pet_annual_ref_sum_all_cms_hargreaves,axis=0)
av_pet_annual_ref_sum_all_cms_jen_hai = np.mean(pet_annual_ref_sum_all_cms_jen_hai,axis=0)
av_pet_annual_ref_sum_all_cms_makkink = np.mean(pet_annual_ref_sum_all_cms_makkink,axis=0)
av_pet_annual_ref_sum_all_cms_oudin = np.mean(pet_annual_ref_sum_all_cms_oudin,axis=0)
av_pet_annual_ref_sum_all_cms_penman = np.mean(pet_annual_ref_sum_all_cms_penman,axis=0)
av_pet_annual_ref_sum_all_cms_penman_montheit = np.mean(pet_annual_ref_sum_all_cms_penman_montheit,axis=0)
av_pet_annual_ref_sum_all_cms_pri_tay = np.mean(pet_annual_ref_sum_all_cms_pri_tay,axis=0)
av_pet_annual_ref_sum_all_cms_turc = np.mean(pet_annual_ref_sum_all_cms_turc,axis=0)
 
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_cms_hamon,av_pet_annual_ref_sum_all_cms_har_sam))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_hargreaves))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_jen_hai))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_makkink))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_oudin))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_penman))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_penman_montheit))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_pri_tay))
av_pet_annual_ref_sum_all_values = np.vstack((av_pet_annual_ref_sum_all_values,av_pet_annual_ref_sum_all_cms_turc))
av_pet_annual_ref_sum_all_values = np.transpose(av_pet_annual_ref_sum_all_values)

av_pet_annual_near_sum_all_cms_hamon = np.mean(pet_annual_near_sum_all_cms_hamon,axis=0)
av_pet_annual_near_sum_all_cms_har_sam = np.mean(pet_annual_near_sum_all_cms_har_sam,axis=0)
av_pet_annual_near_sum_all_cms_hargreaves = np.mean(pet_annual_near_sum_all_cms_hargreaves,axis=0)
av_pet_annual_near_sum_all_cms_jen_hai = np.mean(pet_annual_near_sum_all_cms_jen_hai,axis=0)
av_pet_annual_near_sum_all_cms_makkink = np.mean(pet_annual_near_sum_all_cms_makkink,axis=0)
av_pet_annual_near_sum_all_cms_oudin = np.mean(pet_annual_near_sum_all_cms_oudin,axis=0)
av_pet_annual_near_sum_all_cms_penman = np.mean(pet_annual_near_sum_all_cms_penman,axis=0)
av_pet_annual_near_sum_all_cms_penman_montheit = np.mean(pet_annual_near_sum_all_cms_penman_montheit,axis=0)
av_pet_annual_near_sum_all_cms_pri_tay = np.mean(pet_annual_near_sum_all_cms_pri_tay,axis=0)
av_pet_annual_near_sum_all_cms_turc = np.mean(pet_annual_near_sum_all_cms_turc,axis=0)
  
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_cms_hamon,av_pet_annual_near_sum_all_cms_har_sam))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_hargreaves))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_jen_hai))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_makkink))    
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_oudin))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_penman))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_penman_montheit))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_pri_tay))
av_pet_annual_near_sum_all_values = np.vstack((av_pet_annual_near_sum_all_values,av_pet_annual_near_sum_all_cms_turc))
av_pet_annual_near_sum_all_values = np.transpose(av_pet_annual_near_sum_all_values)

av_pet_annual_mid_sum_all_cms_hamon = np.mean(pet_annual_mid_sum_all_cms_hamon,axis=0)
av_pet_annual_mid_sum_all_cms_har_sam = np.mean(pet_annual_mid_sum_all_cms_har_sam,axis=0)
av_pet_annual_mid_sum_all_cms_hargreaves = np.mean(pet_annual_mid_sum_all_cms_hargreaves,axis=0)
av_pet_annual_mid_sum_all_cms_jen_hai = np.mean(pet_annual_mid_sum_all_cms_jen_hai,axis=0)
av_pet_annual_mid_sum_all_cms_makkink = np.mean(pet_annual_mid_sum_all_cms_makkink,axis=0)
av_pet_annual_mid_sum_all_cms_oudin = np.mean(pet_annual_mid_sum_all_cms_oudin,axis=0)
av_pet_annual_mid_sum_all_cms_penman = np.mean(pet_annual_mid_sum_all_cms_penman,axis=0)
av_pet_annual_mid_sum_all_cms_penman_montheit = np.mean(pet_annual_mid_sum_all_cms_penman_montheit,axis=0)
av_pet_annual_mid_sum_all_cms_pri_tay = np.mean(pet_annual_mid_sum_all_cms_pri_tay,axis=0)
av_pet_annual_mid_sum_all_cms_turc = np.mean(pet_annual_mid_sum_all_cms_turc,axis=0)

av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_cms_hamon,av_pet_annual_mid_sum_all_cms_har_sam))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_hargreaves))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_jen_hai))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_makkink))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_oudin))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_penman))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_penman_montheit))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_pri_tay))
av_pet_annual_mid_sum_all_values = np.vstack((av_pet_annual_mid_sum_all_values,av_pet_annual_mid_sum_all_cms_turc))
av_pet_annual_mid_sum_all_values = np.transpose(av_pet_annual_mid_sum_all_values) 

av_pet_annual_far_sum_all_cms_hamon = np.mean(pet_annual_far_sum_all_cms_hamon,axis=0)
av_pet_annual_far_sum_all_cms_har_sam = np.mean(pet_annual_far_sum_all_cms_har_sam,axis=0)
av_pet_annual_far_sum_all_cms_hargreaves = np.mean(pet_annual_far_sum_all_cms_hargreaves,axis=0)
av_pet_annual_far_sum_all_cms_jen_hai = np.mean(pet_annual_far_sum_all_cms_jen_hai,axis=0)
av_pet_annual_far_sum_all_cms_makkink = np.mean(pet_annual_far_sum_all_cms_makkink,axis=0)    
av_pet_annual_far_sum_all_cms_oudin = np.mean(pet_annual_far_sum_all_cms_oudin,axis=0)
av_pet_annual_far_sum_all_cms_penman = np.mean(pet_annual_far_sum_all_cms_penman,axis=0)
av_pet_annual_far_sum_all_cms_penman_montheit = np.mean(pet_annual_far_sum_all_cms_penman_montheit,axis=0)
av_pet_annual_far_sum_all_cms_pri_tay = np.mean(pet_annual_far_sum_all_cms_pri_tay,axis=0)
av_pet_annual_far_sum_all_cms_turc = np.mean(pet_annual_far_sum_all_cms_turc,axis=0)
   
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_cms_hamon,av_pet_annual_far_sum_all_cms_har_sam))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_hargreaves))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_jen_hai))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_makkink))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_oudin))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_penman))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_penman_montheit))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_pri_tay))
av_pet_annual_far_sum_all_values = np.vstack((av_pet_annual_far_sum_all_values,av_pet_annual_far_sum_all_cms_turc))
av_pet_annual_far_sum_all_values = np.transpose(av_pet_annual_far_sum_all_values) 

#near change pet method
pct_chg_pet_annual_near_sum_all_cms_hamon = (av_pet_annual_near_sum_all_cms_hamon-av_pet_annual_ref_sum_all_cms_hamon)/av_pet_annual_ref_sum_all_cms_hamon *100
pct_chg_pet_annual_near_sum_all_cms_har_sam = (av_pet_annual_near_sum_all_cms_har_sam-av_pet_annual_ref_sum_all_cms_har_sam)/av_pet_annual_ref_sum_all_cms_har_sam *100
pct_chg_pet_annual_near_sum_all_cms_hargreaves = (av_pet_annual_near_sum_all_cms_hargreaves-av_pet_annual_ref_sum_all_cms_hargreaves)/av_pet_annual_ref_sum_all_cms_hargreaves *100
pct_chg_pet_annual_near_sum_all_cms_jen_hai = (av_pet_annual_near_sum_all_cms_jen_hai-av_pet_annual_ref_sum_all_cms_jen_hai)/av_pet_annual_ref_sum_all_cms_jen_hai *100
pct_chg_pet_annual_near_sum_all_cms_makkink = (av_pet_annual_near_sum_all_cms_makkink-av_pet_annual_ref_sum_all_cms_makkink)/av_pet_annual_ref_sum_all_cms_makkink *100    
pct_chg_pet_annual_near_sum_all_cms_oudin = (av_pet_annual_near_sum_all_cms_oudin-av_pet_annual_ref_sum_all_cms_har_sam)/av_pet_annual_ref_sum_all_cms_har_sam *100
pct_chg_pet_annual_near_sum_all_cms_penman = (av_pet_annual_near_sum_all_cms_penman-av_pet_annual_ref_sum_all_cms_penman)/av_pet_annual_ref_sum_all_cms_penman *100
pct_chg_pet_annual_near_sum_all_cms_penman_montheit = (av_pet_annual_near_sum_all_cms_penman_montheit-av_pet_annual_ref_sum_all_cms_penman_montheit)/av_pet_annual_ref_sum_all_cms_penman_montheit *100
pct_chg_pet_annual_near_sum_all_cms_pri_tay = (av_pet_annual_near_sum_all_cms_pri_tay-av_pet_annual_ref_sum_all_cms_pri_tay)/av_pet_annual_ref_sum_all_cms_pri_tay *100
pct_chg_pet_annual_near_sum_all_cms_turc = (av_pet_annual_near_sum_all_cms_turc-av_pet_annual_ref_sum_all_cms_turc)/av_pet_annual_ref_sum_all_cms_turc *100

#near change climate model
pct_chg_pet_annual_near_sum_all_methods_cerfacs_hirham = (av_pet_annual_near_sum_all_values[0,:]- av_pet_annual_ref_sum_all_values[0,:])/av_pet_annual_ref_sum_all_values[0,:] *100
pct_chg_pet_annual_near_sum_all_methods_cerfacs_rca = (av_pet_annual_near_sum_all_values[1,:]- av_pet_annual_ref_sum_all_values[1,:])/av_pet_annual_ref_sum_all_values[1,:] *100
pct_chg_pet_annual_near_sum_all_methods_ichec_rca = (av_pet_annual_near_sum_all_values[2,:]- av_pet_annual_ref_sum_all_values[2,:])/av_pet_annual_ref_sum_all_values[2,:] *100
pct_chg_pet_annual_near_sum_all_methods_ichec_hirham = (av_pet_annual_near_sum_all_values[3,:]- av_pet_annual_ref_sum_all_values[3,:])/av_pet_annual_ref_sum_all_values[3,:] *100
pct_chg_pet_annual_near_sum_all_methods_ichec_racmo = (av_pet_annual_near_sum_all_values[4,:]- av_pet_annual_ref_sum_all_values[4,:])/av_pet_annual_ref_sum_all_values[4,:] *100
pct_chg_pet_annual_near_sum_all_methods_mpi_hirham = (av_pet_annual_near_sum_all_values[5,:]- av_pet_annual_ref_sum_all_values[5,:])/av_pet_annual_ref_sum_all_values[5,:] *100
pct_chg_pet_annual_near_sum_all_methods_mpi_rca = (av_pet_annual_near_sum_all_values[6,:]- av_pet_annual_ref_sum_all_values[6,:])/av_pet_annual_ref_sum_all_values[6,:] *100
pct_chg_pet_annual_near_sum_all_methods_noresm_hirham = (av_pet_annual_near_sum_all_values[7,:]- av_pet_annual_ref_sum_all_values[7,:])/av_pet_annual_ref_sum_all_values[7,:] *100
pct_chg_pet_annual_near_sum_all_methods_noresm_racmo = (av_pet_annual_near_sum_all_values[8,:]- av_pet_annual_ref_sum_all_values[8,:])/av_pet_annual_ref_sum_all_values[8,:] *100
pct_chg_pet_annual_near_sum_all_methods_noresm_rca = (av_pet_annual_near_sum_all_values[9,:]- av_pet_annual_ref_sum_all_values[9,:])/av_pet_annual_ref_sum_all_values[9,:] *100

#mid change
pct_chg_pet_annual_mid_sum_all_cms_hamon = (av_pet_annual_mid_sum_all_cms_hamon-av_pet_annual_ref_sum_all_cms_hamon)/av_pet_annual_ref_sum_all_cms_hamon *100
pct_chg_pet_annual_mid_sum_all_cms_har_sam = (av_pet_annual_mid_sum_all_cms_har_sam-av_pet_annual_ref_sum_all_cms_har_sam)/av_pet_annual_ref_sum_all_cms_har_sam *100
pct_chg_pet_annual_mid_sum_all_cms_hargreaves = (av_pet_annual_mid_sum_all_cms_hargreaves-av_pet_annual_ref_sum_all_cms_hargreaves)/av_pet_annual_ref_sum_all_cms_hargreaves *100
pct_chg_pet_annual_mid_sum_all_cms_jen_hai = (av_pet_annual_mid_sum_all_cms_jen_hai-av_pet_annual_ref_sum_all_cms_jen_hai)/av_pet_annual_ref_sum_all_cms_jen_hai *100
pct_chg_pet_annual_mid_sum_all_cms_makkink = (av_pet_annual_mid_sum_all_cms_makkink-av_pet_annual_ref_sum_all_cms_makkink)/av_pet_annual_ref_sum_all_cms_makkink *100
pct_chg_pet_annual_mid_sum_all_cms_oudin = (av_pet_annual_mid_sum_all_cms_oudin-av_pet_annual_ref_sum_all_cms_har_sam)/av_pet_annual_ref_sum_all_cms_har_sam *100
pct_chg_pet_annual_mid_sum_all_cms_penman = (av_pet_annual_mid_sum_all_cms_penman-av_pet_annual_ref_sum_all_cms_penman)/av_pet_annual_ref_sum_all_cms_penman *100
pct_chg_pet_annual_mid_sum_all_cms_penman_montheit = (av_pet_annual_mid_sum_all_cms_penman_montheit-av_pet_annual_ref_sum_all_cms_penman_montheit)/av_pet_annual_ref_sum_all_cms_penman_montheit *100
pct_chg_pet_annual_mid_sum_all_cms_pri_tay = (av_pet_annual_mid_sum_all_cms_pri_tay-av_pet_annual_ref_sum_all_cms_pri_tay)/av_pet_annual_ref_sum_all_cms_pri_tay *100
pct_chg_pet_annual_mid_sum_all_cms_turc = (av_pet_annual_mid_sum_all_cms_turc-av_pet_annual_ref_sum_all_cms_turc)/av_pet_annual_ref_sum_all_cms_turc *100   

#mid change climate model
pct_chg_pet_annual_mid_sum_all_methods_cerfacs_hirham = (av_pet_annual_mid_sum_all_values[0,:]- av_pet_annual_ref_sum_all_values[0,:])/av_pet_annual_ref_sum_all_values[0,:] *100
pct_chg_pet_annual_mid_sum_all_methods_cerfacs_rca = (av_pet_annual_mid_sum_all_values[1,:]- av_pet_annual_ref_sum_all_values[1,:])/av_pet_annual_ref_sum_all_values[1,:] *100
pct_chg_pet_annual_mid_sum_all_methods_ichec_rca = (av_pet_annual_mid_sum_all_values[2,:]- av_pet_annual_ref_sum_all_values[2,:])/av_pet_annual_ref_sum_all_values[2,:] *100
pct_chg_pet_annual_mid_sum_all_methods_ichec_hirham = (av_pet_annual_mid_sum_all_values[3,:]- av_pet_annual_ref_sum_all_values[3,:])/av_pet_annual_ref_sum_all_values[3,:] *100
pct_chg_pet_annual_mid_sum_all_methods_ichec_racmo = (av_pet_annual_mid_sum_all_values[4,:]- av_pet_annual_ref_sum_all_values[4,:])/av_pet_annual_ref_sum_all_values[4,:] *100
pct_chg_pet_annual_mid_sum_all_methods_mpi_hirham = (av_pet_annual_mid_sum_all_values[5,:]- av_pet_annual_ref_sum_all_values[5,:])/av_pet_annual_ref_sum_all_values[5,:] *100
pct_chg_pet_annual_mid_sum_all_methods_mpi_rca = (av_pet_annual_mid_sum_all_values[6,:]- av_pet_annual_ref_sum_all_values[6,:])/av_pet_annual_ref_sum_all_values[6,:] *100
pct_chg_pet_annual_mid_sum_all_methods_noresm_hirham = (av_pet_annual_mid_sum_all_values[7,:]- av_pet_annual_ref_sum_all_values[7,:])/av_pet_annual_ref_sum_all_values[7,:] *100
pct_chg_pet_annual_mid_sum_all_methods_noresm_racmo = (av_pet_annual_mid_sum_all_values[8,:]- av_pet_annual_ref_sum_all_values[8,:])/av_pet_annual_ref_sum_all_values[8,:] *100
pct_chg_pet_annual_mid_sum_all_methods_noresm_rca = (av_pet_annual_mid_sum_all_values[9,:]- av_pet_annual_ref_sum_all_values[9,:])/av_pet_annual_ref_sum_all_values[9,:] *100
  
#far change
pct_chg_pet_annual_far_sum_all_cms_hamon = (av_pet_annual_far_sum_all_cms_hamon-av_pet_annual_ref_sum_all_cms_hamon)/av_pet_annual_ref_sum_all_cms_hamon *100
pct_chg_pet_annual_far_sum_all_cms_har_sam = (av_pet_annual_far_sum_all_cms_har_sam-av_pet_annual_ref_sum_all_cms_har_sam)/av_pet_annual_ref_sum_all_cms_har_sam *100
pct_chg_pet_annual_far_sum_all_cms_hargreaves = (av_pet_annual_far_sum_all_cms_hargreaves-av_pet_annual_ref_sum_all_cms_hargreaves)/av_pet_annual_ref_sum_all_cms_hargreaves *100
pct_chg_pet_annual_far_sum_all_cms_jen_hai = (av_pet_annual_far_sum_all_cms_jen_hai-av_pet_annual_ref_sum_all_cms_jen_hai)/av_pet_annual_ref_sum_all_cms_jen_hai *100
pct_chg_pet_annual_far_sum_all_cms_makkink = (av_pet_annual_far_sum_all_cms_makkink-av_pet_annual_ref_sum_all_cms_makkink)/av_pet_annual_ref_sum_all_cms_makkink *100   
pct_chg_pet_annual_far_sum_all_cms_oudin = (av_pet_annual_far_sum_all_cms_oudin-av_pet_annual_ref_sum_all_cms_har_sam)/av_pet_annual_ref_sum_all_cms_har_sam *100
pct_chg_pet_annual_far_sum_all_cms_penman = (av_pet_annual_far_sum_all_cms_penman-av_pet_annual_ref_sum_all_cms_penman)/av_pet_annual_ref_sum_all_cms_penman *100
pct_chg_pet_annual_far_sum_all_cms_penman_montheit = (av_pet_annual_far_sum_all_cms_penman_montheit-av_pet_annual_ref_sum_all_cms_penman_montheit)/av_pet_annual_ref_sum_all_cms_penman_montheit *100
pct_chg_pet_annual_far_sum_all_cms_pri_tay = (av_pet_annual_far_sum_all_cms_pri_tay-av_pet_annual_ref_sum_all_cms_pri_tay)/av_pet_annual_ref_sum_all_cms_pri_tay *100
pct_chg_pet_annual_far_sum_all_cms_turc = (av_pet_annual_far_sum_all_cms_turc-av_pet_annual_ref_sum_all_cms_turc)/av_pet_annual_ref_sum_all_cms_turc *100
   
#far change climate model
pct_chg_pet_annual_far_sum_all_methods_cerfacs_hirham = (av_pet_annual_far_sum_all_values[0,:]- av_pet_annual_ref_sum_all_values[0,:])/av_pet_annual_ref_sum_all_values[0,:] *100
pct_chg_pet_annual_far_sum_all_methods_cerfacs_rca = (av_pet_annual_far_sum_all_values[1,:]- av_pet_annual_ref_sum_all_values[1,:])/av_pet_annual_ref_sum_all_values[1,:] *100
pct_chg_pet_annual_far_sum_all_methods_ichec_rca = (av_pet_annual_far_sum_all_values[2,:]- av_pet_annual_ref_sum_all_values[2,:])/av_pet_annual_ref_sum_all_values[2,:] *100
pct_chg_pet_annual_far_sum_all_methods_ichec_hirham = (av_pet_annual_far_sum_all_values[3,:]- av_pet_annual_ref_sum_all_values[3,:])/av_pet_annual_ref_sum_all_values[3,:] *100
pct_chg_pet_annual_far_sum_all_methods_ichec_racmo = (av_pet_annual_far_sum_all_values[4,:]- av_pet_annual_ref_sum_all_values[4,:])/av_pet_annual_ref_sum_all_values[4,:] *100
pct_chg_pet_annual_far_sum_all_methods_mpi_hirham = (av_pet_annual_far_sum_all_values[5,:]- av_pet_annual_ref_sum_all_values[5,:])/av_pet_annual_ref_sum_all_values[5,:] *100
pct_chg_pet_annual_far_sum_all_methods_mpi_rca = (av_pet_annual_far_sum_all_values[6,:]- av_pet_annual_ref_sum_all_values[6,:])/av_pet_annual_ref_sum_all_values[6,:] *100
pct_chg_pet_annual_far_sum_all_methods_noresm_hirham = (av_pet_annual_far_sum_all_values[7,:]- av_pet_annual_ref_sum_all_values[7,:])/av_pet_annual_ref_sum_all_values[7,:] *100
pct_chg_pet_annual_far_sum_all_methods_noresm_racmo = (av_pet_annual_far_sum_all_values[8,:]- av_pet_annual_ref_sum_all_values[8,:])/av_pet_annual_ref_sum_all_values[8,:] *100
pct_chg_pet_annual_far_sum_all_methods_noresm_rca = (av_pet_annual_far_sum_all_values[9,:]- av_pet_annual_ref_sum_all_values[9,:])/av_pet_annual_ref_sum_all_values[9,:] *100


df = df.loc[:, ~df.columns.str.contains('^Unnamed')]
df_for_corr = df
df_for_corr.drop(['Month','Day','Year','Julian'],axis=1,inplace=True)
corrMatrix = df_for_corr.corr()
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}
fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
sn.heatmap(corrMatrix, annot=True)
plt.title('Correlation Matrix for the Monthly accumulated PE:' +df_list_n[7:9])
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/correlation_monthly_pet_'+df_list_n[7:9]+'.png')



# Monthly mean - PET mthod

font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
name_months = ['jan','feb','mar','apr','may','jun','jul','aug','sep','oct','nov','dec']
pet_list = ['Hamon','Har-Sam','Hargreaves','Jensen-Haise','Makkink','Oudin','Penman','Penman-Monteith','Priestley-Taylor','Turc']
data_monthly_pet = np.zeros([100,12])
for nn in np.arange(0,10):
plt.plot(name_months,pet_month_means_all_cms[:,nn],label=pet_list[nn],markevery=5)          


   # np.save('C:/Users/erpasten/Documents/UEF/PET/CMs/'+site_n+'/pet/raw/monthly_pet_all.npy',data_monthly_pet)

plt.grid(True)
plt.legend()
plt.title('Monthly accumulated PE:' +df_list_n[7:9])
plt.xlabel('Month')
plt.ylabel('Accumulated PE (mm/month)')
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/monthly_pet_'+df_list_n[7:9]+'.png')

# Percentage change:  CHECK SYMBOLS
font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
future_scale_near = ['Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future']
future_scale_mid = ['Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future']
future_scale_far = ['Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future']
pet_method_list = ['Hamon','Har-Sam','Hargreaves','Jensen-Haise','Makkink','Oudin','Penman','Penman-Monteith','Priestley-Taylor','Turc']
model_list = ['CERFACS-HIRHAM','CERFACS-RCA','ICHEC-RCA','ICHEC-HIRHAM','ICHEC-RACMO','MPI-HIRHAM','MPI-RCA','NorESM-HIRHAM','NorESM-RACMO','NorESM-RCA']
colour_chg_model = ['red','blue','cyan','black','m','y','lime','orange','indigo','darkcyan']
#data_monthly_pet = np.zeros([100,12])
#plt.plot(future_scale,pct_chg_pet_annual_far_sum_all_cms_hamon,label=model_list[nn],markevery=5)          
for nn in np.arange(0,10):
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_hamon[nn],label=model_list[nn],color=colour_chg_model[nn],marker='o',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_har_sam[nn],label=model_list[nn],color=colour_chg_model[nn],marker='v',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_hargreaves[nn],label=model_list[nn],color=colour_chg_model[nn],marker='s',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_jen_hai[nn],label=model_list[nn],color=colour_chg_model[nn],marker='^',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_makkink[nn],label=model_list[nn],color=colour_chg_model[nn],marker='<',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_oudin[nn],label=model_list[nn],color=colour_chg_model[nn],marker=(5,0),s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_penman[nn],label=model_list[nn],color=colour_chg_model[nn],marker=(5,1),s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_penman_montheit[nn],label=model_list[nn],color=colour_chg_model[nn],marker='X',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_pri_tay[nn],label=model_list[nn],color=colour_chg_model[nn],marker='D',s=80)
plt.scatter(future_scale_near[nn],pct_chg_pet_annual_near_sum_all_cms_turc[nn],label=model_list[nn],color=colour_chg_model[nn],marker='h',s=80)

plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_hamon[nn],label=model_list[nn],color=colour_chg_model[nn],marker='o',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_har_sam[nn],label=model_list[nn],color=colour_chg_model[nn],marker='v',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_hargreaves[nn],label=model_list[nn],color=colour_chg_model[nn],marker='s',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_jen_hai[nn],label=model_list[nn],color=colour_chg_model[nn],marker='^',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_makkink[nn],label=model_list[nn],color=colour_chg_model[nn],marker='<',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_oudin[nn],label=model_list[nn],color=colour_chg_model[nn],marker=(5,0),s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_penman[nn],label=model_list[nn],color=colour_chg_model[nn],marker=(5,1),s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_penman_montheit[nn],label=model_list[nn],color=colour_chg_model[nn],marker='X',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_pri_tay[nn],label=model_list[nn],color=colour_chg_model[nn],marker='D',s=80)
plt.scatter(future_scale_mid[nn],pct_chg_pet_annual_mid_sum_all_cms_turc[nn],label=model_list[nn],color=colour_chg_model[nn],marker='h',s=80)

plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_hamon[nn],label=model_list[nn],color=colour_chg_model[nn],marker='o',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_har_sam[nn],label=model_list[nn],color=colour_chg_model[nn],marker='v',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_hargreaves[nn],label=model_list[nn],color=colour_chg_model[nn],marker='s',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_jen_hai[nn],label=model_list[nn],color=colour_chg_model[nn],marker='^',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_makkink[nn],label=model_list[nn],color=colour_chg_model[nn],marker='<',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_oudin[nn],label=model_list[nn],color=colour_chg_model[nn],marker=(5,0),s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_penman[nn],label=model_list[nn],color=colour_chg_model[nn],marker=(5,1),s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_penman_montheit[nn],label=model_list[nn],color=colour_chg_model[nn],marker='X',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_pri_tay[nn],label=model_list[nn],color=colour_chg_model[nn],marker='D',s=80)
plt.scatter(future_scale_far[nn],pct_chg_pet_annual_far_sum_all_cms_turc[nn],label=model_list[nn],color=colour_chg_model[nn],marker='h',s=80)

plt.grid(True)
#plt.legend()
plt.title('Percentage change:' +df_list_n[7:9])
plt.xlabel('Temporal scale')
plt.ylabel('Percentage change (%)')
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/pct_chg_'+df_list_n[7:9]+'.png')



# Percentage change signal to noise ratio
 
#saving the snr for the pet method [10,3,3] ==> [method(as in pet_method_list),statistics(mean,stdev,snr),time_slice(near,mid,far)]
snr_pet_method = np.zeros([10,3,3])
snr_pet_method[0,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_hamon)
snr_pet_method[0,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_hamon)
snr_pet_method[0,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_hamon)/np.std(pct_chg_pet_annual_near_sum_all_cms_hamon)

snr_pet_method[1,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_har_sam)
snr_pet_method[1,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_har_sam)
snr_pet_method[1,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_har_sam)/np.std(pct_chg_pet_annual_near_sum_all_cms_har_sam)

snr_pet_method[2,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_hargreaves)
snr_pet_method[2,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_hargreaves)
snr_pet_method[2,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_hargreaves)/np.std(pct_chg_pet_annual_near_sum_all_cms_hargreaves)   

snr_pet_method[3,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_jen_hai)
snr_pet_method[3,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_jen_hai)
snr_pet_method[3,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_jen_hai)/np.std(pct_chg_pet_annual_near_sum_all_cms_jen_hai)

snr_pet_method[4,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_makkink)
snr_pet_method[4,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_makkink)
snr_pet_method[4,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_makkink)/np.std(pct_chg_pet_annual_near_sum_all_cms_makkink)

snr_pet_method[5,0,0]=abs(np.mean(pct_chg_pet_annual_near_sum_all_cms_oudin))
snr_pet_method[5,1,0]=abs(np.std(pct_chg_pet_annual_near_sum_all_cms_oudin))
snr_pet_method[5,2,0]=abs(np.mean(pct_chg_pet_annual_near_sum_all_cms_oudin))/np.std(pct_chg_pet_annual_near_sum_all_cms_oudin)

snr_pet_method[6,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_penman)
snr_pet_method[6,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_penman)
snr_pet_method[6,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_penman)/np.std(pct_chg_pet_annual_near_sum_all_cms_penman)

snr_pet_method[7,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_penman_montheit)
snr_pet_method[7,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_penman_montheit)
snr_pet_method[7,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_penman_montheit)/np.std(pct_chg_pet_annual_near_sum_all_cms_penman_montheit)

snr_pet_method[8,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_pri_tay)
snr_pet_method[8,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_pri_tay)
snr_pet_method[8,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_pri_tay)/np.std(pct_chg_pet_annual_near_sum_all_cms_pri_tay)

snr_pet_method[9,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_turc)
snr_pet_method[9,1,0]=np.std(pct_chg_pet_annual_near_sum_all_cms_turc)
snr_pet_method[9,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_cms_turc)/np.std(pct_chg_pet_annual_near_sum_all_cms_turc)

snr_pet_method[0,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_hamon)
snr_pet_method[0,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_hamon)
snr_pet_method[0,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_hamon)/np.std(pct_chg_pet_annual_mid_sum_all_cms_hamon)

snr_pet_method[1,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_har_sam)
snr_pet_method[1,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_har_sam)
snr_pet_method[1,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_har_sam)/np.std(pct_chg_pet_annual_mid_sum_all_cms_har_sam)

snr_pet_method[2,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_hargreaves)
snr_pet_method[2,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_hargreaves)
snr_pet_method[2,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_hargreaves)/np.std(pct_chg_pet_annual_mid_sum_all_cms_hargreaves)   

snr_pet_method[3,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_jen_hai)
snr_pet_method[3,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_jen_hai)
snr_pet_method[3,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_jen_hai)/np.std(pct_chg_pet_annual_mid_sum_all_cms_jen_hai)

snr_pet_method[4,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_makkink)
snr_pet_method[4,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_makkink)
snr_pet_method[4,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_makkink)/np.std(pct_chg_pet_annual_mid_sum_all_cms_makkink)

snr_pet_method[5,0,1]=abs(np.mean(pct_chg_pet_annual_mid_sum_all_cms_oudin))
snr_pet_method[5,1,1]=abs(np.std(pct_chg_pet_annual_mid_sum_all_cms_oudin))
snr_pet_method[5,2,1]=abs(np.mean(pct_chg_pet_annual_mid_sum_all_cms_oudin))/np.std(pct_chg_pet_annual_mid_sum_all_cms_oudin)

snr_pet_method[6,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_penman)
snr_pet_method[6,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_penman)
snr_pet_method[6,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_penman)/np.std(pct_chg_pet_annual_mid_sum_all_cms_penman)

snr_pet_method[7,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_penman_montheit)
snr_pet_method[7,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_penman_montheit)
snr_pet_method[7,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_penman_montheit)/np.std(pct_chg_pet_annual_mid_sum_all_cms_penman_montheit)

snr_pet_method[8,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_pri_tay)
snr_pet_method[8,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_pri_tay)
snr_pet_method[8,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_pri_tay)/np.std(pct_chg_pet_annual_mid_sum_all_cms_pri_tay)

snr_pet_method[9,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_turc)
snr_pet_method[9,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_cms_turc)
snr_pet_method[9,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_cms_turc)/np.std(pct_chg_pet_annual_mid_sum_all_cms_turc)

snr_pet_method[0,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_hamon)
snr_pet_method[0,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_hamon)
snr_pet_method[0,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_hamon)/np.std(pct_chg_pet_annual_far_sum_all_cms_hamon)

snr_pet_method[1,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_har_sam)
snr_pet_method[1,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_har_sam)
snr_pet_method[1,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_har_sam)/np.std(pct_chg_pet_annual_far_sum_all_cms_har_sam)

snr_pet_method[2,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_hargreaves)
snr_pet_method[2,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_hargreaves)
snr_pet_method[2,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_hargreaves)/np.std(pct_chg_pet_annual_far_sum_all_cms_hargreaves)   

snr_pet_method[3,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_jen_hai)
snr_pet_method[3,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_jen_hai)
snr_pet_method[3,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_jen_hai)/np.std(pct_chg_pet_annual_far_sum_all_cms_jen_hai)

snr_pet_method[4,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_makkink)
snr_pet_method[4,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_makkink)
snr_pet_method[4,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_makkink)/np.std(pct_chg_pet_annual_far_sum_all_cms_makkink)

snr_pet_method[5,0,2]=abs(np.mean(pct_chg_pet_annual_far_sum_all_cms_oudin))
snr_pet_method[5,1,2]=abs(np.std(pct_chg_pet_annual_far_sum_all_cms_oudin))
snr_pet_method[5,2,2]=abs(np.mean(pct_chg_pet_annual_far_sum_all_cms_oudin))/np.std(pct_chg_pet_annual_far_sum_all_cms_oudin)

snr_pet_method[6,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_penman)
snr_pet_method[6,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_penman)
snr_pet_method[6,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_penman)/np.std(pct_chg_pet_annual_far_sum_all_cms_penman)

snr_pet_method[7,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_penman_montheit)
snr_pet_method[7,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_penman_montheit)
snr_pet_method[7,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_penman_montheit)/np.std(pct_chg_pet_annual_far_sum_all_cms_penman_montheit)

snr_pet_method[8,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_pri_tay)
snr_pet_method[8,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_pri_tay)
snr_pet_method[8,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_pri_tay)/np.std(pct_chg_pet_annual_far_sum_all_cms_pri_tay)

snr_pet_method[9,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_turc)
snr_pet_method[9,1,2]=np.std(pct_chg_pet_annual_far_sum_all_cms_turc)
snr_pet_method[9,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_cms_turc)/np.std(pct_chg_pet_annual_far_sum_all_cms_turc)

font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
future_scale_near = ['Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future']
future_scale_mid = ['Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future']
future_scale_far = ['Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future']
model_list = ['CERFACS-HIRHAM','CERFACS-RCA','ICHEC-RCA','ICHEC-HIRHAM','ICHEC-RACMO','MPI-HIRHAM','MPI-RCA','NorESM-HIRHAM','NorESM-RACMO','NorESM-RCA']
pet_method_list = ['Hamon','Har-Sam','Hargreaves','Jensen-Haise','Makkink','Oudin','Penman','Penman-Monteith','Priestley-Taylor','Turc']
colour_chg_model = ['red','blue','cyan','deeppink','m','y','lime','orange','indigo','darkcyan']
#data_monthly_pet = np.zeros([100,12])
#plt.plot(future_scale,pct_chg_pet_annual_far_sum_all_cms_hamon,label=model_list[nn],markevery=5)

for nn in np.arange(0,10):
plt.scatter(future_scale_near[nn],snr_pet_method[nn,2,0],label=pet_method_list[nn],color=colour_chg_model[nn],s=120)
plt.scatter(future_scale_mid[nn],snr_pet_method[nn,2,1],label=pet_method_list[nn],color=colour_chg_model[nn],s=120)
plt.scatter(future_scale_far[nn],snr_pet_method[nn,2,2],label=pet_method_list[nn],color=colour_chg_model[nn],s=120)


legend_elements = [Line2D([0], [0], marker='o', color='red', label='Hamon',
          markerfacecolor='red', markersize=15),
   Line2D([0], [0], marker='o', color='blue', label='Hargreaves-Samani',
          markerfacecolor='blue', markersize=15),
   Line2D([0], [0], marker='o', color='cyan', label='Hargreaves',
          markerfacecolor='cyan', markersize=15),
   Line2D([0], [0], marker='o', color='deeppink', label='Jensen-Haise',
          markerfacecolor='deeppink', markersize=15),
   Line2D([0], [0], marker='o', color='m', label='Makkink',
          markerfacecolor='m', markersize=15),
   Line2D([0], [0], marker='o', color='y', label='Oudin',
          markerfacecolor='y', markersize=15),
   Line2D([0], [0], marker='o', color='lime', label='Penman',
          markerfacecolor='lime', markersize=15),
   Line2D([0], [0], marker='o', color='orange', label='Penman-Monteith',
          markerfacecolor='orange', markersize=15),
   Line2D([0], [0], marker='o', color='indigo', label='Priestley-Taylor',
          markerfacecolor='indigo', markersize=15),
   Line2D([0], [0], marker='o', color='darkcyan', label='Turc',
          markerfacecolor='darkcyan', markersize=15)]

# Create the figure

plt.grid(True)
plt.legend(handles=legend_elements, loc='upper left',numpoints=1)
plt.title('Signal to Noise Ratio - Percentage change based on PET method:' +df_list_n[7:9])
plt.xlabel('Period')
plt.ylabel('Signal to Noise Ratio')
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/snr_pct_chg_pet_method'+df_list_n[7:9]+'.png')
df_pet_snr_near = pd.DataFrame(snr_pet_method[:,:,0])   
df_pet_snr_mid = pd.DataFrame(snr_pet_method[:,:,1])
df_pet_snr_far = pd.DataFrame(snr_pet_method[:,:,2])

df_pet_snr_near.columns= ['Mean','Std','SNR']
df_pet_snr_near.insert(3,'Method',pet_method_list)
df_pet_snr_mid.columns= ['Mean','Std','SNR']
df_pet_snr_mid.insert(3,'Method',pet_method_list)
df_pet_snr_far.columns= ['Mean','Std','SNR']
df_pet_snr_far.insert(3,'Method',pet_method_list)

df_pet_snr_far.to_excel('C:/Users/erpasten/Documents/UEF/PET/CMs/'+df_list_n[7:9]+'/pet/raw/df_pet_snr_'+df_list_n[7:9]+'.xlsx', sheet_name='Far')
df_pet_snr_near.to_excel('C:/Users/erpasten/Documents/UEF/PET/CMs/'+df_list_n[7:9]+'/pet/raw/df_pet_snr_'+df_list_n[7:9]+'.xlsx', sheet_name='Near')
df_pet_snr_mid.to_excel('C:/Users/erpasten/Documents/UEF/PET/CMs/'+df_list_n[7:9]+'/pet/raw/df_pet_snr_'+df_list_n[7:9]+'.xlsx', sheet_name='Mid')

# SNR climate model

#saving the snr for the pet method [10,3,3] ==> [method(as in climate_model_list),statistics(mean,stdev,snr),time_slice(near,mid,far)]
snr_climate_model = np.zeros([10,3,3])
snr_climate_model[0,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_cerfacs_hirham)
snr_climate_model[0,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_cerfacs_hirham)
snr_climate_model[0,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_cerfacs_hirham)/np.std(pct_chg_pet_annual_near_sum_all_methods_cerfacs_hirham)

snr_climate_model[1,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_cerfacs_rca)
snr_climate_model[1,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_cerfacs_rca)
snr_climate_model[1,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_cerfacs_rca)/np.std(pct_chg_pet_annual_near_sum_all_methods_cerfacs_rca)

snr_climate_model[2,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_ichec_rca)
snr_climate_model[2,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_ichec_rca)
snr_climate_model[2,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_ichec_rca)/np.std(pct_chg_pet_annual_near_sum_all_methods_ichec_rca)

snr_climate_model[3,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_ichec_hirham)
snr_climate_model[3,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_ichec_hirham)
snr_climate_model[3,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_ichec_hirham)/np.std(pct_chg_pet_annual_near_sum_all_methods_ichec_hirham)

snr_climate_model[4,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_ichec_racmo)
snr_climate_model[4,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_ichec_racmo)
snr_climate_model[4,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_ichec_racmo)/np.std(pct_chg_pet_annual_near_sum_all_methods_ichec_racmo)

snr_climate_model[5,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_mpi_hirham)
snr_climate_model[5,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_mpi_hirham)
snr_climate_model[5,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_mpi_hirham)/np.std(pct_chg_pet_annual_near_sum_all_methods_mpi_hirham)

snr_climate_model[6,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_mpi_rca)
snr_climate_model[6,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_mpi_rca)
snr_climate_model[6,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_mpi_rca)/np.std(pct_chg_pet_annual_near_sum_all_methods_mpi_rca)

snr_climate_model[7,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_noresm_hirham)
snr_climate_model[7,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_noresm_hirham)
snr_climate_model[7,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_noresm_hirham)/np.std(pct_chg_pet_annual_near_sum_all_methods_noresm_hirham)

snr_climate_model[8,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_noresm_racmo)
snr_climate_model[8,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_noresm_racmo)
snr_climate_model[8,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_noresm_racmo)/np.std(pct_chg_pet_annual_near_sum_all_methods_noresm_racmo)

snr_climate_model[9,0,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_noresm_rca)
snr_climate_model[9,1,0]=np.std(pct_chg_pet_annual_near_sum_all_methods_noresm_rca)
snr_climate_model[9,2,0]=np.mean(pct_chg_pet_annual_near_sum_all_methods_noresm_rca)/np.std(pct_chg_pet_annual_near_sum_all_methods_noresm_rca)

snr_climate_model[0,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_hirham)
snr_climate_model[0,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_hirham)
snr_climate_model[0,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_hirham)/np.std(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_hirham)

snr_climate_model[1,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_rca)
snr_climate_model[1,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_rca)
snr_climate_model[1,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_rca)/np.std(pct_chg_pet_annual_mid_sum_all_methods_cerfacs_rca)

snr_climate_model[2,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_ichec_rca)
snr_climate_model[2,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_ichec_rca)
snr_climate_model[2,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_ichec_rca)/np.std(pct_chg_pet_annual_mid_sum_all_methods_ichec_rca)

snr_climate_model[3,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_ichec_hirham)
snr_climate_model[3,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_ichec_hirham)
snr_climate_model[3,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_ichec_hirham)/np.std(pct_chg_pet_annual_mid_sum_all_methods_ichec_hirham)

snr_climate_model[4,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_ichec_racmo)
snr_climate_model[4,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_ichec_racmo)
snr_climate_model[4,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_ichec_racmo)/np.std(pct_chg_pet_annual_mid_sum_all_methods_ichec_racmo)

snr_climate_model[5,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_mpi_hirham)
snr_climate_model[5,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_mpi_hirham)
snr_climate_model[5,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_mpi_hirham)/np.std(pct_chg_pet_annual_mid_sum_all_methods_mpi_hirham)

snr_climate_model[6,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_mpi_rca)
snr_climate_model[6,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_mpi_rca)
snr_climate_model[6,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_mpi_rca)/np.std(pct_chg_pet_annual_mid_sum_all_methods_mpi_rca)

snr_climate_model[7,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_noresm_hirham)
snr_climate_model[7,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_noresm_hirham)
snr_climate_model[7,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_noresm_hirham)/np.std(pct_chg_pet_annual_mid_sum_all_methods_noresm_hirham)

snr_climate_model[8,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_noresm_racmo)
snr_climate_model[8,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_noresm_racmo)
snr_climate_model[8,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_noresm_racmo)/np.std(pct_chg_pet_annual_mid_sum_all_methods_noresm_racmo)

snr_climate_model[9,0,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_noresm_rca)
snr_climate_model[9,1,1]=np.std(pct_chg_pet_annual_mid_sum_all_methods_noresm_rca)
snr_climate_model[9,2,1]=np.mean(pct_chg_pet_annual_mid_sum_all_methods_noresm_rca)/np.std(pct_chg_pet_annual_mid_sum_all_methods_noresm_rca)

snr_climate_model[0,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_cerfacs_hirham)
snr_climate_model[0,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_cerfacs_hirham)
snr_climate_model[0,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_cerfacs_hirham)/np.std(pct_chg_pet_annual_far_sum_all_methods_cerfacs_hirham)

snr_climate_model[1,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_cerfacs_rca)
snr_climate_model[1,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_cerfacs_rca)
snr_climate_model[1,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_cerfacs_rca)/np.std(pct_chg_pet_annual_far_sum_all_methods_cerfacs_rca)

snr_climate_model[2,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_ichec_rca)
snr_climate_model[2,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_ichec_rca)
snr_climate_model[2,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_ichec_rca)/np.std(pct_chg_pet_annual_far_sum_all_methods_ichec_rca)

snr_climate_model[3,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_ichec_hirham)
snr_climate_model[3,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_ichec_hirham)
snr_climate_model[3,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_ichec_hirham)/np.std(pct_chg_pet_annual_far_sum_all_methods_ichec_hirham)

snr_climate_model[4,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_ichec_racmo)
snr_climate_model[4,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_ichec_racmo)
snr_climate_model[4,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_ichec_racmo)/np.std(pct_chg_pet_annual_far_sum_all_methods_ichec_racmo)

snr_climate_model[5,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_mpi_hirham)
snr_climate_model[5,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_mpi_hirham)
snr_climate_model[5,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_mpi_hirham)/np.std(pct_chg_pet_annual_far_sum_all_methods_mpi_hirham)

snr_climate_model[6,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_mpi_rca)
snr_climate_model[6,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_mpi_rca)
snr_climate_model[6,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_mpi_rca)/np.std(pct_chg_pet_annual_far_sum_all_methods_mpi_rca)

snr_climate_model[7,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_noresm_hirham)
snr_climate_model[7,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_noresm_hirham)
snr_climate_model[7,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_noresm_hirham)/np.std(pct_chg_pet_annual_far_sum_all_methods_noresm_hirham)

snr_climate_model[8,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_noresm_racmo)
snr_climate_model[8,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_noresm_racmo)
snr_climate_model[8,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_noresm_racmo)/np.std(pct_chg_pet_annual_far_sum_all_methods_noresm_racmo)

snr_climate_model[9,0,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_noresm_rca)
snr_climate_model[9,1,2]=np.std(pct_chg_pet_annual_far_sum_all_methods_noresm_rca)
snr_climate_model[9,2,2]=np.mean(pct_chg_pet_annual_far_sum_all_methods_noresm_rca)/np.std(pct_chg_pet_annual_far_sum_all_methods_noresm_rca)

font = {'family' : 'normal',
'weight' : 'normal',
'size'   : 22}

fig, ax = plt.subplots()
fig= plt.figure(figsize=(20,20))
fontsize=20
plt.rc('font', **font)
future_scale_near = ['Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future','Near future']
future_scale_mid = ['Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future','Mid future']
future_scale_far = ['Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future','Far future']
climate_model_list = ['CERFACS-HIRHAM','CERFACS-RCA','ICHEC-RCA','ICHEC-HIRHAM','ICHEC-RACMO','MPI-HIRHAM','MPI-RCA','NorESM-HIRHAM','NorESM-RACMO','NorESM-RCA']
pet_method_list = ['Hamon','Har-Sam','Hargreaves','Jensen-Haise','Makkink','Oudin','Penman','Penman-Monteith','Priestley-Taylor','Turc']
colour_chg_model = ['red','blue','cyan','deeppink','m','y','lime','orange','indigo','darkcyan']
#data_monthly_pet = np.zeros([100,12])
#plt.plot(future_scale,pct_chg_pet_annual_far_sum_all_cms_hamon,label=model_list[nn],markevery=5)

for nn in np.arange(0,10):
plt.scatter(future_scale_near[nn],snr_climate_model[nn,2,0],marker='^',label=climate_model_list[nn],color=colour_chg_model[nn],s=120)
plt.scatter(future_scale_mid[nn],snr_climate_model[nn,2,1],marker='^',label=climate_model_list[nn],color=colour_chg_model[nn],s=120)
plt.scatter(future_scale_far[nn],snr_climate_model[nn,2,2],marker='^',label=climate_model_list[nn],color=colour_chg_model[nn],s=120)


legend_elements = [Line2D([0], [0], marker='^', color='red', label='CERFACS-HIRHAM',
          markerfacecolor='red', markersize=15),
   Line2D([0], [0], marker='^', color='blue', label='CERFACS-RCA',
          markerfacecolor='blue', markersize=15),
   Line2D([0], [0], marker='^', color='cyan', label='ICHEC-RCA',
          markerfacecolor='cyan', markersize=15),
   Line2D([0], [0], marker='^', color='deeppink', label='ICHEC-HIRHAM',
          markerfacecolor='deeppink', markersize=15),
   Line2D([0], [0], marker='^', color='m', label='ICHEC-RACMO',
          markerfacecolor='m', markersize=15),
   Line2D([0], [0], marker='^', color='y', label='MPI-HIRHAM',
          markerfacecolor='y', markersize=15),
   Line2D([0], [0], marker='^', color='lime', label='MPI-RCA',
          markerfacecolor='lime', markersize=15),
   Line2D([0], [0], marker='^', color='orange', label='NorESM-HIRHAM',
          markerfacecolor='orange', markersize=15),
   Line2D([0], [0], marker='^', color='indigo', label='NorESM-RACMO',
          markerfacecolor='indigo', markersize=15),
   Line2D([0], [0], marker='^', color='darkcyan', label='NorESM-RCA',
          markerfacecolor='darkcyan', markersize=15)]

# Create the figure

plt.grid(True)
plt.legend(handles=legend_elements, loc=0,numpoints=1)
plt.title('Signal to Noise Ratio - Percentage change based on climate model:' +df_list_n[7:9])

plt.xlabel('Period')
plt.ylabel('Signal to Noise Ratio')
#plt.ylim = (0,6)#2 + np.max(snr_climate_model[:,2,0]))
plt.savefig('C:/Users/erpasten/Documents/UEF/PET/Figures/PET/raw/snr_pct_chg_climate_model_'+df_list_n[7:9]+'.png')
df_climate_model_snr_near = pd.DataFrame(snr_climate_model[:,:,0])   
df_climate_model_snr_mid = pd.DataFrame(snr_climate_model[:,:,1])
df_climate_model_snr_far = pd.DataFrame(snr_climate_model[:,:,2])

df_climate_model_snr_near.columns= ['Mean','Std','SNR']
df_climate_model_snr_near.insert(3,'Method',climate_model_list)
df_climate_model_snr_mid.columns= ['Mean','Std','SNR']
df_climate_model_snr_mid.insert(3,'Method',climate_model_list)
df_climate_model_snr_far.columns= ['Mean','Std','SNR']
df_climate_model_snr_far.insert(3,'Method',climate_model_list)

df_climate_model_snr_far.to_excel('C:/Users/erpasten/Documents/UEF/PET/CMs/'+df_list_n[7:9]+'/pet/raw/df_climate_model_snr_'+df_list_n[7:9]+'.xlsx', sheet_name='Far')
df_climate_model_snr_near.to_excel('C:/Users/erpasten/Documents/UEF/PET/CMs/'+df_list_n[7:9]+'/pet/raw/df_climate_model_snr_'+df_list_n[7:9]+'.xlsx', sheet_name='Near')
df_climate_model_snr_mid.to_excel('C:/Users/erpasten/Documents/UEF/PET/CMs/'+df_list_n[7:9]+'/pet/raw/df_climate_model_snr_'+df_list_n[7:9]+'.xlsx', sheet_name='Mid')    
"""
